{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/jazz-midi sync","webpack:///./node_modules/jazz-midi/index.js","webpack:///./node_modules/jzz-synth-tiny/javascript/JZZ.synth.Tiny.js","webpack:///./node_modules/jzz/javascript/JZZ.js","webpack:///./node_modules/musictheoryjs/dist/musictheory.min.js","webpack:///./node_modules/process/browser.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/Sequencer.js","webpack:///./src/index.js"],"names":["require","JZZ","Sequencer","pKey","MT","C","pScale","Major","pMelodyScale","HarmonicMajor","mKey","mScale","mMelodyScale","pChords","pDegrees","mChords","mDegrees","pNotes","mMelody","str","s","split","pForm","key","scale","Minor","PentatonicMajor","EnigmaticMajor","Spanish","MelodicMinorAscend","mode","ionianMode","dorianMode","phrygianMode","lydianMode","mixolydianMode","locrianMode","setRythm","fixChordName","degree","progression","asString","chords","octave","pChord","pPort","pTime","port","time","notes","forEach","item","wait","noteOn","midiKey","noteOff","mSeq","Tiny","playChord"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA;AACA;AACA;AACA;AACA,uCAAuC,WAAW;AAClD;AACA;AACA,mE;;;;;;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,+DAAQ,IAAI,CAAC;AAC5B,uBAAuB,mBAAO,CAAC,oFAA2B;;;;;;;;;;;;;;;;;;;;;;;;ACpB1D;AACA,MAAM,IAA4D;AAClE;AACA;AACA,OAAO,EAKJ;AACH,CAAC;;AAED;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gDAAgD;AACnE,mBAAmB,gDAAgD;AACnE,mBAAmB,4CAA4C;AAC/D,mBAAmB,qBAAqB;AACxC,mBAAmB,gDAAgD;AACnE,mBAAmB,qBAAqB;AACxC,0BAA0B,qBAAqB;AAC/C,mBAAmB,qBAAqB;AACxC,mBAAmB,sBAAsB;AACzC,mBAAmB,qBAAqB;AACxC;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,QAAQ,2BAA2B,EAAE,+CAA+C;AACpF,QAAQ,gCAAgC,EAAE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CA;AACA;AACA;AACA,cAAc,MAAM;AACpB;AACA,cAAc,uBAAuB;AACrC;AACA;AACA,gBAAgB,uBAAuB;AACvC;AACA,gBAAgB,sBAAsB;AACtC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,gBAAgB;AAChB;AACA,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,8BAA8B,KAAK;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,sCAAsC,KAAK;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,kBAAkB,WAAW;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,oBAAoB,iBAAiB,GAAG,EAAE;AACnF;AACA;AACA;AACA;AACA,2BAA2B,qDAAqD;AAChF,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,gCAAgC,KAAK;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,wCAAwC,KAAK;AAC7C;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sCAAsC,KAAK;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB;AACtB,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,sCAAsC,KAAK;AAC3C;AACA;AACA,kCAAkC,KAAK;AACvC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,sCAAsC,KAAK;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD,4CAA4C;AAC5C,0CAA0C;AAC1C,iDAAiD;AACjD,8CAA8C;AAC9C,kDAAkD,OAAO;AACzD,iEAAiE,OAAO;AACxE,qEAAqE,OAAO;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA,4CAA4C;AAC5C,yDAAyD;AACzD,iDAAiD;AACjD,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,kBAAkB,WAAW;AAC7B;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,MAAM;AACzB;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,eAAe;AACnC,iBAAiB;AACjB;AACA;AACA;AACA,cAAc,KAAK;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,2CAA2C,QAAQ;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iBAAiB;AACpD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,uCAAuC,iBAAiB;;AAExD,CAAC,E;;;;;;;;;;;AC/4BD;AACA,MAAM,IAA4D;AAClE;AACA;AACA,OAAO,EAOJ;AACH,CAAC;;AAED;AACA;AACA;;AAEA,uCAAuC,6BAA6B;AACpE;AACA;AACA,gBAAgB,0BAA0B,EAAE,eAAe,6BAA6B;AACxF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,+BAA+B,gCAAgC;AAC3G,4CAA4C,kCAAkC;AAC9E,oCAAoC,qBAAqB;AACzD,qCAAqC,oBAAoB,gCAAgC;AACzF,uCAAuC,wBAAwB,kDAAkD;AACjH,qCAAqC,yBAAyB;AAC9D,uCAAuC,kBAAkB,gBAAgB;AACzE,kCAAkC,wCAAwC;AAC1E,iCAAiC,0BAA0B;AAC3D;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,oCAAoC,gCAAgC,aAAa,G;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,eAAe,EAAE;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wCAAwC,eAAe;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA,qCAAqC,0BAA0B,yBAAyB;AACxF;AACA;AACA,+CAA+C;AAC/C;AACA;AACA,oCAAoC,yBAAyB,yBAAyB;;AAEtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,yBAAyB;;AAE3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,4BAA4B,EAAE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,gBAAgB;AACrC;AACA,yCAAyC;AACzC,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,wBAAwB;;AAExB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,0BAA0B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,eAAe,2BAA2B;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,eAAe,0BAA0B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,mBAAmB,gCAAgC;AACnD;AACA;AACA;AACA,mBAAmB,iCAAiC;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA,kDAAkD,gBAAgB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,sBAAsB,QAAQ;AACtD,8BAA8B,oBAAoB,iCAAiC,GAAG;AACtF,qBAAqB,gBAAgB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,sBAAsB,QAAQ;AACtD,8BAA8B,oBAAoB,gCAAgC,GAAG;AACrF,qBAAqB,gBAAgB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,+BAA+B;AACxE,0BAA0B,oCAAoC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,0BAA0B;AACzC,eAAe,uBAAuB;AACtC;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,mBAAmB;AACxD,yCAAyC,0BAA0B;AACnE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D,yCAAyC,0BAA0B;AACnE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B,eAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,gBAAgB;AAChB;AACA;AACA;AACA,eAAe,eAAe;AAC9B,eAAe,eAAe;AAC9B;AACA,eAAe,eAAe;AAC9B,eAAe,eAAe;AAC9B;AACA,eAAe,eAAe;AAC9B,eAAe,eAAe;AAC9B;AACA,eAAe,eAAe;AAC9B,eAAe,eAAe;AAC9B,YAAY,UAAU,yBAAyB,YAAY,yBAAyB;AACpF;AACA;AACA,eAAe,mCAAmC;AAClD;;AAEA;AACA;AACA,kBAAkB;;AAElB;AACA;AACA,QAAQ,KAA4B;AACpC,gBAAgB,mBAAO,CAAC,oDAAW;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,+BAA+B,EAAE;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,gDAAgD,EAAE;AAC3D,0BAA0B,0BAA0B,EAAE;AACtD;;AAEA;AACA;AACA;AACA,0BAA0B,eAAe,EAAE;AAC3C;;AAEA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA,kCAAkC,oBAAoB,sBAAsB;AAC5E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,gBAAgB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,yBAAyB;AAC9C;AACA;AACA;AACA;AACA;AACA,iBAAiB,2CAA2C;AAC5D,4BAA4B,qEAAqE;AACjG;AACA,iBAAiB,0CAA0C;AAC3D,2BAA2B,qEAAqE;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,kCAAkC,yBAAyB,EAAE;AAC7D;AACA,iCAAiC,iDAAiD;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD,gCAAgC,mBAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,kCAAkC,wBAAwB,EAAE;AAC5D;AACA;AACA,2BAA2B,yBAAyB;AACpD;AACA;AACA;AACA;AACA;AACA,sCAAsC,wBAAwB,gBAAgB,GAAG;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,mBAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA,sDAAsD,oBAAoB,EAAE;AAC5E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAqC,uBAAuB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,yBAAyB;AAC9C;AACA;AACA;AACA;AACA;AACA,4BAA4B,6FAA6F;AACzH,OAAO;AACP;AACA,2BAA2B,6FAA6F;AACxH,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,kCAAkC,yBAAyB,EAAE;AAC7D;AACA,iCAAiC,oDAAoD;AACrF;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,oBAAoB;AAC3D,kCAAkC,mBAAmB;AACrD;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,kCAAkC,wBAAwB,EAAE;AAC5D;AACA;AACA,2BAA2B,yBAAyB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,sCAAsC,uBAAuB,eAAe,GAAG;AAC/E;AACA;AACA;AACA;AACA;AACA,kCAAkC,mBAAmB;AACrD;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA,gEAAgE,eAAe;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,sBAAsB;AACnF,OAAO;AACP;AACA;AACA,qBAAqB,yBAAyB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,8BAA8B,sDAAsD,uCAAuC,GAAG,EAAE;AAChI,kCAAkC,yBAAyB,EAAE;AAC7D;AACA,iCAAiC,gBAAgB,mBAAmB,mCAAmC,sDAAsD,UAAU,GAAG,EAAE;AAC5K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD,gCAAgC,mBAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,8BAA8B,sDAAsD,sCAAsC,GAAG,EAAE;AAC/H,kCAAkC,wBAAwB,EAAE;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,mBAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,uCAAuC;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,sCAAsC;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,mBAAmB;AAChF,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA,aAAa,sBAAsB,EAAE;AACrC;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,yBAAyB;AACpE;AACA,8CAA8C,yBAAyB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,yBAAyB;AACpE;AACA,8CAA8C,yBAAyB;AACvE;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB,4BAA4B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8FAA8F;AAC1H,4CAA4C,+CAA+C;AAC3F,wCAAwC,kBAAkB;AAC1D,wCAAwC,kBAAkB;AAC1D,0CAA0C,oBAAoB;AAC9D,0CAA0C,oBAAoB;AAC9D,yCAAyC,mBAAmB;AAC5D,2CAA2C,qBAAqB;AAChE;AACA;AACA;AACA,0BAA0B,mBAAmB,2BAA2B;AACxE;AACA;AACA,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kGAAkG;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,qIAAqI;AACzJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA,4BAA4B;AAC5B,6BAA6B;AAC7B,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,6BAA6B;AACjD;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA,yCAAyC,qEAAqE;AAC9G;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,mFAAmF;AACnH,mCAAmC,UAAU;AAC7C;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA,kBAAkB,+BAA+B,gCAAgC;AACjF,oBAAoB,+BAA+B,gCAAgC;AACnF;AACA;AACA,aAAa,SAAS;AACtB,sBAAsB,0CAA0C;AAChE,mBAAmB,qBAAqB,oBAAoB;AAC5D,sBAAsB,oFAAoF,oBAAoB;AAC9H,sBAAsB,oFAAoF,oBAAoB;AAC9H,oBAAoB,wDAAwD,2BAA2B;AACvG,oBAAoB,wDAAwD,yBAAyB;AACrG,oBAAoB,YAAY,gBAAgB,cAAc,8CAA8C,UAAU;AACtH;AACA,gCAAgC,qCAAqC,2DAA2D,EAAE;AAClI,+BAA+B,sCAAsC,2DAA2D,EAAE;AAClI,mCAAmC,2DAA2D,EAAE;AAChG,gCAAgC,wCAAwC,EAAE;AAC1E,6BAA6B,sDAAsD,EAAE;AACrF,8BAA8B,gCAAgC,EAAE;AAChE,+BAA+B,0CAA0C,EAAE;AAC3E,6BAA6B,sCAAsC,EAAE;AACrE,6BAA6B,sCAAsC,EAAE;AACrE,4BAA4B,sCAAsC,EAAE;AACpE,4BAA4B,sCAAsC,EAAE;AACpE,+BAA+B,sCAAsC,EAAE;AACvE,+BAA+B,sCAAsC,EAAE;AACvE,6BAA6B,sCAAsC,EAAE;AACrE,6BAA6B,sCAAsC,EAAE;AACrE,mCAAmC,sCAAsC,EAAE;AAC3E,mCAAmC,sCAAsC,EAAE;AAC3E,+BAA+B,sCAAsC,EAAE;AACvE,+BAA+B,sCAAsC,EAAE;AACvE,gCAAgC,sCAAsC,EAAE;AACxE,gCAAgC,sCAAsC,EAAE;AACxE,4BAA4B,sCAAsC,EAAE;AACpE,4BAA4B,sCAAsC,EAAE;AACpE,mCAAmC,sCAAsC,EAAE;AAC3E,mCAAmC,sCAAsC,EAAE;AAC3E,4BAA4B,2CAA2C,EAAE;AACzE,gCAAgC,2CAA2C,EAAE;AAC7E,+BAA+B,2CAA2C,EAAE;AAC5E,0BAA0B,2CAA2C,EAAE;AACvE,8BAA8B,iCAAiC,EAAE;AACjE,8BAA8B,iCAAiC,EAAE;AACjE;AACA,mBAAmB;AACnB,sBAAsB,wBAAwB,EAAE;AAChD,+BAA+B,iCAAiC,EAAE;AAClE,6BAA6B,uBAAuB,EAAE;AACtD,sBAAsB,eAAe,EAAE;AACvC,uBAAuB,eAAe,EAAE;AACxC,uBAAuB,eAAe,EAAE;AACxC,0BAA0B,eAAe,EAAE;AAC3C,sBAAsB,eAAe,EAAE;AACvC,wBAAwB,eAAe,EAAE;AACzC,6BAA6B,6CAA6C,EAAE;AAC5E,8BAA8B,qGAAqG,EAAE;AACrI,uBAAuB,eAAe,EAAE;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,2BAA2B,oCAAoC,EAAE;AACjE,gCAAgC,oCAAoC,EAAE;AACtE,8BAA8B,oCAAoC,EAAE;AACpE,gCAAgC,oCAAoC,EAAE;AACtE,4BAA4B,oCAAoC,EAAE;AAClE,6BAA6B,oCAAoC,EAAE;AACnE,+BAA+B,oCAAoC,EAAE;AACrE,+BAA+B,oCAAoC,EAAE;AACrE,8BAA8B,oCAAoC,EAAE;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,2BAA2B,0DAA0D,EAAE;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,wBAAwB,IAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,IAAI;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,kBAAkB,kEAAkE;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,gCAAgC,2BAA2B;AAC3D;;AAEA;AACA,oCAAoC,qCAAqC,aAAa;AACtF;AACA;AACA;AACA,2FAA2F;AAC3F;AACA;AACA;AACA,6BAA6B,2CAA2C;AACxE;AACA;AACA,6BAA6B,iCAAiC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qBAAqB;AACrB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;;AAEA,qBAAqB,6CAA6C;AAClE;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,UAAU,mGAAmG;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,yCAAyC,8CAA8C,aAAa;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,uBAAuB;AAC1C;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,gBAAgB,QAAQ,iBAAiB,sBAAsB;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,YAAY;AAC/B;AACA,iBAAiB;AACjB;AACA,UAAU,WAAW,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,YAAY;AACjC;AACA,sBAAsB,OAAO,OAAO;AACpC;AACA;AACA,yCAAyC,OAAO,0BAA0B;AAC1E,qBAAqB,0BAA0B;AAC/C,+CAA+C,OAAO,QAAQ,OAAO;AACrE;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,2BAA2B;AAC9C;AACA;AACA;AACA;AACA,sBAAsB,gBAAgB,gBAAgB;AACtD;AACA;AACA;AACA;AACA;AACA,mBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA,sBAAsB,gBAAgB,gBAAgB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,qBAAqB,EAAE;AACxC;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,qBAAqB,YAAY;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,kBAAkB,mDAAmD,EAAE,oBAAoB;AACrI,+CAA+C;AAC/C;AACA,KAAK,oBAAoB;AACzB;AACA,uBAAuB,eAAe,EAAE;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA,uBAAuB,eAAe,EAAE;AACxC;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,GAAG;AACrC,mBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA,WAAW;AACX;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA,WAAW;AACX;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,iBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC,OAAO;AACP;AACA;AACA,mBAAmB,cAAc;AACjC,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gBAAgB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,kBAAkB,mDAAmD,EAAE,oBAAoB;AACrI,+CAA+C;AAC/C;AACA,KAAK,oBAAoB;AACzB;AACA,uBAAuB,eAAe,EAAE;AACxC;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,oBAAoB,EAAE;AAC1E;AACA;AACA,wCAAwC,4BAA4B,EAAE;;AAEtE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA,WAAW;AACX;AACA,uBAAuB,yBAAyB;AAChD;AACA,WAAW;AACX;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,iBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC,OAAO;AACP;AACA,mBAAmB,cAAc;AACjC,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,2BAA2B;AAC1C;AACA;AACA;AACA;AACA,eAAe,4BAA4B;AAC3C;AACA;AACA;AACA;AACA,eAAe,6BAA6B;AAC5C;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA,mBAAmB,cAAc;AACjC;AACA;AACA,eAAe,8BAA8B;AAC7C;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB,EAAE;AAChD,wBAAwB,mDAAmD,EAAE;AAC7E;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,eAAe,wBAAwB;AACvC;AACA;AACA;AACA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,0BAA0B,sCAAsC;;AAEhE;AACA,CAAC;;;;;;;;;;;;;AC11FD,eAAe,KAAiD,oBAAoB,SAAmG,CAAC,oBAAoB,mBAAmB,SAAS,cAAc,4BAA4B,YAAY,qBAAqB,2DAA2D,uCAAuC,qCAAqC,oBAAoB,EAAE,iBAAiB,4FAA4F,eAAe,wCAAwC,SAAS,EAAE,mBAAmB,8BAA8B,qDAAqD,0BAA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C,sBAAsB,GAAG,oHAAoH,6BAA6B,8BAA8B,EAAE,+BAA+B,uGAAuG,EAAE,4BAA4B,yDAAyD,EAAE,qCAAqC,MAAM,uBAAuB,wBAAwB,KAAK,qDAAqD,mCAAmC,qBAAqB,uBAAuB,MAAM,qCAAqC,MAAM,qBAAqB,MAAM,iCAAiC,sBAAsB,EAAE,2BAA2B,oBAAoB,EAAE,8BAA8B,gBAAgB,wCAAwC,6BAA6B,MAAM,iCAAiC,GAAG,yBAAyB,SAAS,6BAA6B,SAAS,6BAA6B,SAAS,qCAAqC,SAAS,GAAG,GAAG,G;;;;;;;;;;;ACAty9B;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA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","file":"demo.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"./node_modules/jazz-midi sync recursive\";","var path='./bin/';\r\nvar v=process.versions.node.split('.');\r\nif (v[0]==0 && v[1]<=10) path+='0_10/';\r\nelse if (v[0]==0 && v[1]<=12) path+='0_12/';\r\nelse if (v[0]<=4) path+='4_9/';\r\nelse if (v[0]<=5) path+='5_12/';\r\nelse if (v[0]<=6) path+='6_14/';\r\nelse if (v[0]<=7) path+='7_10/';\r\nelse if (v[0]<=8) path+='8_12/';\r\nelse if (v[0]<=9) path+='9_11/';\r\nelse if (v[0]<=10) path+='10_15/';\r\nelse if (v[0]<=11) path+='11_15/';\r\nif(process.platform==\"win32\"&&process.arch==\"ia32\") path+='win32/jazz';\r\nelse if(process.platform==\"win32\"&&process.arch==\"x64\") path+='win64/jazz';\r\nelse if(process.platform==\"darwin\"&&process.arch==\"x64\") path+='macos64/jazz';\r\nelse if(process.platform==\"darwin\"&&process.arch==\"ia32\") path+='macos32/jazz';\r\nelse if(process.platform==\"linux\"&&process.arch==\"x64\") path+='linux64/jazz';\r\nelse if(process.platform==\"linux\"&&process.arch==\"ia32\") path+='linux32/jazz';\r\nelse if(process.platform==\"linux\"&&process.arch==\"arm\") path+='linuxa7/jazz';\r\nmodule.exports=require(path);\r\nmodule.exports.package=require(__dirname + '/package.json');\r\n","(function(global, factory) {\r\n  if (typeof exports === 'object' && typeof module !== 'undefined') {\r\n    module.exports = factory;\r\n  }\r\n  else if (typeof define === 'function' && define.amd) {\r\n    define('JZZ.synth.Tiny', ['JZZ'], factory);\r\n  }\r\n  else {\r\n    factory(JZZ);\r\n  }\r\n})(this, function(JZZ) {\r\n\r\n  if (!JZZ) return;\r\n  if (!JZZ.synth) JZZ.synth = {};\r\n  if (JZZ.synth.Tiny) return;\r\n\r\n  var _version = '1.1.4';\r\n\r\nfunction WebAudioTinySynth(opt){\r\n  this.__proto__ = this.sy =\r\n  /* webaudio-tynysynth core object */\r\n  {\r\n    is:\"webaudio-tinysynth\",\r\n    properties:{\r\n      masterVol:  {type:Number, value:0.5, observer:\"setMasterVol\"},\r\n      reverbLev:  {type:Number, value:0.3, observer:\"setReverbLev\"},\r\n      quality:    {type:Number, value:1, observer:\"setQuality\"},\r\n      debug:      {type:Number, value:0},\r\n      src:        {type:String, value:null, observer:\"loadMIDIUrl\"},\r\n      loop:       {type:Number, value:0},\r\n      //internalcontext: {type:Number, value:1},\r\n      tsmode:     {type:Number, value:0},\r\n      voices:     {type:Number, value:64},\r\n      useReverb:  {type:Number, value:1},\r\n      /**/\r\n    },\r\n    /**/\r\n    program:[],\r\n    drummap:[],\r\n    program1:[\r\n      // 1-8 : Piano\r\n      [{w:\"sine\",v:.4,d:0.7,r:0.1,},{w:\"triangle\",v:3,d:0.7,s:0.1,g:1,a:0.01,k:-1.2}],\r\n      [{w:\"triangle\",v:0.4,d:0.7,r:0.1,},{w:\"triangle\",v:4,t:3,d:0.4,s:0.1,g:1,k:-1,a:0.01,}],\r\n      [{w:\"sine\",d:0.7,r:0.1,},{w:\"triangle\",v:4,f:2,d:0.5,s:0.5,g:1,k:-1}],\r\n      [{w:\"sine\",d:0.7,v:0.2,},{w:\"triangle\",v:4,t:3,f:2,d:0.3,g:1,k:-1,a:0.01,s:0.5,}],\r\n      [{w:\"sine\",v:0.35,d:0.7,},{w:\"sine\",v:3,t:7,f:1,d:1,s:1,g:1,k:-.7}],\r\n      [{w:\"sine\",v:0.35,d:0.7,},{w:\"sine\",v:8,t:7,f:1,d:0.5,s:1,g:1,k:-.7}],\r\n      [{w:\"sawtooth\",v:0.34,d:2,},{w:\"sine\",v:8,f:0.1,d:2,s:1,r:2,g:1,}],\r\n      [{w:\"triangle\",v:0.34,d:1.5,},{w:\"square\",v:6,f:0.1,d:1.5,s:0.5,r:2,g:1,}],\r\n      /* 9-16 : Chromatic Perc*/\r\n      [{w:\"sine\",d:0.3,r:0.3,},{w:\"sine\",v:7,t:11,d:0.03,g:1,}],\r\n      [{w:\"sine\",d:0.3,r:0.3,},{w:\"sine\",v:11,t:6,d:0.2,s:0.4,g:1,}],\r\n      [{w:\"sine\",v:0.2,d:0.3,r:0.3,},{w:\"sine\",v:11,t:5,d:0.1,s:0.4,g:1,}],\r\n      [{w:\"sine\",v:0.2,d:0.6,r:0.6,},{w:\"triangle\",v:11,t:5,f:1,s:0.5,g:1,}],\r\n      [{w:\"sine\",v:0.3,d:0.2,r:0.2,},{w:\"sine\",v:6,t:5,d:0.02,g:1,}],\r\n      [{w:\"sine\",v:0.3,d:0.2,r:0.2,},{w:\"sine\",v:7,t:11,d:0.03,g:1,}],\r\n      [{w:\"sine\",v:0.2,d:1,r:1,},{w:\"sine\",v:11,t:3.5,d:1,r:1,g:1,}],\r\n      [{w:\"triangle\",v:0.2,d:0.5,r:0.2,},{w:\"sine\",v:6,t:2.5,d:0.2,s:0.1,r:0.2,g:1,}],\r\n      /* 17-24 : Organ */\r\n      [{w:\"w9999\",v:0.22,s:0.9,},{w:\"w9999\",v:0.22,t:2,f:2,s:0.9,}],\r\n      [{w:\"w9999\",v:0.2,s:1,},{w:\"sine\",v:11,t:6,f:2,s:0.1,g:1,h:0.006,r:0.002,d:0.002,},{w:\"w9999\",v:0.2,t:2,f:1,h:0,s:1,}],\r\n      [{w:\"w9999\",v:0.2,d:0.1,s:0.9,},{w:\"w9999\",v:0.25,t:4,f:2,s:0.5,}],\r\n      [{w:\"w9999\",v:0.3,a:0.04,s:0.9,},{w:\"w9999\",v:0.2,t:8,f:2,a:0.04,s:0.9,}],\r\n      [{w:\"sine\",v:0.2,a:0.02,d:0.05,s:1,},{w:\"sine\",v:6,t:3,f:1,a:0.02,d:0.05,s:1,g:1,}],\r\n      [{w:\"triangle\",v:0.2,a:0.02,d:0.05,s:0.8,},{w:\"square\",v:7,t:3,f:1,d:0.05,s:1.5,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:0.2,s:0.5,},{w:\"square\",v:1,d:0.03,s:2,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:0.1,s:0.8,},{w:\"square\",v:1,a:0.3,d:0.1,s:2,g:1,}],\r\n      /* 25-32 : Guitar */\r\n      [{w:\"sine\",v:0.3,d:0.5,f:1,},{w:\"triangle\",v:5,t:3,f:-1,d:1,s:0.1,g:1,}],\r\n      [{w:\"sine\",v:0.4,d:0.6,f:1,},{w:\"triangle\",v:12,t:3,d:0.6,s:0.1,g:1,f:-1,}],\r\n      [{w:\"triangle\",v:0.3,d:1,f:1,},{w:\"triangle\",v:6,f:-1,d:0.4,s:0.5,g:1,t:3,}],\r\n      [{w:\"sine\",v:0.3,d:1,f:-1,},{w:\"triangle\",v:11,f:1,d:0.4,s:0.5,g:1,t:3,}],\r\n      [{w:\"sine\",v:0.4,d:0.1,r:0.01},{w:\"sine\",v:7,g:1,}],\r\n      [{w:\"triangle\",v:0.4,d:1,f:1,},{w:\"square\",v:4,f:-1,d:1,s:0.7,g:1,}],//[{w:\"triangle\",v:0.35,d:1,f:1,},{w:\"square\",v:7,f:-1,d:0.3,s:0.5,g:1,}],\r\n      [{w:\"triangle\",v:0.35,d:1,f:1,},{w:\"square\",v:7,f:-1,d:0.3,s:0.5,g:1,}],//[{w:\"triangle\",v:0.4,d:1,f:1,},{w:\"square\",v:4,f:-1,d:1,s:0.7,g:1,}],//[{w:\"triangle\",v:0.4,d:1,},{w:\"square\",v:4,f:2,d:1,s:0.7,g:1,}],\r\n      [{w:\"sine\",v:0.2,t:1.5,a:0.005,h:0.2,d:0.6,},{w:\"sine\",v:11,t:5,f:2,d:1,s:0.5,g:1,}],\r\n      /* 33-40 : Bass */\r\n      [{w:\"sine\",d:0.3,},{w:\"sine\",v:4,t:3,d:1,s:1,g:1,}],\r\n      [{w:\"sine\",d:0.3,},{w:\"sine\",v:4,t:3,d:1,s:1,g:1,}],\r\n      [{w:\"w9999\",d:0.3,v:0.7,s:0.5,},{w:\"sawtooth\",v:1.2,d:0.02,s:0.5,g:1,h:0,r:0.02,}],\r\n      [{w:\"sine\",d:0.3,},{w:\"sine\",v:4,t:3,d:1,s:1,g:1,}],\r\n      [{w:\"triangle\",v:0.3,t:2,d:1,},{w:\"triangle\",v:15,t:2.5,d:0.04,s:0.1,g:1,}],\r\n      [{w:\"triangle\",v:0.3,t:2,d:1,},{w:\"triangle\",v:15,t:2.5,d:0.04,s:0.1,g:1,}],\r\n      [{w:\"triangle\",d:0.7,},{w:\"square\",v:0.4,t:0.5,f:1,d:0.2,s:10,g:1,}],\r\n      [{w:\"triangle\",d:0.7,},{w:\"square\",v:0.4,t:0.5,f:1,d:0.2,s:10,g:1,}],\r\n      /* 41-48 : Strings */\r\n      [{w:\"sawtooth\",v:0.4,a:0.1,d:11,},{w:\"sine\",v:5,d:11,s:0.2,g:1,}],\r\n      [{w:\"sawtooth\",v:0.4,a:0.1,d:11,},{w:\"sine\",v:5,d:11,s:0.2,g:1,}],\r\n      [{w:\"sawtooth\",v:0.4,a:0.1,d:11,},{w:\"sine\",v:5,t:0.5,d:11,s:0.2,g:1,}],\r\n      [{w:\"sawtooth\",v:0.4,a:0.1,d:11,},{w:\"sine\",v:5,t:0.5,d:11,s:0.2,g:1,}],\r\n      [{w:\"sine\",v:0.4,a:0.1,d:11,},{w:\"sine\",v:6,f:2.5,d:0.05,s:1.1,g:1,}],\r\n      [{w:\"sine\",v:0.3,d:0.1,r:0.1,},{w:\"square\",v:4,t:3,d:1,s:0.2,g:1,}],\r\n      [{w:\"sine\",v:0.3,d:0.5,r:0.5,},{w:\"sine\",v:7,t:2,f:2,d:1,r:1,g:1,}],\r\n      [{w:\"triangle\",v:0.6,h:0.03,d:0.3,r:0.3,t:0.5,},{w:\"n0\",v:8,t:1.5,d:0.08,r:0.08,g:1,}],\r\n      /* 49-56 : Ensamble */\r\n      [{w:\"sawtooth\",v:0.3,a:0.03,s:0.5,},{w:\"sawtooth\",v:0.2,t:2,f:2,d:1,s:2,}],\r\n      [{w:\"sawtooth\",v:0.3,f:-2,a:0.03,s:0.5,},{w:\"sawtooth\",v:0.2,t:2,f:2,d:1,s:2,}],\r\n      [{w:\"sawtooth\",v:0.2,a:0.02,s:1,},{w:\"sawtooth\",v:0.2,t:2,f:2,a:1,d:1,s:1,}],\r\n      [{w:\"sawtooth\",v:0.2,a:0.02,s:1,},{w:\"sawtooth\",v:0.2,f:2,a:0.02,d:1,s:1,}],\r\n      [{w:\"triangle\",v:0.3,a:0.03,s:1,},{w:\"sine\",v:3,t:5,f:1,d:1,s:1,g:1,}],\r\n      [{w:\"sine\",v:0.4,a:0.03,s:0.9,},{w:\"sine\",v:1,t:2,f:3,d:0.03,s:0.2,g:1,}],\r\n      [{w:\"triangle\",v:0.6,a:0.05,s:0.5,},{w:\"sine\",v:1,f:0.8,d:0.2,s:0.2,g:1,}],\r\n      [{w:\"square\",v:0.15,a:0.01,d:0.2,r:0.2,t:0.5,h:0.03,},{w:\"square\",v:4,f:0.5,d:0.2,r:11,a:0.01,g:1,h:0.02,},{w:\"square\",v:0.15,t:4,f:1,a:0.02,d:0.15,r:0.15,h:0.03,},{g:3,w:\"square\",v:4,f:-0.5,a:0.01,h:0.02,d:0.15,r:11,}],\r\n      /* 57-64 : Brass */\r\n      [{w:\"square\",v:0.2,a:0.01,d:1,s:0.6,r:0.04,},{w:\"sine\",v:1,d:0.1,s:4,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:1,s:0.5,r:0.08,},{w:\"sine\",v:1,d:0.1,s:4,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.04,d:1,s:0.4,r:0.08,},{w:\"sine\",v:1,d:0.1,s:4,g:1,}],\r\n      [{w:\"square\",v:0.15,a:0.04,s:1,},{w:\"sine\",v:2,d:0.1,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:1,s:0.5,r:0.08,},{w:\"sine\",v:1,d:0.1,s:4,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:1,s:0.6,r:0.08,},{w:\"sine\",v:1,f:0.2,d:0.1,s:4,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:0.5,s:0.7,r:0.08,},{w:\"sine\",v:1,d:0.1,s:4,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:1,s:0.5,r:0.08,},{w:\"sine\",v:1,d:0.1,s:4,g:1,}],\r\n      /* 65-72 : Reed */\r\n      [{w:\"square\",v:0.2,a:0.02,d:2,s:0.6,},{w:\"sine\",v:2,d:1,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:2,s:0.6,},{w:\"sine\",v:2,d:1,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:1,s:0.6,},{w:\"sine\",v:2,d:1,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.02,d:1,s:0.6,},{w:\"sine\",v:2,d:1,g:1,}],\r\n      [{w:\"sine\",v:0.4,a:0.02,d:0.7,s:0.5,},{w:\"square\",v:5,t:2,d:0.2,s:0.5,g:1,}],\r\n      [{w:\"sine\",v:0.3,a:0.05,d:0.2,s:0.8,},{w:\"sawtooth\",v:6,f:0.1,d:0.1,s:0.3,g:1,}],\r\n      [{w:\"sine\",v:0.3,a:0.03,d:0.2,s:0.4,},{w:\"square\",v:7,f:0.2,d:1,s:0.1,g:1,}],\r\n      [{w:\"square\",v:0.2,a:0.05,d:0.1,s:0.8,},{w:\"square\",v:4,d:0.1,s:1.1,g:1,}],\r\n      /* 73-80 : Pipe */\r\n      [{w:\"sine\",a:0.02,d:2,},{w:\"sine\",v:6,t:2,d:0.04,g:1,}],\r\n      [{w:\"sine\",v:0.7,a:0.03,d:0.4,s:0.4,},{w:\"sine\",v:4,t:2,f:0.2,d:0.4,g:1,}],\r\n      [{w:\"sine\",v:0.7,a:0.02,d:0.4,s:0.6,},{w:\"sine\",v:3,t:2,d:0,s:1,g:1,}],\r\n      [{w:\"sine\",v:0.4,a:0.06,d:0.3,s:0.3,},{w:\"sine\",v:7,t:2,d:0.2,s:0.2,g:1,}],\r\n      [{w:\"sine\",a:0.02,d:0.3,s:0.3,},{w:\"sawtooth\",v:3,t:2,d:0.3,g:1,}],\r\n      [{w:\"sine\",v:0.4,a:0.02,d:2,s:0.1,},{w:\"sawtooth\",v:8,t:2,f:1,d:0.5,g:1,}],\r\n      [{w:\"sine\",v:0.7,a:0.03,d:0.5,s:0.3,},{w:\"sine\",v:0.003,t:0,f:4,d:0.1,s:0.002,g:1,}],\r\n      [{w:\"sine\",v:0.7,a:0.02,d:2,},{w:\"sine\",v:1,t:2,f:1,d:0.02,g:1,}],\r\n      /* 81-88 : SynthLead */\r\n      [{w:\"square\",v:0.3,d:1,s:0.5,},{w:\"square\",v:1,f:0.2,d:1,s:0.5,g:1,}],\r\n      [{w:\"sawtooth\",v:0.3,d:2,s:0.5,},{w:\"square\",v:2,f:0.1,s:0.5,g:1,}],\r\n      [{w:\"triangle\",v:0.5,a:0.05,d:2,s:0.6,},{w:\"sine\",v:4,t:2,g:1,}],\r\n      [{w:\"triangle\",v:0.3,a:0.01,d:2,s:0.3,},{w:\"sine\",v:22,t:2,f:1,d:0.03,s:0.2,g:1,}],\r\n      [{w:\"sawtooth\",v:0.3,d:1,s:0.5,},{w:\"sine\",v:11,t:11,a:0.2,d:0.05,s:0.3,g:1,}],\r\n      [{w:\"sine\",v:0.3,a:0.06,d:1,s:0.5,},{w:\"sine\",v:7,f:1,d:1,s:0.2,g:1,}],\r\n      [{w:\"sawtooth\",v:0.3,a:0.03,d:0.7,s:0.3,r:0.2,},{w:\"sawtooth\",v:0.3,t:0.75,d:0.7,a:0.1,s:0.3,r:0.2,}],\r\n      [{w:\"triangle\",v:0.3,a:0.01,d:0.7,s:0.5,},{w:\"square\",v:5,t:0.5,d:0.7,s:0.5,g:1,}],\r\n      /* 89-96 : SynthPad */\r\n      [{w:\"triangle\",v:0.3,a:0.02,d:0.3,s:0.3,r:0.3,},{w:\"square\",v:3,t:4,f:1,a:0.02,d:0.1,s:1,g:1,},{w:\"triangle\",v:0.08,t:0.5,a:0.1,h:0,d:0.1,s:0.5,r:0.1,b:0,c:0,}],\r\n      [{w:\"sine\",v:0.3,a:0.05,d:1,s:0.7,r:0.3,},{w:\"sine\",v:2,f:1,d:0.3,s:1,g:1,}],\r\n      [{w:\"square\",v:0.3,a:0.03,d:0.5,s:0.3,r:0.1,},{w:\"square\",v:4,f:1,a:0.03,d:0.1,g:1,}],\r\n      [{w:\"triangle\",v:0.3,a:0.08,d:1,s:0.3,r:0.1,},{w:\"square\",v:2,f:1,d:0.3,s:0.3,g:1,t:4,a:0.08,}],\r\n      [{w:\"sine\",v:0.3,a:0.05,d:1,s:0.3,r:0.1,},{w:\"sine\",v:0.1,t:2.001,f:1,d:1,s:50,g:1,}],\r\n      [{w:\"triangle\",v:0.3,a:0.03,d:0.7,s:0.3,r:0.2,},{w:\"sine\",v:12,t:7,f:1,d:0.5,s:1.7,g:1,}],\r\n      [{w:\"sine\",v:0.3,a:0.05,d:1,s:0.3,r:0.1,},{w:\"sawtooth\",v:22,t:6,d:0.06,s:0.3,g:1,}],\r\n      [{w:\"triangle\",v:0.3,a:0.05,d:11,r:0.3,},{w:\"triangle\",v:1,d:1,s:8,g:1,}],\r\n      /* 97-104 : FX */\r\n      [{w:\"sawtooth\",v:0.3,d:4,s:0.8,r:0.1,},{w:\"square\",v:1,t:2,f:8,a:1,d:1,s:1,r:0.1,g:1,}],\r\n      [{w:\"triangle\",v:0.3,d:1,s:0.5,t:0.8,a:0.2,p:1.25,q:0.2,},{w:\"sawtooth\",v:0.2,a:0.2,d:0.3,s:1,t:1.2,p:1.25,q:0.2,}],\r\n      [{w:\"sine\",v:0.3,d:1,s:0.3,},{w:\"square\",v:22,t:11,d:0.5,s:0.1,g:1,}],\r\n      [{w:\"sawtooth\",v:0.3,a:0.04,d:1,s:0.8,r:0.1,},{w:\"square\",v:1,t:0.5,d:1,s:2,g:1,}],\r\n      [{w:\"triangle\",v:0.3,d:1,s:0.3,},{w:\"sine\",v:22,t:6,d:0.6,s:0.05,g:1,}],\r\n      [{w:\"sine\",v:0.6,a:0.1,d:0.05,s:0.4,},{w:\"sine\",v:5,t:5,f:1,d:0.05,s:0.3,g:1,}],\r\n      [{w:\"sine\",a:0.1,d:0.05,s:0.4,v:0.8,},{w:\"sine\",v:5,t:5,f:1,d:0.05,s:0.3,g:1,}],\r\n      [{w:\"square\",v:0.3,a:0.1,d:0.1,s:0.4,},{w:\"square\",v:1,f:1,d:0.3,s:0.1,g:1,}],\r\n      /* 105-112 : Ethnic */\r\n      [{w:\"sawtooth\",v:0.3,d:0.5,r:0.5,},{w:\"sawtooth\",v:11,t:5,d:0.05,g:1,}],\r\n      [{w:\"square\",v:0.3,d:0.2,r:0.2,},{w:\"square\",v:7,t:3,d:0.05,g:1,}],\r\n      [{w:\"triangle\",d:0.2,r:0.2,},{w:\"square\",v:9,t:3,d:0.1,r:0.1,g:1,}],\r\n      [{w:\"triangle\",d:0.3,r:0.3,},{w:\"square\",v:6,t:3,d:1,r:1,g:1,}],\r\n      [{w:\"triangle\",v:0.4,d:0.2,r:0.2,},{w:\"square\",v:22,t:12,d:0.1,r:0.1,g:1,}],\r\n      [{w:\"sine\",v:0.25,a:0.02,d:0.05,s:0.8,},{w:\"square\",v:1,t:2,d:0.03,s:11,g:1,}],\r\n      [{w:\"sine\",v:0.3,a:0.05,d:11,},{w:\"square\",v:7,t:3,f:1,s:0.7,g:1,}],\r\n      [{w:\"square\",v:0.3,a:0.05,d:0.1,s:0.8,},{w:\"square\",v:4,d:0.1,s:1.1,g:1,}],\r\n      /* 113-120 : Percussive */\r\n      [{w:\"sine\",v:0.4,d:0.3,r:0.3,},{w:\"sine\",v:7,t:9,d:0.1,r:0.1,g:1,}],\r\n      [{w:\"sine\",v:0.7,d:0.1,r:0.1,},{w:\"sine\",v:22,t:7,d:0.05,g:1,}],\r\n      [{w:\"sine\",v:0.6,d:0.15,r:0.15,},{w:\"square\",v:11,t:3.2,d:0.1,r:0.1,g:1,}],\r\n      [{w:\"sine\",v:0.8,d:0.07,r:0.07,},{w:\"square\",v:11,t:7,r:0.01,g:1,}],\r\n      [{w:\"triangle\",v:0.7,t:0.5,d:0.2,r:0.2,p:0.95,},{w:\"n0\",v:9,g:1,d:0.2,r:0.2,}],\r\n      [{w:\"sine\",v:0.7,d:0.1,r:0.1,p:0.9,},{w:\"square\",v:14,t:2,d:0.005,r:0.005,g:1,}],\r\n      [{w:\"square\",d:0.15,r:0.15,p:0.5,},{w:\"square\",v:4,t:5,d:0.001,r:0.001,g:1,}],\r\n      [{w:\"n1\",v:0.3,a:1,s:1,d:0.15,r:0,t:0.5,}],\r\n      /* 121-128 : SE */\r\n      [{w:\"sine\",t:12.5,d:0,r:0,p:0.5,v:0.3,h:0.2,q:0.5,},{g:1,w:\"sine\",v:1,t:2,d:0,r:0,s:1,},{g:1,w:\"n0\",v:0.2,t:2,a:0.6,h:0,d:0.1,r:0.1,b:0,c:0,}],\r\n      [{w:\"n0\",v:0.2,a:0.05,h:0.02,d:0.02,r:0.02,}],\r\n      [{w:\"n0\",v:0.4,a:1,d:1,t:0.25,}],\r\n      [{w:\"sine\",v:0.3,a:0.1,d:1,s:0.5,},{w:\"sine\",v:4,t:0,f:1.5,d:1,s:1,r:0.1,g:1,},{g:1,w:\"sine\",v:4,t:0,f:2,a:0.6,h:0,d:0.1,s:1,r:0.1,b:0,c:0,}],\r\n      [{w:\"square\",v:0.3,t:0.25,d:11,s:1,},{w:\"square\",v:12,t:0,f:8,d:1,s:1,r:11,g:1,}],\r\n      [{w:\"n0\",v:0.4,t:0.5,a:1,d:11,s:1,r:0.5,},{w:\"square\",v:1,t:0,f:14,d:1,s:1,r:11,g:1,}],\r\n      [{w:\"sine\",t:0,f:1221,a:0.2,d:1,r:0.25,s:1,},{g:1,w:\"n0\",v:3,t:0.5,d:1,s:1,r:1,}],\r\n      [{w:\"sine\",d:0.4,r:0.4,p:0.1,t:2.5,v:1,},{w:\"n0\",v:12,t:2,d:1,r:1,g:1,}],\r\n    ],\r\n    program0:[\r\n// 1-8 : Piano\r\n      [{w:\"triangle\",v:.5,d:.7}],                   [{w:\"triangle\",v:.5,d:.7}],\r\n      [{w:\"triangle\",v:.5,d:.7}],                   [{w:\"triangle\",v:.5,d:.7}],\r\n      [{w:\"triangle\",v:.5,d:.7}],                   [{w:\"triangle\",v:.5,d:.7}],\r\n      [{w:\"sawtooth\",v:.3,d:.7}],                   [{w:\"sawtooth\",v:.3,d:.7}],\r\n/* 9-16 : Chromatic Perc*/\r\n      [{w:\"sine\",v:.5,d:.3,r:.3}],                  [{w:\"triangle\",v:.5,d:.3,r:.3}],\r\n      [{w:\"square\",v:.2,d:.3,r:.3}],                [{w:\"square\",v:.2,d:.3,r:.3}],\r\n      [{w:\"sine\",v:.5,d:.1,r:.1}],                  [{w:\"sine\",v:.5,d:.1,r:.1}],\r\n      [{w:\"square\",v:.2,d:1,r:1}],                  [{w:\"sawtooth\",v:.3,d:.7,r:.7}],\r\n/* 17-24 : Organ */\r\n      [{w:\"sine\",v:0.5,a:0.01,s:1}],                [{w:\"sine\",v:0.7,d:0.02,s:0.7}],\r\n      [{w:\"square\",v:.2,s:1}],                      [{w:\"triangle\",v:.5,a:.01,s:1}],\r\n      [{w:\"square\",v:.2,a:.02,s:1}],                [{w:\"square\",v:0.2,a:0.02,s:1}],\r\n      [{w:\"square\",v:0.2,a:0.02,s:1}],              [{w:\"square\",v:.2,a:.05,s:1}],\r\n/* 25-32 : Guitar */\r\n      [{w:\"triangle\",v:.5,d:.5}],                   [{w:\"square\",v:.2,d:.6}],\r\n      [{w:\"square\",v:.2,d:.6}],                     [{w:\"triangle\",v:.8,d:.6}],\r\n      [{w:\"triangle\",v:.4,d:.05}],                  [{w:\"square\",v:.2,d:1}],\r\n      [{w:\"square\",v:.2,d:1}],                      [{w:\"sine\",v:.4,d:.6}],\r\n/* 33-40 : Bass */\r\n      [{w:\"triangle\",v:.7,d:.4}],                   [{w:\"triangle\",v:.7,d:.7}],\r\n      [{w:\"triangle\",v:.7,d:.7}],                   [{w:\"triangle\",v:.7,d:.7}],\r\n      [{w:\"square\",v:.3,d:.2}],                     [{w:\"square\",v:.3,d:.2}],\r\n      [{w:\"square\",v:.3,d:.1,s:.2}],                [{w:\"sawtooth\",v:.4,d:.1,s:.2}],\r\n/* 41-48 : Strings */\r\n      [{w:\"sawtooth\",v:.2,a:.02,s:1}],              [{w:\"sawtooth\",v:.2,a:.02,s:1}],\r\n      [{w:\"sawtooth\",v:.2,a:.02,s:1}],              [{w:\"sawtooth\",v:.2,a:.02,s:1}],\r\n      [{w:\"sawtooth\",v:.2,a:.02,s:1}],              [{w:\"sawtooth\",v:.3,d:.1}],\r\n      [{w:\"sawtooth\",v:.3,d:.5,r:.5}],              [{w:\"triangle\",v:.6,d:.1,r:.1,h:0.03,p:0.8}],\r\n/* 49-56 : Ensamble */\r\n      [{w:\"sawtooth\",v:.2,a:.02,s:1}],              [{w:\"sawtooth\",v:.2,a:.02,s:1}],\r\n      [{w:\"sawtooth\",v:.2,a:.02,s:1}],              [{w:\"sawtooth\",v:.2,a:.02,s:1}],\r\n      [{w:\"triangle\",v:.3,a:.03,s:1}],              [{w:\"sine\",v:.3,a:.03,s:1}],\r\n      [{w:\"triangle\",v:.3,a:.05,s:1}],              [{w:\"sawtooth\",v:.5,a:.01,d:.1}],\r\n/* 57-64 : Brass */\r\n      [{w:\"square\",v:.3,a:.05,d:.2,s:.6}],          [{w:\"square\",v:.3,a:.05,d:.2,s:.6}],\r\n      [{w:\"square\",v:.3,a:.05,d:.2,s:.6}],          [{w:\"square\",v:0.2,a:.05,d:0.01,s:1}],\r\n      [{w:\"square\",v:.3,a:.05,s:1}],                [{w:\"square\",v:.3,s:.7}],\r\n      [{w:\"square\",v:.3,s:.7}],                     [{w:\"square\",v:.3,s:.7}],\r\n/* 65-72 : Reed */\r\n      [{w:\"square\",v:.3,a:.02,d:2}],                [{w:\"square\",v:.3,a:.02,d:2}],\r\n      [{w:\"square\",v:.3,a:.03,d:2}],                [{w:\"square\",v:.3,a:.04,d:2}],\r\n      [{w:\"square\",v:.3,a:.02,d:2}],                [{w:\"square\",v:.3,a:.05,d:2}],\r\n      [{w:\"square\",v:.3,a:.03,d:2}],                [{w:\"square\",v:.3,a:.03,d:2}],\r\n/* 73-80 : Pipe */\r\n      [{w:\"sine\",v:.7,a:.02,d:2}],                  [{w:\"sine\",v:.7,a:.02,d:2}],\r\n      [{w:\"sine\",v:.7,a:.02,d:2}],                  [{w:\"sine\",v:.7,a:.02,d:2}],\r\n      [{w:\"sine\",v:.7,a:.02,d:2}],                  [{w:\"sine\",v:.7,a:.02,d:2}],\r\n      [{w:\"sine\",v:.7,a:.02,d:2}],                  [{w:\"sine\",v:.7,a:.02,d:2}],\r\n/* 81-88 : SynthLead */\r\n      [{w:\"square\",v:.3,s:.7}],                     [{w:\"sawtooth\",v:.4,s:.7}],\r\n      [{w:\"triangle\",v:.5,s:.7}],                   [{w:\"sawtooth\",v:.4,s:.7}],\r\n      [{w:\"sawtooth\",v:.4,d:12}],                   [{w:\"sine\",v:.4,a:.06,d:12}],\r\n      [{w:\"sawtooth\",v:.4,d:12}],                   [{w:\"sawtooth\",v:.4,d:12}],\r\n/* 89-96 : SynthPad */\r\n      [{w:\"sawtooth\",v:.3,d:12}],                   [{w:\"triangle\",v:.5,d:12}],\r\n      [{w:\"square\",v:.3,d:12}],                     [{w:\"triangle\",v:.5,a:.08,d:11}],\r\n      [{w:\"sawtooth\",v:.5,a:.05,d:11}],             [{w:\"sawtooth\",v:.5,d:11}],\r\n      [{w:\"triangle\",v:.5,d:11}],                   [{w:\"triangle\",v:.5,d:11}],\r\n/* 97-104 : FX */\r\n      [{w:\"triangle\",v:.5,d:11}],                   [{w:\"triangle\",v:.5,d:11}],\r\n      [{w:\"square\",v:.3,d:11}],                     [{w:\"sawtooth\",v:0.5,a:0.04,d:11}],\r\n      [{w:\"sawtooth\",v:.5,d:11}],                   [{w:\"triangle\",v:.5,a:.8,d:11}],\r\n      [{w:\"triangle\",v:.5,d:11}],                   [{w:\"square\",v:.3,d:11}],\r\n/* 105-112 : Ethnic */\r\n      [{w:\"sawtooth\",v:.3,d:1,r:1}],                [{w:\"sawtooth\",v:.5,d:.3}],\r\n      [{w:\"sawtooth\",v:.5,d:.3,r:.3}],              [{w:\"sawtooth\",v:.5,d:.3,r:.3}],\r\n      [{w:\"square\",v:.3,d:.2,r:.2}],                [{w:\"square\",v:.3,a:.02,d:2}],\r\n      [{w:\"sawtooth\",v:.2,a:.02,d:.7}],             [{w:\"triangle\",v:.5,d:1}],\r\n/* 113-120 : Percussive */\r\n      [{w:\"sawtooth\",v:.3,d:.3,r:.3}],              [{w:\"sine\",v:.8,d:.1,r:.1}],\r\n      [{w:\"square\",v:.2,d:.1,r:.1,p:1.05}],         [{w:\"sine\",v:.8,d:.05,r:.05}],\r\n      [{w:\"triangle\",v:0.5,d:0.1,r:0.1,p:0.96}],    [{w:\"triangle\",v:0.5,d:0.1,r:0.1,p:0.97}],\r\n      [{w:\"square\",v:.3,d:.1,r:.1,}],               [{w:\"n1\",v:0.3,a:1,s:1,d:0.15,r:0,t:0.5,}],\r\n/* 121-128 : SE */\r\n      [{w:\"triangle\",v:0.5,d:0.03,t:0,f:1332,r:0.001,p:1.1}],\r\n      [{w:\"n0\",v:0.2,t:0.1,d:0.02,a:0.05,h:0.02,r:0.02}],\r\n      [{w:\"n0\",v:0.4,a:1,d:1,t:0.25,}],\r\n      [{w:\"sine\",v:0.3,a:0.8,d:1,t:0,f:1832}],\r\n      [{w:\"triangle\",d:0.5,t:0,f:444,s:1,}],\r\n      [{w:\"n0\",v:0.4,d:1,t:0,f:22,s:1,}],\r\n      [{w:\"n0\",v:0.5,a:0.2,d:11,t:0,f:44}],\r\n      [{w:\"n0\",v:0.5,t:0.25,d:0.4,r:0.4}],\r\n    ],\r\n    drummap1:[\r\n/*35*/  [{w:\"triangle\",t:0,f:70,v:1,d:0.05,h:0.03,p:0.9,q:0.1,},{w:\"n0\",g:1,t:6,v:17,r:0.01,h:0,p:0,}],\r\n        [{w:\"triangle\",t:0,f:88,v:1,d:0.05,h:0.03,p:0.5,q:0.1,},{w:\"n0\",g:1,t:5,v:42,r:0.01,h:0,p:0,}],\r\n        [{w:\"n0\",f:222,p:0,t:0,r:0.01,h:0,}],\r\n        [{w:\"triangle\",v:0.3,f:180,d:0.05,t:0,h:0.03,p:0.9,q:0.1,},{w:\"n0\",v:0.6,t:0,f:70,h:0.02,r:0.01,p:0,},{g:1,w:\"square\",v:2,t:0,f:360,r:0.01,b:0,c:0,}],\r\n        [{w:\"square\",f:1150,v:0.34,t:0,r:0.03,h:0.025,d:0.03,},{g:1,w:\"n0\",t:0,f:13,h:0.025,d:0.1,s:1,r:0.1,v:1,}],\r\n/*40*/  [{w:\"triangle\",f:200,v:1,d:0.06,t:0,r:0.06,},{w:\"n0\",g:1,t:0,f:400,v:12,r:0.02,d:0.02,}],\r\n        [{w:\"triangle\",f:100,v:0.9,d:0.12,h:0.02,p:0.5,t:0,r:0.12,},{g:1,w:\"n0\",v:5,t:0.4,h:0.015,d:0.005,r:0.005,}],\r\n        [{w:\"n1\",f:390,v:0.25,r:0.01,t:0,}],\r\n        [{w:\"triangle\",f:120,v:0.9,d:0.12,h:0.02,p:0.5,t:0,r:0.12,},{g:1,w:\"n0\",v:5,t:0.5,h:0.015,d:0.005,r:0.005,}],\r\n        [{w:\"n1\",v:0.25,f:390,r:0.03,t:0,h:0.005,d:0.03,}],\r\n/*45*/  [{w:\"triangle\",f:140,v:0.9,d:0.12,h:0.02,p:0.5,t:0,r:0.12,},{g:1,w:\"n0\",v:5,t:0.3,h:0.015,d:0.005,r:0.005,}],\r\n        [{w:\"n1\",v:0.25,f:390,t:0,d:0.2,r:0.2,},{w:\"n0\",v:0.3,t:0,c:0,f:440,h:0.005,d:0.05,}],\r\n        [{w:\"triangle\",f:155,v:0.9,d:0.12,h:0.02,p:0.5,t:0,r:0.12,},{g:1,w:\"n0\",v:5,t:0.3,h:0.015,d:0.005,r:0.005,}],\r\n        [{w:\"triangle\",f:180,v:0.9,d:0.12,h:0.02,p:0.5,t:0,r:0.12,},{g:1,w:\"n0\",v:5,t:0.3,h:0.015,d:0.005,r:0.005,}],\r\n        [{w:\"n1\",v:0.3,f:1200,d:0.2,r:0.2,h:0.05,t:0,},{w:\"n1\",t:0,v:1,d:0.1,r:0.1,p:1.2,f:440,}],\r\n/*50*/  [{w:\"triangle\",f:220,v:0.9,d:0.12,h:0.02,p:0.5,t:0,r:0.12,},{g:1,w:\"n0\",v:5,t:0.3,h:0.015,d:0.005,r:0.005,}],\r\n        [{w:\"n1\",f:500,v:0.15,d:0.4,r:0.4,h:0,t:0,},{w:\"n0\",v:0.1,t:0,r:0.01,f:440,}],\r\n        [{w:\"n1\",v:0.3,f:800,d:0.2,r:0.2,h:0.05,t:0,},{w:\"square\",t:0,v:1,d:0.1,r:0.1,p:0.1,f:220,g:1,}],\r\n        [{w:\"sine\",f:1651,v:0.15,d:0.2,r:0.2,h:0,t:0,},{w:\"sawtooth\",g:1,t:1.21,v:7.2,d:0.1,r:11,h:1,},{g:1,w:\"n0\",v:3.1,t:0.152,d:0.002,r:0.002,}],\r\n        null,\r\n/*55*/  [{w:\"n1\",v:.3,f:1200,d:0.2,r:0.2,h:0.05,t:0,},{w:\"n1\",t:0,v:1,d:0.1,r:0.1,p:1.2,f:440,}],\r\n        null,\r\n        [{w:\"n1\",v:0.3,f:555,d:0.25,r:0.25,h:0.05,t:0,},{w:\"n1\",t:0,v:1,d:0.1,r:0.1,f:440,a:0.005,h:0.02,}],\r\n        [{w:\"sawtooth\",f:776,v:0.2,d:0.3,t:0,r:0.3,},{g:1,w:\"n0\",v:2,t:0,f:776,a:0.005,h:0.02,d:0.1,s:1,r:0.1,c:0,},{g:11,w:\"sine\",v:0.1,t:0,f:22,d:0.3,r:0.3,b:0,c:0,}],\r\n        [{w:\"n1\",f:440,v:0.15,d:0.4,r:0.4,h:0,t:0,},{w:\"n0\",v:0.4,t:0,r:0.01,f:440,}],\r\n/*60*/  null,null,null,null,null,\r\n/*65*/  null,null,null,null,null,\r\n/*70*/  null,null,null,null,null,\r\n/*75*/  null,null,null,null,null,\r\n/*80*/  [{w:\"sine\",f:1720,v:0.3,d:0.02,t:0,r:0.02,},{w:\"square\",g:1,t:0,f:2876,v:6,d:0.2,s:1,r:0.2,}],\r\n        [{w:\"sine\",f:1720,v:0.3,d:0.25,t:0,r:0.25,},{w:\"square\",g:1,t:0,f:2876,v:6,d:0.2,s:1,r:0.2,}],\r\n    ],\r\n    drummap0:[\r\n/*35*/[{w:\"triangle\",t:0,f:110,v:1,d:0.05,h:0.02,p:0.1,}],\r\n      [{w:\"triangle\",t:0,f:150,v:0.8,d:0.1,p:0.1,h:0.02,r:0.01,}],\r\n      [{w:\"n0\",f:392,v:0.5,d:0.01,p:0,t:0,r:0.05}],\r\n      [{w:\"n0\",f:33,d:0.05,t:0,}],\r\n      [{w:\"n0\",f:100,v:0.7,d:0.03,t:0,r:0.03,h:0.02,}],\r\n/*40*/[{w:\"n0\",f:44,v:0.7,d:0.02,p:0.1,t:0,h:0.02,}],\r\n      [{w:\"triangle\",f:240,v:0.9,d:0.1,h:0.02,p:0.1,t:0,}],\r\n      [{w:\"n0\",f:440,v:0.2,r:0.01,t:0,}],\r\n      [{w:\"triangle\",f:270,v:0.9,d:0.1,h:0.02,p:0.1,t:0,}],\r\n      [{w:\"n0\",f:440,v:0.2,d:0.04,r:0.04,t:0,}],\r\n/*45*/[{w:\"triangle\",f:300,v:0.9,d:0.1,h:0.02,p:0.1,t:0,}],\r\n      [{w:\"n0\",f:440,v:0.2,d:0.1,r:0.1,h:0.02,t:0,}],\r\n      [{w:\"triangle\",f:320,v:0.9,d:0.1,h:0.02,p:0.1,t:0,}],\r\n      [{w:\"triangle\",f:360,v:0.9,d:0.1,h:0.02,p:0.1,t:0,}],\r\n      [{w:\"n0\",f:150,v:0.2,d:0.1,r:0.1,h:0.05,t:0,p:0.1,}],\r\n/*50*/[{w:\"triangle\",f:400,v:0.9,d:0.1,h:0.02,p:0.1,t:0,}],\r\n      [{w:\"n0\",f:150,v:0.2,d:0.1,r:0.01,h:0.05,t:0,p:0.1}],\r\n      [{w:\"n0\",f:150,v:0.2,d:0.1,r:0.01,h:0.05,t:0,p:0.1}],\r\n      [{w:\"n0\",f:440,v:0.3,d:0.1,p:0.9,t:0,r:0.1,}],\r\n      [{w:\"n0\",f:200,v:0.2,d:0.05,p:0.9,t:0,}],\r\n/*55*/[{w:\"n0\",f:440,v:0.3,d:0.12,p:0.9,t:0,}],\r\n      [{w:\"sine\",f:800,v:0.4,d:0.06,t:0,}],\r\n      [{w:\"n0\",f:150,v:0.2,d:0.1,r:0.01,h:0.05,t:0,p:0.1}],\r\n      [{w:\"n0\",f:33,v:0.3,d:0.2,p:0.9,t:0,}],\r\n      [{w:\"n0\",f:300,v:0.3,d:0.14,p:0.9,t:0,}],\r\n/*60*/[{w:\"sine\",f:200,d:0.06,t:0,}],\r\n      [{w:\"sine\",f:150,d:0.06,t:0,}],\r\n      [{w:\"sine\",f:300,t:0,}],\r\n      [{w:\"sine\",f:300,d:0.06,t:0,}],\r\n      [{w:\"sine\",f:250,d:0.06,t:0,}],\r\n/*65*/[{w:\"square\",f:300,v:.3,d:.06,p:.8,t:0,}],\r\n      [{w:\"square\",f:260,v:.3,d:.06,p:.8,t:0,}],\r\n      [{w:\"sine\",f:850,v:.5,d:.07,t:0,}],\r\n      [{w:\"sine\",f:790,v:.5,d:.07,t:0,}],\r\n      [{w:\"n0\",f:440,v:0.3,a:0.05,t:0,}],\r\n/*70*/[{w:\"n0\",f:440,v:0.3,a:0.05,t:0,}],\r\n      [{w:\"triangle\",f:1800,v:0.4,p:0.9,t:0,h:0.03,}],\r\n      [{w:\"triangle\",f:1800,v:0.3,p:0.9,t:0,h:0.13,}],\r\n      [{w:\"n0\",f:330,v:0.3,a:0.02,t:0,r:0.01,}],\r\n      [{w:\"n0\",f:330,v:0.3,a:0.02,t:0,h:0.04,r:0.01,}],\r\n/*75*/[{w:\"n0\",f:440,v:0.3,t:0,}],\r\n      [{w:\"sine\",f:800,t:0,}],\r\n      [{w:\"sine\",f:700,t:0,}],\r\n      [{w:\"n0\",f:330,v:0.3,t:0,}],\r\n      [{w:\"n0\",f:330,v:0.3,t:0,h:0.1,r:0.01,p:0.7,}],\r\n/*80*/[{w:\"sine\",t:0,f:1200,v:0.3,r:0.01,}],\r\n      [{w:\"sine\",t:0,f:1200,v:0.3,d:0.2,r:0.2,}],\r\n\r\n    ],\r\n    /**/\r\n    ready:function(){\r\n      var i;\r\n      this.pg=[]; this.vol=[]; this.ex=[]; this.bend=[]; this.rpnidx=[]; this.brange=[];\r\n      this.sustain=[]; this.notetab=[]; this.rhythm=[];\r\n      this.maxTick=0, this.playTick=0, this.playing=0; this.releaseRatio=3.5;\r\n      for(var i=0;i<16;++i){\r\n        this.pg[i]=0; this.vol[i]=3*100*100/(127*127);\r\n        this.bend[i]=0; this.brange[i]=0x100;\r\n        this.rhythm[i]=0;\r\n      }\r\n      this.rhythm[9]=1;\r\n      /**/\r\n      this.preroll=0.2;\r\n      this.relcnt=0;\r\n      setInterval(\r\n        function(){\r\n          if(++this.relcnt>=3){\r\n            this.relcnt=0;\r\n            for(var i=this.notetab.length-1;i>=0;--i){\r\n              var nt=this.notetab[i];\r\n              if(this.actx.currentTime>nt.e){\r\n                this._pruneNote(nt);\r\n                this.notetab.splice(i,1);\r\n              }\r\n            }\r\n            /**/\r\n          }\r\n          if(this.playing && this.song.ev.length>0){\r\n            var e=this.song.ev[this.playIndex];\r\n            while(this.actx.currentTime+this.preroll>this.playTime){\r\n              if(e.m[0]==0xff51){\r\n                this.song.tempo=e.m[1];\r\n                this.tick2Time=4*60/this.song.tempo/this.song.timebase;\r\n              }\r\n              else\r\n                this.send(e.m,this.playTime);\r\n              ++this.playIndex;\r\n              if(this.playIndex>=this.song.ev.length){\r\n                if(this.loop){\r\n                  e=this.song.ev[this.playIndex=0];\r\n                  this.playTick=e.t;\r\n                }\r\n                else{\r\n                  this.playTick=this.maxTick;\r\n                  this.playing=0;\r\n                  break;\r\n                }\r\n              }\r\n              else{\r\n                e=this.song.ev[this.playIndex];\r\n                this.playTime+=(e.t-this.playTick)*this.tick2Time;\r\n                this.playTick=e.t;\r\n              }\r\n            }\r\n          }\r\n        }.bind(this),60\r\n      );\r\n      //if(this.internalcontext){\r\n      //  window.AudioContext = window.AudioContext || window.webkitAudioContext;\r\n      //  this.setAudioContext(new AudioContext());\r\n      //}\r\n      this.isReady=1;\r\n    },\r\n    setMasterVol:function(v){\r\n      if(v!=undefined)\r\n        this.masterVol=v;\r\n      if(this.out)\r\n        this.out.gain.value=this.masterVol;\r\n    },\r\n    setReverbLev:function(v){\r\n      if(v!=undefined)\r\n        this.reverbLev=v;\r\n      var r=parseFloat(this.reverbLev);\r\n      if(this.rev&&!isNaN(r))\r\n        this.rev.gain.value=r*8;\r\n    },\r\n    setLoop:function(f){\r\n      this.loop=f;\r\n    },\r\n    setVoices:function(v){\r\n      this.voices=v;\r\n    },\r\n    reset:function(){\r\n      for(var i=0;i<16;++i){\r\n        this.setProgram(i,0);\r\n        this.setBendRange(i,0x100);\r\n        this.setModulation(i,0);\r\n        this.setChVol(i,100);\r\n        this.setPan(i,64);\r\n        this.resetAllControllers(i);\r\n        this.allSoundOff(i);\r\n        this.rhythm[i]=0;\r\n      }\r\n      this.rhythm[9]=1;\r\n    },\r\n    setQuality:function(q){\r\n      var i,k,n,p;\r\n      if(q!=undefined)\r\n        this.quality=q;\r\n      for(i=0;i<128;++i)\r\n        this.setTimbre(0,i,this.program0[i]);\r\n      for(i=0;i<this.drummap0.length;++i)\r\n        this.setTimbre(1,i+35,this.drummap0[i]);\r\n      if(this.quality){\r\n        for(i=0;i<this.program1.length;++i)\r\n          this.setTimbre(0,i,this.program1[i]);\r\n        for(i=0;i<this.drummap.length;++i){\r\n          if(this.drummap1[i])\r\n            this.setTimbre(1,i+35,this.drummap1[i]);\r\n        }\r\n      }\r\n    },\r\n    setTimbre:function(m,n,p){\r\n      var defp={g:0,w:\"sine\",t:1,f:0,v:0.5,a:0,h:0.01,d:0.01,s:0,r:0.05,p:1,q:1,k:0};\r\n      function filldef(p){\r\n        for(n=0;n<p.length;++n){\r\n          for(k in defp){\r\n            if(!p[n].hasOwnProperty(k) || typeof(p[n][k])==\"undefined\")\r\n              p[n][k]=defp[k];\r\n          }\r\n        }\r\n        return p;\r\n      }\r\n      if(m && n>=35 && n<=81)\r\n        this.drummap[n-35] = filldef(p);\r\n      if(m==0 && n>=0 && n<=127)\r\n        this.program[n] = filldef(p);\r\n    },\r\n    _pruneNote:function(nt){\r\n      for(var k=nt.o.length-1;k>=0;--k){\r\n        if(nt.o[k].frequency){\r\n          nt.o[k].frequency.cancelScheduledValues(0);\r\n        }\r\n        else{\r\n          nt.o[k].playbackRate.cancelScheduledValues(0);\r\n        }\r\n        nt.g[k].gain.cancelScheduledValues(0);\r\n\r\n        nt.o[k].stop();\r\n        if(nt.o[k].detune) {\r\n          try {\r\n            this.chmod[nt.ch].disconnect(nt.o[k].detune);\r\n          } catch (c) {}\r\n        }\r\n        nt.g[k].gain.value = 0;\r\n      }\r\n    },\r\n    _limitVoices:function(ch,n){\r\n      this.notetab.sort(function(n1,n2){\r\n        if(n1.f!=n2.f) return n1.f-n2.f;\r\n        if(n1.e!=n2.e) return n2.e-n1.e;\r\n        return n2.t-n1.t;\r\n      });\r\n      for(var i=this.notetab.length-1;i>=0;--i){\r\n        var nt=this.notetab[i];\r\n        if(this.actx.currentTime>nt.e || i>=(this.voices-1)){\r\n          this._pruneNote(nt);\r\n          this.notetab.splice(i,1);\r\n        }\r\n      }\r\n    },\r\n    _note:function(t,ch,n,v,p){\r\n      var out,sc,pn;\r\n      var o=[],g=[],vp=[],fp=[],r=[];\r\n      var f=440*Math.pow(2,(n-69)/12);\r\n      this._limitVoices(ch,n);\r\n      for(var i=0;i<p.length;++i){\r\n        pn=p[i];\r\n        var dt=t+pn.a+pn.h;\r\n        if(pn.g==0)\r\n          out=this.chvol[ch], sc=v*v/16384, fp[i]=f*pn.t+pn.f;\r\n        else if(pn.g>10)\r\n          out=g[pn.g-11].gain, sc=1, fp[i]=fp[pn.g-11]*pn.t+pn.f;\r\n        else if(o[pn.g-1].frequency)\r\n          out=o[pn.g-1].frequency, sc=fp[pn.g-1], fp[i]=fp[pn.g-1]*pn.t+pn.f;\r\n        else\r\n          out=o[pn.g-1].playbackRate, sc=fp[pn.g-1]/440, fp[i]=fp[pn.g-1]*pn.t+pn.f;\r\n        switch(pn.w[0]){\r\n        case \"n\":\r\n          o[i]=this.actx.createBufferSource();\r\n          o[i].buffer=this.noiseBuf[pn.w];\r\n          o[i].loop=true;\r\n          o[i].playbackRate.value=fp[i]/440;\r\n          if(pn.p!=1)\r\n            this._setParamTarget(o[i].playbackRate,fp[i]/440*pn.p,t,pn.q);\r\n          this.chmod[ch].connect(o[i].detune);\r\n          o[i].detune.value=this.bend[ch];\r\n          break;\r\n        default:\r\n          o[i]=this.actx.createOscillator();\r\n          o[i].frequency.value=fp[i];\r\n          if(pn.p!=1)\r\n            this._setParamTarget(o[i].frequency,fp[i]*pn.p,t,pn.q);\r\n          if(pn.w[0]==\"w\")\r\n            o[i].setPeriodicWave(this.wave[pn.w]);\r\n          else\r\n            o[i].type=pn.w;\r\n          this.chmod[ch].connect(o[i].detune);\r\n          o[i].detune.value=this.bend[ch];\r\n          break;\r\n        }\r\n        g[i]=this.actx.createGain();\r\n        r[i]=pn.r;\r\n        o[i].connect(g[i]); g[i].connect(out);\r\n        vp[i]=sc*pn.v;\r\n        if(pn.k)\r\n          vp[i]*=Math.pow(2,(n-60)/12*pn.k);\r\n        if(pn.a){\r\n          g[i].gain.value=0;\r\n          g[i].gain.setValueAtTime(0,t);\r\n          g[i].gain.linearRampToValueAtTime(vp[i],t+pn.a);\r\n        }\r\n        else\r\n          g[i].gain.setValueAtTime(vp[i],t);\r\n        this._setParamTarget(g[i].gain,pn.s*vp[i],dt,pn.d);\r\n        o[i].start(t);\r\n        if(this.rhythm[ch]){\r\n          // difference between '()=>' and 'function()': need to pack parameters\r\n          o[i].onended = function(a, b) { return function() { a.disconnect(b); }; }(this.chmod[ch], o[i].detune);\r\n          o[i].stop(t+p[0].d*this.releaseRatio);\r\n        }\r\n      }\r\n      if(!this.rhythm[ch])\r\n        this.notetab.push({t:t,e:99999,ch:ch,n:n,o:o,g:g,t2:t+pn.a,v:vp,r:r,f:0});\r\n    },\r\n    _setParamTarget:function(p,v,t,d){\r\n      if(d!=0)\r\n        p.setTargetAtTime(v,t,d);\r\n      else\r\n        p.setValueAtTime(v,t);\r\n    },\r\n    _releaseNote:function(nt,t){\r\n      if(nt.ch!=9){\r\n        for(var k=nt.g.length-1;k>=0;--k){\r\n          nt.g[k].gain.cancelScheduledValues(t);\r\n          if(t==nt.t2)\r\n            nt.g[k].gain.setValueAtTime(nt.v[k],t);\r\n          else if(t<nt.t2)\r\n            nt.g[k].gain.setValueAtTime(nt.v[k]*(t-nt.t)/(nt.t2-nt.t),t);\r\n          this._setParamTarget(nt.g[k].gain,0,t,nt.r[k]);\r\n        }\r\n      }\r\n      nt.e=t+nt.r[0]*this.releaseRatio;\r\n      nt.f=1;\r\n    },\r\n    setModulation:function(ch,v,t){\r\n      this.chmod[ch].gain.setValueAtTime(v*100/127,this._tsConv(t));\r\n    },\r\n    setChVol:function(ch,v,t){\r\n      this.vol[ch]=3*v*v/(127*127);\r\n      this.chvol[ch].gain.setValueAtTime(this.vol[ch]*this.ex[ch],this._tsConv(t));\r\n    },\r\n    setPan:function(ch,v,t){\r\n      if(this.chpan[ch])\r\n        this.chpan[ch].pan.setValueAtTime((v-64)/64,this._tsConv(t));\r\n    },\r\n    setExpression:function(ch,v,t){\r\n      this.ex[ch]=v*v/(127*127);\r\n      this.chvol[ch].gain.setValueAtTime(this.vol[ch]*this.ex[ch],this._tsConv(t));\r\n    },\r\n    setSustain:function(ch,v,t){\r\n      this.sustain[ch]=v;\r\n      t=this._tsConv(t);\r\n      if(v<64){\r\n        for(var i=this.notetab.length-1;i>=0;--i){\r\n          var nt=this.notetab[i];\r\n          if(t>=nt.t && nt.ch==ch && nt.f==1)\r\n            this._releaseNote(nt,t);\r\n        }\r\n      }\r\n    },\r\n    allSoundOff:function(ch){\r\n      for(var i=this.notetab.length-1;i>=0;--i){\r\n        var nt=this.notetab[i];\r\n        if(nt.ch==ch){\r\n          this._pruneNote(nt);\r\n          this.notetab.splice(i,1);\r\n        }\r\n      }\r\n    },\r\n    resetAllControllers:function(ch){\r\n      this.bend[ch]=0; this.ex[ch]=1.0;\r\n      this.rpnidx[ch]=0x3fff; this.sustain[ch]=0;\r\n      if(this.chvol[ch]){\r\n        this.chvol[ch].gain.value=this.vol[ch]*this.ex[ch];\r\n        this.chmod[ch].gain.value=0;\r\n      }\r\n    },\r\n    setBendRange:function(ch,v){\r\n      this.brange[ch]=v;\r\n    },\r\n    setProgram:function(ch,v){\r\n      if(this.debug)\r\n        console.log(\"Pg(\"+ch+\")=\"+v);\r\n      this.pg[ch]=v;\r\n    },\r\n    setBend:function(ch,v,t){\r\n      t=this._tsConv(t);\r\n      var br=this.brange[ch]*100/127;\r\n      this.bend[ch]=(v-8192)*br/8192;\r\n      for(var i=this.notetab.length-1;i>=0;--i){\r\n        var nt=this.notetab[i];\r\n        if(nt.ch==ch){\r\n          for(var k=nt.o.length-1;k>=0;--k){\r\n            if(nt.o[k].frequency)\r\n              nt.o[k].detune.setValueAtTime(this.bend[ch],t);\r\n          }\r\n        }\r\n      }\r\n    },\r\n    noteOn:function(ch,n,v,t){\r\n      if(v==0){\r\n        this.noteOff(ch,n,t);\r\n        return;\r\n      }\r\n      t=this._tsConv(t);\r\n      if(this.rhythm[ch]){\r\n        if(n>=35&&n<=81)\r\n          this._note(t,ch,n,v,this.drummap[n-35]);\r\n        return;\r\n      }\r\n      this._note(t,ch,n,v,this.program[this.pg[ch]]);\r\n    },\r\n    noteOff:function(ch,n,t){\r\n      if(this.rhythm[ch])\r\n        return;\r\n      t=this._tsConv(t);\r\n      for(var i=this.notetab.length-1;i>=0;--i){\r\n        var nt=this.notetab[i];\r\n        if(t>=nt.t && nt.ch==ch && nt.n==n && nt.f==0){\r\n          nt.f=1;\r\n          if(this.sustain[ch]<64)\r\n            this._releaseNote(nt,t);\r\n        }\r\n      }\r\n    },\r\n    _tsConv:function(t){\r\n      if(t==undefined||t<=0){\r\n        t=0;\r\n        if(this.actx)\r\n          t=this.actx.currentTime;\r\n      }\r\n      else{\r\n        if(this.tsmode)\r\n          t=t*.001-this.tsdiff;\r\n      }\r\n      return t;\r\n    },\r\n    setTsMode:function(tsmode){\r\n      this.tsmode=tsmode;\r\n    },\r\n    send:function(msg,t){    /* send midi message */\r\n      var ch=msg[0]&0xf;\r\n      var cmd=msg[0]&~0xf;\r\n      if(cmd<0x80||cmd>=0x100)\r\n        return;\r\n      if(this.audioContext.state==\"suspended\"){\r\n        this.audioContext.resume();\r\n      }\r\n      switch(cmd){\r\n      case 0xb0:  /* ctl change */\r\n        switch(msg[1]){\r\n        case 1:  this.setModulation(ch,msg[2],t); break;\r\n        case 7:  this.setChVol(ch,msg[2],t); break;\r\n        case 10: this.setPan(ch,msg[2],t); break;\r\n        case 11: this.setExpression(ch,msg[2],t); break;\r\n        case 64: this.setSustain(ch,msg[2],t); break;\r\n        case 98:  case 98: this.rpnidx[ch]=0x3fff; break; /* nrpn lsb/msb */\r\n        case 100: this.rpnidx[ch]=(this.rpnidx[ch]&0x380)|msg[2]; break; /* rpn lsb */\r\n        case 101: this.rpnidx[ch]=(this.rpnidx[ch]&0x7f)|(msg[2]<<7); break; /* rpn msb */\r\n        case 6:  /* data entry msb */\r\n          if(this.rpnidx[ch]==0)\r\n            this.brange[ch]=(msg[2]<<7)+(this.brange[ch]&0x7f);\r\n          break;\r\n        case 38:  /* data entry lsb */\r\n          if(this.rpnidx[ch]==0)\r\n            this.brange[ch]=(this.brange[ch]&0x380)|msg[2];\r\n          break;\r\n        case 120:  /* all sound off */\r\n        case 123:  /* all notes off */\r\n        case 124: case 125: case 126: case 127: /* omni off/on mono/poly */\r\n          this.allSoundOff(ch);\r\n          break;\r\n        case 121: this.resetAllControllers(ch); break;\r\n        }\r\n        break;\r\n      case 0xc0: this.setProgram(ch,msg[1]); break;\r\n      case 0xe0: this.setBend(ch,(msg[1]+(msg[2]<<7)),t); break;\r\n      case 0x90: this.noteOn(ch,msg[1],msg[2],t); break;\r\n      case 0x80: this.noteOff(ch,msg[1],t); break;\r\n      case 0xf0:\r\n        if (msg[0] == 0xff) {\r\n          this.reset();\r\n          break;\r\n        }\r\n        if(msg[0]!=254 && this.debug){\r\n          var ds=[];\r\n          for(var ii=0;ii<msg.length;++ii)\r\n            ds.push(msg[ii].toString(16));\r\n        }\r\n        if(msg[1]==0x41&&msg[2]==0x10&&msg[3]==0x42&&msg[4]==0x12&&msg[5]==0x40){\r\n          if((msg[6]&0xf0)==0x10&&msg[7]==0x15){\r\n            var ch=[9,0,1,2,3,4,5,6,7,8,10,11,12,13,14,15][msg[6]&0xf];\r\n            this.rhythm[ch]=msg[8];\r\n          }\r\n        }\r\n        break;\r\n      }\r\n    },\r\n    _createWave:function(w){\r\n      var imag=new Float32Array(w.length);\r\n      var real=new Float32Array(w.length);\r\n      for(var i=1;i<w.length;++i)\r\n        imag[i]=w[i];\r\n      return this.actx.createPeriodicWave(real,imag);\r\n    },\r\n    getAudioContext:function(){\r\n      return this.actx;\r\n    },\r\n    setAudioContext:function(actx,dest){\r\n      this.audioContext=this.actx=actx;\r\n      this.dest=dest;\r\n      if(!dest)\r\n        this.dest=actx.destination;\r\n      this.tsdiff=performance.now()*.001-this.actx.currentTime;\r\n      this.out=this.actx.createGain();\r\n      this.comp=this.actx.createDynamicsCompressor();\r\n      var blen=this.actx.sampleRate*.5|0;\r\n      this.convBuf=this.actx.createBuffer(2,blen,this.actx.sampleRate);\r\n      this.noiseBuf={};\r\n      this.noiseBuf.n0=this.actx.createBuffer(1,blen,this.actx.sampleRate);\r\n      this.noiseBuf.n1=this.actx.createBuffer(1,blen,this.actx.sampleRate);\r\n      var d1=this.convBuf.getChannelData(0);\r\n      var d2=this.convBuf.getChannelData(1);\r\n      var dn=this.noiseBuf.n0.getChannelData(0);\r\n      var dr=this.noiseBuf.n1.getChannelData(0);\r\n      for(var i=0;i<blen;++i){\r\n        if(i/blen<Math.random()){\r\n          d1[i]=Math.exp(-3*i/blen)*(Math.random()-.5)*.5;\r\n          d2[i]=Math.exp(-3*i/blen)*(Math.random()-.5)*.5;\r\n        }\r\n        dn[i]=Math.random()*2-1;\r\n      }\r\n      for(var jj=0;jj<64;++jj){\r\n        var r1=Math.random()*10+1;\r\n        var r2=Math.random()*10+1;\r\n        for(i=0;i<blen;++i){\r\n          var dd=Math.sin((i/blen)*2*Math.PI*440*r1)*Math.sin((i/blen)*2*Math.PI*440*r2);\r\n          dr[i]+=dd/8;\r\n        }\r\n      }\r\n      if(this.useReverb){\r\n        this.conv=this.actx.createConvolver();\r\n        this.conv.buffer=this.convBuf;\r\n        this.rev=this.actx.createGain();\r\n        this.rev.gain.value=this.reverbLev;\r\n        this.out.connect(this.conv);\r\n        this.conv.connect(this.rev);\r\n        this.rev.connect(this.comp);\r\n      }\r\n      this.setMasterVol();\r\n      this.out.connect(this.comp);\r\n      this.comp.connect(this.dest);\r\n      this.chvol=[]; this.chmod=[]; this.chpan=[];\r\n      this.wave={\"w9999\":this._createWave(\"w9999\")};\r\n      this.lfo=this.actx.createOscillator();\r\n      this.lfo.frequency.value=5;\r\n      this.lfo.start(0);\r\n      for(i=0;i<16;++i){\r\n        this.chvol[i]=this.actx.createGain();\r\n        if(this.actx.createStereoPanner){\r\n          this.chpan[i]=this.actx.createStereoPanner();\r\n          this.chvol[i].connect(this.chpan[i]);\r\n          this.chpan[i].connect(this.out);\r\n        }\r\n        else{\r\n          this.chpan[i]=null;\r\n          this.chvol[i].connect(this.out);\r\n        }\r\n        this.chmod[i]=this.actx.createGain();\r\n        this.lfo.connect(this.chmod[i]);\r\n        this.pg[i]=0;\r\n        this.resetAllControllers(i);\r\n      }\r\n      this.setReverbLev();\r\n      this.reset();\r\n      this.send([0x90,60,1]);\r\n      this.send([0x90,60,0]);\r\n    },\r\n  }\r\n/* webaudio-tinysynth coreobject */\r\n\r\n;\r\n  for(var k in this.sy.properties)\r\n    this[k]=this.sy.properties[k].value;\r\n  this.setQuality(1);\r\n  if(opt){\r\n    if(opt.useReverb!=undefined)\r\n      this.useReverb=opt.useReverb;\r\n    if(opt.quality!=undefined)\r\n      this.setQuality(opt.quality);\r\n    if(opt.voices!=undefined)\r\n      this.setVoices(opt.voices);\r\n  }\r\n  this.ready();\r\n}\r\n\r\n  var _ac = JZZ.lib.getAudioContext();\r\n\r\n  var _synth = {};\r\n  var _noname = [];\r\n  var _engine = {};\r\n\r\n  _engine._info = function(name) {\r\n    if (!name) name = 'JZZ.synth.Tiny';\r\n    return {\r\n      type: 'Web Audo',\r\n      name: name,\r\n      manufacturer: 'virtual',\r\n      version: _version\r\n    };\r\n  };\r\n\r\n  _engine._openOut = function(port, name) {\r\n    if (!_ac) { port._crash('AudioContext not supported'); return; }\r\n    var synth;\r\n    if (typeof name !== 'undefined') {\r\n      name = '' + name;\r\n      if (!_synth[name]) _synth[name] = new WebAudioTinySynth();\r\n      synth = _synth[name];\r\n    }\r\n    else {\r\n      synth = new WebAudioTinySynth();\r\n      _noname.push(synth);\r\n    }\r\n    synth.setAudioContext(_ac);\r\n    port.plug = function(dest) {\r\n      if (dest && (dest.context instanceof AudioContext || dest.context instanceof webkitAudioContext)) {\r\n        synth.setAudioContext(dest.context, dest);\r\n      }\r\n    };\r\n    port._info = _engine._info(name);\r\n    port._receive = function(msg) { synth.send(msg); };\r\n    port._resume();\r\n  };\r\n\r\n  JZZ.synth.Tiny = function(name) {\r\n    return JZZ.lib.openMidiOut(name, _engine);\r\n  };\r\n\r\n  JZZ.synth.Tiny.register = function(name) {\r\n    return _ac ? JZZ.lib.registerMidiOut(name, _engine) : false;\r\n  };\r\n\r\n  JZZ.synth.Tiny.version = function() { return _version; };\r\n\r\n});","(function(global, factory) {\r\n  if (typeof exports === 'object' && typeof module !== 'undefined') {\r\n    module.exports = factory();\r\n  }\r\n  else if (typeof define === 'function' && define.amd) {\r\n    define('JZZ', [], factory);\r\n  }\r\n  else {\r\n    if (!global) global = window;\r\n    if (global.JZZ && global.JZZ.MIDI) return;\r\n    global.JZZ = factory();\r\n  }\r\n})(this, function() {\r\n\r\n  var _scope = typeof window === 'undefined' ? global : window;\r\n  var _version = '1.0.1';\r\n  var i, j, k, m, n;\r\n\r\n  var _time = Date.now || function () { return new Date().getTime(); };\r\n  var _startTime = _time();\r\n  var _now = typeof performance != 'undefined' && performance.now ?\r\n    function() { return performance.now(); } : function() { return _time() - _startTime; };\r\n  var _schedule = function(f) {\r\n    setTimeout(f, 0);\r\n  };\r\n\r\n  // _R: common root for all async objects\r\n  function _R() {\r\n    this._orig = this;\r\n    this._ready = false;\r\n    this._queue = [];\r\n    this._log = [];\r\n  }\r\n  _R.prototype._exec = function() {\r\n    while (this._ready && this._queue.length) {\r\n      var x = this._queue.shift();\r\n      x[0].apply(this, x[1]);\r\n    }\r\n  };\r\n  _R.prototype._push = function(func, arg) { this._queue.push([func, arg]); _R.prototype._exec.apply(this); };\r\n  _R.prototype._slip = function(func, arg) { this._queue.unshift([func, arg]); };\r\n  _R.prototype._pause = function() { this._ready = false; };\r\n  _R.prototype._resume = function() { this._ready = true; _R.prototype._exec.apply(this); };\r\n  _R.prototype._break = function(err) { this._orig._bad = true; this._orig._log.push(err || 'Unknown JZZ error'); };\r\n  _R.prototype._repair = function() { this._orig._bad = false; };\r\n  _R.prototype._crash = function(err) { this._break(err); this._resume(); };\r\n  _R.prototype._err = function() { return this._log[this._log.length - 1]; };\r\n  _R.prototype.log = function() { return _clone(this._log); };\r\n  _R.prototype._image = function() {\r\n    var F = function() {}; F.prototype = this._orig;\r\n    var ret = new F();\r\n    ret._ready = false;\r\n    ret._queue = [];\r\n    return ret;\r\n  };\r\n  _R.prototype._thenable = function() {\r\n    var self = this;\r\n    var F = function() {}; F.prototype = self;\r\n    var ret = new F();\r\n    ret.then = function(good, bad) { self._push(_then, [good, bad]); return this; };      \r\n    return ret;\r\n  };\r\n  function _then(good, bad) {\r\n    if (this._bad) {\r\n      if (bad instanceof Function) bad.apply(this, [new Error(this._err())]);\r\n    }\r\n    else {\r\n      if (good instanceof Function) good.apply(this, [this]);\r\n    }\r\n  }\r\n  function _wait(obj, delay) {\r\n    if (this._bad) obj._crash(this._err());\r\n    else setTimeout(function() { obj._resume(); }, delay);\r\n  }\r\n  _R.prototype.wait = function(delay) {\r\n    if (!delay) return this;\r\n    var ret = this._image();\r\n    this._push(_wait, [ret, delay]);\r\n    return ret._thenable();\r\n  };\r\n  function _kick(obj) { if (this._bad) obj._break(this._err()); obj._resume(); }\r\n  function _rechain(self, obj, name) {\r\n    self[name] = function() {\r\n      var arg = arguments;\r\n      var ret = obj._image();\r\n      this._push(_kick, [ret]);\r\n      return ret[name].apply(ret, arg);\r\n    };\r\n  }\r\n  function _and(q) {\r\n    if (!this._bad) {\r\n      if (q instanceof Function) q.apply(this); else console.log(q);\r\n    }\r\n  }\r\n  _R.prototype.and = function(func) { this._push(_and, [func]); return this._thenable(); };\r\n  function _or(q) {\r\n    if (this._bad) {\r\n      if (q instanceof Function) q.apply(this); else console.log(q);\r\n    }\r\n  }\r\n  _R.prototype.or = function(func) { this._push(_or, [func]); return this._thenable(); };\r\n\r\n  _R.prototype._info = {};\r\n  _R.prototype.info = function() {\r\n    var info = _clone(this._orig._info);\r\n    if (typeof info.engine == 'undefined') info.engine = 'none';\r\n    if (typeof info.sysex == 'undefined') info.sysex = true;\r\n    return info;\r\n  };\r\n  _R.prototype.name = function() { return this.info().name; };\r\n\r\n  function _close(obj) {\r\n    if (this._bad) obj._crash(this._err());\r\n    else {\r\n      this._break('Closed');\r\n      obj._resume();\r\n    }\r\n  }\r\n  _R.prototype.close = function() {\r\n    var ret = new _R();\r\n    if (this._close) this._push(this._close, []);\r\n    this._push(_close, [ret]);\r\n    return ret._thenable();\r\n  };\r\n\r\n  function _tryAny(arr) {\r\n    if (!arr.length) {\r\n      this._break();\r\n      return;\r\n    }\r\n    var func = arr.shift();\r\n    if (arr.length) {\r\n      var self = this;\r\n      this._slip(_or, [ function() { _tryAny.apply(self, [arr]); } ]);\r\n    }\r\n    try {\r\n      this._repair();\r\n      func.apply(this);\r\n    }\r\n    catch (err) {\r\n      this._break(err.toString());\r\n    }\r\n  }\r\n\r\n  function _push(arr, obj) {\r\n    for (var i = 0; i < arr.length; i++) if (arr[i] === obj) return;\r\n    arr.push(obj);\r\n  }\r\n  function _pop(arr, obj) {\r\n    for (var i = 0; i < arr.length; i++) if (arr[i] === obj) {\r\n      arr.splice(i, 1);\r\n      return;\r\n    }\r\n  }\r\n\r\n  // _J: JZZ object\r\n  function _J() {\r\n    _R.apply(this);\r\n  }\r\n  _J.prototype = new _R();\r\n\r\n  function _clone(obj, key, val) {\r\n    if (typeof key == 'undefined') return _clone(obj, [], []);\r\n    if (obj instanceof Object) {\r\n      for (var i = 0; i < key.length; i++) if (key[i] === obj) return val[i];\r\n      var ret;\r\n      if (obj instanceof Array) ret = []; else ret = {};\r\n      key.push(obj); val.push(ret);\r\n      for(var k in obj) if (obj.hasOwnProperty(k)) ret[k] = _clone(obj[k], key, val);\r\n      return ret;\r\n    }\r\n    return obj;\r\n  }\r\n  _J.prototype._info = { name: 'JZZ.js', ver: _version, version: _version, inputs: [], outputs: [] };\r\n\r\n  var _outs = [];\r\n  var _ins = [];\r\n  var _outsW = [];\r\n  var _insW = [];\r\n\r\n  function _postRefresh() {\r\n    _jzz._info.engine = _engine._type;\r\n    _jzz._info.version = _engine._version;\r\n    _jzz._info.sysex = _engine._sysex;\r\n    _jzz._info.inputs = [];\r\n    _jzz._info.outputs = [];\r\n    _outs = [];\r\n    _ins = [];\r\n    _engine._allOuts = {};\r\n    _engine._allIns = {};\r\n    var i, x;\r\n    for (i = 0; i < _engine._outs.length; i++) {\r\n      x = _engine._outs[i];\r\n      x.engine = _engine;\r\n      _engine._allOuts[x.name] = x;\r\n      _jzz._info.outputs.push({\r\n        id: x.name,\r\n        name: x.name,\r\n        manufacturer: x.manufacturer,\r\n        version: x.version,\r\n        engine: _engine._type\r\n      });\r\n      _outs.push(x);\r\n    }\r\n    for (i = 0; i < _virtual._outs.length; i++) {\r\n      x = _virtual._outs[i];\r\n      _jzz._info.outputs.push({\r\n        id: x.name,\r\n        name: x.name,\r\n        manufacturer: x.manufacturer,\r\n        version: x.version,\r\n        engine: x.type\r\n      });\r\n      _outs.push(x);\r\n    }\r\n    for (i = 0; i < _engine._ins.length; i++) {\r\n      x = _engine._ins[i];\r\n      x.engine = _engine;\r\n      _engine._allIns[x.name] = x;\r\n      _jzz._info.inputs.push({\r\n        id: x.name,\r\n        name: x.name,\r\n        manufacturer: x.manufacturer,\r\n        version: x.version,\r\n        engine: _engine._type\r\n      });\r\n      _ins.push(x);\r\n    }\r\n    for (i = 0; i < _virtual._ins.length; i++) {\r\n      x = _virtual._ins[i];\r\n      _jzz._info.inputs.push({\r\n        id: x.name,\r\n        name: x.name,\r\n        manufacturer: x.manufacturer,\r\n        version: x.version,\r\n        engine: x.type\r\n      });\r\n      _ins.push(x);\r\n    }\r\n    if (_jzz._watcher && _jzz._watcher._handles.length) {\r\n      var diff = _diff(_insW, _outsW, _jzz._info.inputs, _jzz._info.outputs);\r\n       if (diff) {\r\n        for (j = 0; j < diff.inputs.removed.length; j++) {\r\n          x = _engine._inMap[diff.inputs.removed[j].name];\r\n          if (x) x._closeAll();\r\n        }\r\n        for (j = 0; j < diff.outputs.removed.length; j++) {\r\n          x = _engine._outMap[diff.outputs.removed[j].name];\r\n          if (x) x._closeAll();\r\n        }\r\n        _fireW(diff);\r\n      }\r\n    }\r\n    _insW = _jzz._info.inputs;\r\n    _outsW = _jzz._info.outputs;\r\n  }\r\n  function _refresh() {\r\n    if (!this._bad) _engine._refresh(this);\r\n  }\r\n  _J.prototype.refresh = function() {\r\n    this._push(_refresh, []);\r\n    return this._thenable();\r\n  };\r\n\r\n  function _filterList(q, arr) {\r\n    var i, n;\r\n    if (q instanceof Function) q = q(arr);\r\n    if (!(q instanceof Array)) q = [q];\r\n    var before = [];\r\n    var after = [];\r\n    var etc = arr.slice();\r\n    var a = before;\r\n    for (i = 0; i < q.length; i++) {\r\n      if (typeof q[i] == 'undefined') a = after;\r\n      else if (q[i] instanceof RegExp) for (n = 0; n < etc.length; n++) {\r\n        if (q[i].test(etc[n].name)) {\r\n          a.push(etc[n]);\r\n          etc.splice(n, 1);\r\n          n--;\r\n        }\r\n      }\r\n      else {\r\n        for (n = 0; n < etc.length; n++) if (q[i] + '' === n + '' || q[i] === etc[n].name || (q[i] instanceof Object && q[i].name === etc[n].name)) {\r\n          a.push(etc[n]);\r\n          etc.splice(n, 1);\r\n          n--;\r\n        }\r\n      }\r\n    }\r\n    return a == before ? before : before.concat(etc).concat(after);\r\n  }\r\n\r\n  function _notFound(port, q) {\r\n    var msg;\r\n    if (q instanceof RegExp) msg = 'Port matching ' + q + ' not found';\r\n    else if (q instanceof Object || typeof q == 'undefined') msg = 'Port not found';\r\n    else msg = 'Port \"' + q + '\" not found';\r\n    port._crash(msg);\r\n  }\r\n  function _openMidiOut(port, arg) {\r\n    if (this._bad) port._crash(this._err());\r\n    else {\r\n      var arr = _filterList(arg, _outs);\r\n      if (!arr.length) { _notFound(port, arg); return; }\r\n      var pack = function(x) { return function() { x.engine._openOut(this, x.name); }; };\r\n      for (var i = 0; i < arr.length; i++) arr[i] = pack(arr[i]);\r\n      port._slip(_tryAny, [arr]);\r\n      port._resume();\r\n    }\r\n  }\r\n  _J.prototype.openMidiOut = function(arg) {\r\n    var port = new _M();\r\n    this._push(_refresh, []);\r\n    this._push(_openMidiOut, [port, arg]);\r\n    return port._thenable();\r\n  };\r\n  _J.prototype._openMidiOutNR = function(arg) {\r\n    var port = new _M();\r\n    this._push(_openMidiOut, [port, arg]);\r\n    return port._thenable();\r\n  };\r\n\r\n  function _openMidiIn(port, arg) {\r\n    if (this._bad) port._crash(this._err());\r\n    else {\r\n      var arr = _filterList(arg, _ins);\r\n      if (!arr.length) { _notFound(port, arg); return; }\r\n      var pack = function(x) { return function() { x.engine._openIn(this, x.name); }; };\r\n      for (var i = 0; i < arr.length; i++) arr[i] = pack(arr[i]);\r\n      port._slip(_tryAny, [arr]);\r\n      port._resume();\r\n    }\r\n  }\r\n  _J.prototype.openMidiIn = function(arg) {\r\n    var port = new _M();\r\n    this._push(_refresh, []);\r\n    this._push(_openMidiIn, [port, arg]);\r\n    return port._thenable();\r\n  };\r\n  _J.prototype._openMidiInNR = function(arg) {\r\n    var port = new _M();\r\n    this._push(_openMidiIn, [port, arg]);\r\n    return port._thenable();\r\n  };\r\n\r\n  function _onChange(watcher, arg) {\r\n    if (this._bad) watcher._crash();\r\n    else {\r\n      watcher._slip(_connectW, [arg]);\r\n      watcher._resume();\r\n    }\r\n  }\r\n  _J.prototype.onChange = function(arg) {\r\n    if (!this._orig._watcher) this._orig._watcher = new _W();\r\n    var watcher = this._orig._watcher._image();\r\n    this._push(_onChange, [watcher, arg]);\r\n    return watcher._thenable();\r\n  };\r\n\r\n  _J.prototype._close = function() {\r\n    _engine._close();\r\n  };\r\n\r\n  // _M: MIDI-In/Out object\r\n  function _M() {\r\n    _R.apply(this);\r\n    this._handles = [];\r\n    this._outs = [];\r\n  }\r\n  _M.prototype = new _R();\r\n  _M.prototype._filter = function(msg) {\r\n    if (this._orig._mpe) {\r\n      var out;\r\n      var outs = 0;\r\n      if (this._handles && this._handles.length) {\r\n        outs = this._handles.length;\r\n        out = this._handles[0];\r\n      }\r\n      if (this._outs && this._outs.length) {\r\n        outs = this._outs.length;\r\n        out = this._outs[0];\r\n      }\r\n      if (outs == 1 && !out._mpe) {\r\n        msg = this._orig._mpe.filter(msg);\r\n      }\r\n    }\r\n    return msg;\r\n  };\r\n  _M.prototype._receive = function(msg) { this._emit(this._filter(msg)); };\r\n  function _receive(msg) { if (!this._bad) this._receive(msg); }\r\n  _M.prototype.send = function() {\r\n    this._push(_receive, [MIDI.apply(null, arguments)]);\r\n    return this._thenable();\r\n  };\r\n  _M.prototype.note = function(c, n, v, t) {\r\n    this.noteOn(c, n, v);\r\n    if (t > 0) this.wait(t).noteOff(c, n);\r\n    return this._thenable();\r\n  };\r\n  _M.prototype._emit = function(msg) {\r\n    var i;\r\n    for (i = 0; i < this._handles.length; i++) this._handles[i].apply(this, [MIDI(msg)._stamp(this)]);\r\n    for (i = 0; i < this._outs.length; i++) {\r\n      var m = MIDI(msg);\r\n      if (!m._stamped(this._outs[i])) this._outs[i].send(m._stamp(this));\r\n    }\r\n  };\r\n  function _emit(msg) { this._emit(msg); }\r\n  _M.prototype.emit = function(msg) {\r\n    this._push(_emit, [msg]);\r\n    return this._thenable();\r\n  };\r\n  function _connect(arg) {\r\n    if (arg instanceof Function) _push(this._orig._handles, arg);\r\n    else _push(this._orig._outs, arg);\r\n  }\r\n  function _disconnect(arg) {\r\n    if (typeof arg == 'undefined') {\r\n      this._orig._handles = [];\r\n      this._orig._outs = [];\r\n    }\r\n    else if (arg instanceof Function) _pop(this._orig._handles, arg);\r\n    else _pop(this._orig._outs, arg);\r\n  }\r\n  _M.prototype.connect = function(arg) {\r\n    this._push(_connect, [arg]);\r\n    return this._thenable();\r\n  };\r\n  _M.prototype.disconnect = function(arg) {\r\n    this._push(_disconnect, [arg]);\r\n    return this._thenable();\r\n  };\r\n  _M.prototype.connected = function() {\r\n    return this._orig._handles.length + this._orig._outs.length;\r\n  };\r\n  _M.prototype.ch = function(n) {\r\n    if (typeof n == 'undefined') return this;\r\n    _validateChannel(n);\r\n    var chan = new _C(this, n);\r\n    this._push(_kick, [chan]);\r\n    return chan._thenable();\r\n  };\r\n  function _mpe(m, n) {\r\n    if (!this._orig._mpe) this._orig._mpe = new MPE();\r\n    this._orig._mpe.setup(m, n);\r\n  }\r\n  _M.prototype.mpe = function(m, n) {\r\n    if (typeof m == 'undefined' && typeof n == 'undefined') return this;\r\n    MPE.validate(m, n);\r\n    var chan = n ? new _E(this, m, n) : new _C(this, m);\r\n    this._push(_mpe, [m, n]);\r\n    this._push(_kick, [chan]);\r\n    return chan._thenable();\r\n  };\r\n  function _validateChannel(c) {\r\n    if (c != parseInt(c) || c < 0 || c > 15)\r\n      throw RangeError('Bad channel value (must not be less than 0 or more than 15): ' + c);\r\n  }\r\n\r\n  // _C: MIDI Channel object\r\n  function _C(port, chan) {\r\n    _M.apply(this);\r\n    this._port = port._orig;\r\n    this._chan = chan;\r\n    _rechain(this, this._port, 'ch');\r\n    _rechain(this, this._port, 'mpe');\r\n    _rechain(this, this._port, 'connect');\r\n    _rechain(this, this._port, 'disconnect');\r\n    _rechain(this, this._port, 'close');\r\n  }\r\n  _C.prototype = new _M();\r\n  _C.prototype.channel = function() { return this._chan; };\r\n  _C.prototype._receive = function(msg) { this._port._receive(msg); };\r\n  _C.prototype.note = function(n, v, t) {\r\n    this.noteOn(n, v);\r\n    if (t) this.wait(t).noteOff(n);\r\n    return this._thenable();\r\n  };\r\n\r\n  // _E: MPE Channel object\r\n  function _E(port, m, n) {\r\n    _M.apply(this);\r\n    this._port = port._orig;\r\n    this._master = m;\r\n    this._band = n;\r\n    _rechain(this, this._port, 'ch');\r\n    _rechain(this, this._port, 'mpe');\r\n    _rechain(this, this._port, 'connect');\r\n    _rechain(this, this._port, 'disconnect');\r\n    _rechain(this, this._port, 'close');\r\n  }\r\n  _E.prototype = new _M();\r\n  _E.prototype.channel = function() { return this._master; };\r\n  _E.prototype._receive = function(msg) { this._port._receive(msg); };\r\n  _E.prototype.note = function(n, v, t) {\r\n    this.noteOn(n, v);\r\n    if (t) this.wait(t).noteOff(n);\r\n    return this._thenable();\r\n  };\r\n\r\n  // _W: Watcher object ~ MIDIAccess.onstatechange\r\n  function _W() {\r\n    _R.apply(this);\r\n    this._handles = [];\r\n    _rechain(this, _jzz, 'refresh');\r\n    _rechain(this, _jzz, 'openMidiOut');\r\n    _rechain(this, _jzz, 'openMidiIn');\r\n    _rechain(this, _jzz, 'onChange');\r\n    _rechain(this, _jzz, 'close');\r\n  }\r\n  _W.prototype = new _R();\r\n  function _connectW(arg) {\r\n    if (arg instanceof Function) {\r\n      if (!this._orig._handles.length) _engine._watch();\r\n      _push(this._orig._handles, arg);\r\n    }\r\n  }\r\n  function _disconnectW(arg) {\r\n    if (typeof arg == 'undefined') this._orig._handles = [];\r\n    else _pop(this._orig._handles, arg);\r\n    if (!this._orig._handles.length) _engine._unwatch();\r\n  }\r\n  _W.prototype.connect = function(arg) {\r\n    this._push(_connectW, [arg]);\r\n    return this._thenable();\r\n  };\r\n  _W.prototype.disconnect = function(arg) {\r\n    this._push(_disconnectW, [arg]);\r\n    return this._thenable();\r\n  };\r\n  function _changed(x0, y0, x1, y1) {\r\n    var i;\r\n    if (x0.length != x1.length || y0.length != y1.length) return true;\r\n    for (i = 0; i < x0.length; i++) if (x0[i].name != x1[i].name) return true;\r\n    for (i = 0; i < y0.length; i++) if (y0[i].name != y1[i].name) return true;\r\n    return false;\r\n  }\r\n  function _diff(x0, y0, x1, y1) {\r\n    if (!_changed(x0, y0, x1, y1)) return;\r\n    var ax = []; // added\r\n    var ay = [];\r\n    var rx = []; // removed\r\n    var ry = [];\r\n    var i;\r\n    var h = {};\r\n    for (i = 0; i < x0.length; i++) h[x0[i].name] = true;\r\n    for (i = 0; i < x1.length; i++) if (!h[x1[i].name]) ax.push(x1[i]);\r\n    h = {};\r\n    for (i = 0; i < x1.length; i++) h[x1[i].name] = true;\r\n    for (i = 0; i < x0.length; i++) if (!h[x0[i].name]) rx.push(x0[i]);\r\n    h = {};\r\n    for (i = 0; i < y0.length; i++) h[y0[i].name] = true;\r\n    for (i = 0; i < y1.length; i++) if (!h[y1[i].name]) ay.push(y1[i]);\r\n    h = {};\r\n    for (i = 0; i < y1.length; i++) h[y1[i].name] = true;\r\n    for (i = 0; i < y0.length; i++) if (!h[y0[i].name]) ry.push(y0[i]);\r\n    return { inputs: { added: ax, removed: rx }, outputs: { added: ay, removed: ry } };\r\n  }\r\n  function _fireW(arg) {\r\n    for (i = 0; i < _jzz._watcher._handles.length; i++) _jzz._watcher._handles[i].apply(_jzz, [arg]);\r\n  }\r\n\r\n  var _jzz;\r\n  var _engine = {};\r\n  var _virtual = { _outs: [], _ins: []};\r\n\r\n  // Node.js\r\n  function _tryNODE() {\r\n    if (typeof module != 'undefined' && module.exports) {\r\n      _initNode(require('jazz-midi'));\r\n      return;\r\n    }\r\n    this._break();\r\n  }\r\n  // Jazz-Plugin\r\n  function _tryJazzPlugin() {\r\n    var div = document.createElement('div');\r\n    div.style.visibility = 'hidden';\r\n    document.body.appendChild(div);\r\n    var obj = document.createElement('object');\r\n    obj.style.visibility = 'hidden';\r\n    obj.style.width = '0px'; obj.style.height = '0px';\r\n    obj.classid = 'CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90';\r\n    obj.type = 'audio/x-jazz';\r\n    document.body.appendChild(obj);\r\n    if (obj.isJazz) {\r\n      _initJazzPlugin(obj);\r\n      return;\r\n    }\r\n    this._break();\r\n  }\r\n\r\n  // Web MIDI API\r\n  var _navigator;\r\n  var _requestMIDIAccess;\r\n  if (typeof navigator !== 'undefined' && navigator.requestMIDIAccess) {\r\n    _navigator = navigator;\r\n    _requestMIDIAccess = navigator.requestMIDIAccess;\r\n    try {\r\n      if (_requestMIDIAccess.toString().indexOf('JZZ(') != -1) _requestMIDIAccess = undefined;\r\n    }\r\n    catch (err) {}\r\n  }\r\n  function _tryWebMIDI() {\r\n    if (_requestMIDIAccess) {\r\n      var self = this;\r\n      var onGood = function(midi) {\r\n        _initWebMIDI(midi);\r\n        self._resume();\r\n      };\r\n      var onBad = function(msg) {\r\n        self._crash(msg);\r\n      };\r\n      var opt = {};\r\n      _requestMIDIAccess.call(_navigator, opt).then(onGood, onBad);\r\n      this._pause();\r\n      return;\r\n    }\r\n    this._break();\r\n  }\r\n  function _tryWebMIDIsysex() {\r\n    if (_requestMIDIAccess) {\r\n      var self = this;\r\n      var onGood = function(midi) {\r\n        _initWebMIDI(midi, true);\r\n        self._resume();\r\n      };\r\n      var onBad = function(msg) {\r\n        self._crash(msg);\r\n      };\r\n      var opt = {sysex:true};\r\n      _requestMIDIAccess.call(_navigator, opt).then(onGood, onBad);\r\n      this._pause();\r\n      return;\r\n    }\r\n    this._break();\r\n  }\r\n  // Web-extension\r\n  function _tryCRX() {\r\n    var self = this;\r\n    var inst;\r\n    var msg;\r\n    function eventHandle() {\r\n      inst = true;\r\n      if (!msg) msg = document.getElementById('jazz-midi-msg');\r\n      if (!msg) return;\r\n      var a = [];\r\n      try { a = JSON.parse(msg.innerText); } catch (err) {}\r\n      msg.innerText = '';\r\n      document.removeEventListener('jazz-midi-msg', eventHandle);\r\n      if (a[0] === 'version') {\r\n        _initCRX(msg, a[2]);\r\n        self._resume();\r\n      }\r\n      else {\r\n        self._crash();\r\n      }\r\n    }\r\n    this._pause();\r\n    document.addEventListener('jazz-midi-msg', eventHandle);\r\n    try { document.dispatchEvent(new Event('jazz-midi')); } catch (err) {}\r\n    _schedule(function() { if (!inst) self._crash(); });\r\n  }\r\n\r\n  function _zeroBreak() {\r\n    this._pause();\r\n    var self = this;\r\n    _schedule(function() { self._crash(); });\r\n  }\r\n\r\n  function _filterEngines(opt) {\r\n    var ret = [];\r\n    var arr = _filterEngineNames(opt);\r\n    for (var i = 0; i < arr.length; i++) {\r\n      if (arr[i] == 'webmidi') {\r\n        if (opt && opt.sysex === true) ret.push(_tryWebMIDIsysex);\r\n        if (!opt || opt.sysex !== true || opt.degrade === true) ret.push(_tryWebMIDI);\r\n      }\r\n      else if (arr[i] == 'node') { ret.push(_tryNODE); ret.push(_zeroBreak); }\r\n      else if (arr[i] == 'extension') ret.push(_tryCRX);\r\n      else if (arr[i] == 'plugin') ret.push(_tryJazzPlugin);\r\n    }\r\n    ret.push(_initNONE);\r\n    return ret;\r\n  }\r\n\r\n  function _filterEngineNames(opt) {\r\n    var web = ['node', 'extension', 'plugin', 'webmidi'];\r\n    if (!opt || !opt.engine) return web;\r\n    var arr = opt.engine instanceof Array ? opt.engine : [opt.engine];\r\n    var dup = {};\r\n    var none;\r\n    var etc;\r\n    var head = [];\r\n    var tail = [];\r\n    var i;\r\n    for (i = 0; i < arr.length; i++) {\r\n      var name = arr[i].toString().toLowerCase();\r\n      if (dup[name]) continue;\r\n      dup[name] = true;\r\n      if (name === 'none') none = true;\r\n      if (name === 'etc' || typeof name == 'undefined') etc = true;\r\n      if (etc) tail.push(name); else head.push(name);\r\n      _pop(web, name);\r\n    }\r\n    if (etc || head.length || tail.length) none = false;\r\n    return none ? [] : head.concat(etc ? web : tail);\r\n  }\r\n\r\n  function _initJZZ(opt) {\r\n    _initAudioContext();\r\n    _jzz = new _J();\r\n    _jzz._options = opt;\r\n    _jzz._push(_tryAny, [_filterEngines(opt)]);\r\n    _jzz.refresh();\r\n    _jzz._resume();\r\n  }\r\n\r\n  function _initNONE() {\r\n    _engine._type = 'none';\r\n    _engine._version = _version;\r\n    _engine._sysex = true;\r\n    _engine._outs = [];\r\n    _engine._ins = [];\r\n    _engine._refresh = function() { _postRefresh(); };\r\n    _engine._watch = function() {};\r\n    _engine._unwatch = function() {};\r\n    _engine._close = function() {};\r\n  }\r\n  // common initialization for Jazz-Plugin and jazz-midi\r\n  function _initEngineJP() {\r\n    _engine._inArr = [];\r\n    _engine._outArr = [];\r\n    _engine._inMap = {};\r\n    _engine._outMap = {};\r\n    _engine._outsW = [];\r\n    _engine._insW = [];\r\n    _engine._version = _engine._main.version;\r\n    _engine._sysex = true;\r\n    var watcher;\r\n    function _closeAll() {\r\n      for (var i = 0; i < this.clients.length; i++) this._close(this.clients[i]);\r\n    }\r\n    _engine._refresh = function() {\r\n      _engine._outs = [];\r\n      _engine._ins = [];\r\n      var i, x;\r\n      for (i = 0; (x = _engine._main.MidiOutInfo(i)).length; i++) {\r\n        _engine._outs.push({ type: _engine._type, name: x[0], manufacturer: x[1], version: x[2] });\r\n      }\r\n      for (i = 0; (x = _engine._main.MidiInInfo(i)).length; i++) {\r\n        _engine._ins.push({ type: _engine._type, name: x[0], manufacturer: x[1], version: x[2] });\r\n      }\r\n      _postRefresh();\r\n    };\r\n    _engine._openOut = function(port, name) {\r\n      var impl = _engine._outMap[name];\r\n      if (!impl) {\r\n        if (_engine._pool.length <= _engine._outArr.length) _engine._pool.push(_engine._newPlugin());\r\n        impl = {\r\n          name: name,\r\n          clients: [],\r\n          info: {\r\n            name: name,\r\n            manufacturer: _engine._allOuts[name].manufacturer,\r\n            version: _engine._allOuts[name].version,\r\n            type: 'MIDI-out',\r\n            sysex: _engine._sysex,\r\n            engine: _engine._type\r\n          },\r\n          _close: function(port) { _engine._closeOut(port); },\r\n          _closeAll: _closeAll,\r\n          _receive: function(a) { if (a.length) this.plugin.MidiOutRaw(a.slice()); }\r\n        };\r\n        var plugin = _engine._pool[_engine._outArr.length];\r\n        impl.plugin = plugin;\r\n        _engine._outArr.push(impl);\r\n        _engine._outMap[name] = impl;\r\n      }\r\n      if (!impl.open) {\r\n        var s = impl.plugin.MidiOutOpen(name);\r\n        if (s !== name) {\r\n          if (s) impl.plugin.MidiOutClose();\r\n          port._break(); return;\r\n        }\r\n        impl.open = true;\r\n      }\r\n      port._orig._impl = impl;\r\n      _push(impl.clients, port._orig);\r\n      port._info = impl.info;\r\n      port._receive = function(arg) { impl._receive(arg); };\r\n      port._close = function() { impl._close(this); };\r\n    };\r\n    _engine._openIn = function(port, name) {\r\n      var impl = _engine._inMap[name];\r\n      if (!impl) {\r\n        if (_engine._pool.length <= _engine._inArr.length) _engine._pool.push(_engine._newPlugin());\r\n        impl = {\r\n          name: name,\r\n          clients: [],\r\n          info: {\r\n            name: name,\r\n            manufacturer: _engine._allIns[name].manufacturer,\r\n            version: _engine._allIns[name].version,\r\n            type: 'MIDI-in',\r\n            sysex: _engine._sysex,\r\n            engine: _engine._type\r\n          },\r\n          _close: function(port) { _engine._closeIn(port); },\r\n          _closeAll: _closeAll,\r\n          handle: function(t, a) {\r\n            for (var i = 0; i < this.clients.length; i++) {\r\n              var msg = MIDI(a);\r\n              this.clients[i]._emit(msg);\r\n            }\r\n          }\r\n        };\r\n        var makeHandle = function(x) { return function(t, a) { x.handle(t, a); }; };\r\n        impl.onmidi = makeHandle(impl);\r\n        var plugin = _engine._pool[_engine._inArr.length];\r\n        impl.plugin = plugin;\r\n        _engine._inArr.push(impl);\r\n        _engine._inMap[name] = impl;\r\n      }\r\n      if (!impl.open) {\r\n        var s = impl.plugin.MidiInOpen(name, impl.onmidi);\r\n        if (s !== name) {\r\n          if (s) impl.plugin.MidiInClose();\r\n          port._break(); return;\r\n        }\r\n        impl.open = true;\r\n      }\r\n      port._orig._impl = impl;\r\n      _push(impl.clients, port._orig);\r\n      port._info = impl.info;\r\n      port._close = function() { impl._close(this); };\r\n    };\r\n    _engine._closeOut = function(port) {\r\n      var impl = port._impl;\r\n      _pop(impl.clients, port._orig);\r\n      if (!impl.clients.length && impl.open) {\r\n        impl.open = false;\r\n        impl.plugin.MidiOutClose();\r\n      }\r\n    };\r\n    _engine._closeIn = function(port) {\r\n      var impl = port._impl;\r\n      _pop(impl.clients, port._orig);\r\n      if (!impl.clients.length && impl.open) {\r\n        impl.open = false;\r\n        impl.plugin.MidiInClose();\r\n      }\r\n    };\r\n    _engine._close = function() {\r\n      for (var i = 0; i < _engine._inArr.length; i++) if (_engine._inArr[i].open) _engine._inArr[i].plugin.MidiInClose();\r\n      _engine._unwatch();\r\n    };\r\n    _engine._watch = function() {\r\n      if (!watcher) watcher = setInterval(function() { _engine._refresh(); }, 250);\r\n    };\r\n    _engine._unwatch = function() {\r\n      if (watcher) clearInterval(watcher);\r\n      watcher = undefined;\r\n    };\r\n  }\r\n\r\n  function _initNode(obj) {\r\n    _engine._type = 'node';\r\n    _engine._main = obj;\r\n    _engine._pool = [];\r\n    _engine._newPlugin = function() { return new obj.MIDI(); };\r\n    _initEngineJP();\r\n  }\r\n  function _initJazzPlugin(obj) {\r\n    _engine._type = 'plugin';\r\n    _engine._main = obj;\r\n    _engine._pool = [obj];\r\n    _engine._newPlugin = function() {\r\n      var plg = document.createElement('object');\r\n      plg.style.visibility = 'hidden';\r\n      plg.style.width = '0px'; obj.style.height = '0px';\r\n      plg.classid = 'CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90';\r\n      plg.type = 'audio/x-jazz';\r\n      document.body.appendChild(plg);\r\n      return plg.isJazz ? plg : undefined;\r\n    };\r\n    _initEngineJP();\r\n  }\r\n  function _initWebMIDI(access, sysex) {\r\n    _engine._type = 'webmidi';\r\n    _engine._version = 43;\r\n    _engine._sysex = !!sysex;\r\n    _engine._access = access;\r\n    _engine._inMap = {};\r\n    _engine._outMap = {};\r\n    _engine._outsW = [];\r\n    _engine._insW = [];\r\n    var watcher;\r\n    function _closeAll() {\r\n      for (var i = 0; i < this.clients.length; i++) this._close(this.clients[i]);\r\n    }\r\n    _engine._refresh = function() {\r\n      _engine._outs = [];\r\n      _engine._ins = [];\r\n      _engine._access.outputs.forEach(function(port) {\r\n        _engine._outs.push({type: _engine._type, name: port.name, manufacturer: port.manufacturer, version: port.version});\r\n      });\r\n      _engine._access.inputs.forEach(function(port) {\r\n        _engine._ins.push({type: _engine._type, name: port.name, manufacturer: port.manufacturer, version: port.version});\r\n      });\r\n      _postRefresh();\r\n    };\r\n    _engine._openOut = function(port, name) {\r\n      var impl = _engine._outMap[name];\r\n      if (!impl) {\r\n        impl = {\r\n          name: name,\r\n          clients: [],\r\n          info: {\r\n            name: name,\r\n            manufacturer: _engine._allOuts[name].manufacturer,\r\n            version: _engine._allOuts[name].version,\r\n            type: 'MIDI-out',\r\n            sysex: _engine._sysex,\r\n            engine: _engine._type\r\n          },\r\n          _close: function(port) { _engine._closeOut(port); },\r\n          _closeAll: _closeAll,\r\n          _receive: function(a) { if (impl.dev && a.length) this.dev.send(a.slice()); }\r\n        };\r\n      }\r\n      var found;\r\n      _engine._access.outputs.forEach(function(dev) {\r\n        if (dev.name === name) found = dev;\r\n      });\r\n      if (found) {\r\n        impl.dev = found;\r\n        _engine._outMap[name] = impl;\r\n        port._orig._impl = impl;\r\n        _push(impl.clients, port._orig);\r\n        port._info = impl.info;\r\n        port._receive = function(arg) { impl._receive(arg); };\r\n        port._close = function() { impl._close(this); };\r\n        if (impl.dev.open) {\r\n          port._pause();\r\n          impl.dev.open().then(function() {\r\n            port._resume();\r\n          }, function() {\r\n            port._crash();\r\n          });\r\n        }\r\n      }\r\n      else port._break();\r\n    };\r\n    _engine._openIn = function(port, name) {\r\n      var impl = _engine._inMap[name];\r\n      if (!impl) {\r\n        impl = {\r\n          name: name,\r\n          clients: [],\r\n          info: {\r\n            name: name,\r\n            manufacturer: _engine._allIns[name].manufacturer,\r\n            version: _engine._allIns[name].version,\r\n            type: 'MIDI-in',\r\n            sysex: _engine._sysex,\r\n            engine: _engine._type\r\n          },\r\n          _close: function(port) { _engine._closeIn(port); },\r\n          _closeAll: _closeAll,\r\n          handle: function(evt) {\r\n            for (var i = 0; i < this.clients.length; i++) {\r\n              var msg = MIDI([].slice.call(evt.data));\r\n              this.clients[i]._emit(msg);\r\n            }\r\n          }\r\n        };\r\n      }\r\n      var found;\r\n      _engine._access.inputs.forEach(function(dev) {\r\n        if (dev.name === name) found = dev;\r\n      });\r\n      if (found) {\r\n        impl.dev = found;\r\n        var makeHandle = function(x) { return function(evt) { x.handle(evt); }; };\r\n        impl.dev.onmidimessage = makeHandle(impl);\r\n        _engine._inMap[name] = impl;\r\n        port._orig._impl = impl;\r\n        _push(impl.clients, port._orig);\r\n        port._info = impl.info;\r\n        port._close = function() { impl._close(this); };\r\n        if (impl.dev.open) {\r\n          port._pause();\r\n          impl.dev.open().then(function() {\r\n            port._resume();\r\n          }, function() {\r\n            port._crash();\r\n          });\r\n        }\r\n      }\r\n      else port._break();\r\n    };\r\n    _engine._closeOut = function(port) {\r\n      var impl = port._impl;\r\n      _pop(impl.clients, port._orig);\r\n      if (!impl.clients.length) {\r\n        if (impl.dev && impl.dev.close) impl.dev.close();\r\n        impl.dev = undefined;\r\n      }\r\n    };\r\n    _engine._closeIn = function(port) {\r\n      var impl = port._impl;\r\n      _pop(impl.clients, port._orig);\r\n      if (!impl.clients.length) {\r\n        if (impl.dev) {\r\n          impl.dev.onmidimessage = null;\r\n          if (impl.dev.close) impl.dev.close();\r\n        }\r\n        impl.dev = undefined;\r\n      }\r\n    };\r\n    _engine._close = function() {\r\n      _engine._unwatch();\r\n    };\r\n    _engine._watch = function() {\r\n      _engine._access.onstatechange = function() {\r\n        watcher = true;\r\n        _schedule(function() {\r\n          if (watcher) {\r\n            _engine._refresh();\r\n            watcher = false;\r\n          }\r\n        });\r\n      };\r\n    };\r\n    _engine._unwatch = function() {\r\n      _engine._access.onstatechange = undefined;\r\n    };\r\n  }\r\n  function _initCRX(msg, ver) {\r\n    _engine._type = 'extension';\r\n    _engine._version = ver;\r\n    _engine._sysex = true;\r\n    _engine._pool = [];\r\n    _engine._outs = [];\r\n    _engine._ins = [];\r\n    _engine._inArr = [];\r\n    _engine._outArr = [];\r\n    _engine._inMap = {};\r\n    _engine._outMap = {};\r\n    _engine._outsW = [];\r\n    _engine._insW = [];\r\n    _engine.refreshClients = [];\r\n    _engine._msg = msg;\r\n    _engine._newPlugin = function() {\r\n      var plugin = { id: _engine._pool.length };\r\n      _engine._pool.push(plugin);\r\n      if (!plugin.id) plugin.ready = true;\r\n      else document.dispatchEvent(new CustomEvent('jazz-midi', {detail:['new']}));\r\n    };\r\n    _engine._newPlugin();\r\n    _engine._refresh = function(client) {\r\n      _engine.refreshClients.push(client);\r\n      client._pause();\r\n      _schedule(function() {\r\n        document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['refresh'] }));\r\n      });\r\n    };\r\n    function _closeAll() {\r\n      for (var i = 0; i < this.clients.length; i++) this._close(this.clients[i]);\r\n    }\r\n    _engine._openOut = function(port, name) {\r\n      var impl = _engine._outMap[name];\r\n      if (!impl) {\r\n        if (_engine._pool.length <= _engine._outArr.length) _engine._newPlugin();\r\n        var plugin = _engine._pool[_engine._outArr.length];\r\n        impl = {\r\n          name: name,\r\n          clients: [],\r\n          info: {\r\n            name: name,\r\n            manufacturer: _engine._allOuts[name].manufacturer,\r\n            version: _engine._allOuts[name].version,\r\n            type: 'MIDI-out',\r\n            sysex: _engine._sysex,\r\n            engine: _engine._type\r\n          },\r\n          _start: function() { document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['openout', plugin.id, name] })); },\r\n          _close: function(port) { _engine._closeOut(port); },\r\n          _closeAll: _closeAll,\r\n          _receive: function(a) { if (a.length) { var v = a.slice(); v.splice(0, 0, 'play', plugin.id); document.dispatchEvent(new CustomEvent('jazz-midi', {detail: v})); } }\r\n        };\r\n        impl.plugin = plugin;\r\n        plugin.output = impl;\r\n        _engine._outArr.push(impl);\r\n        _engine._outMap[name] = impl;\r\n      }\r\n      port._orig._impl = impl;\r\n      _push(impl.clients, port._orig);\r\n      port._info = impl.info;\r\n      port._receive = function(arg) { impl._receive(arg); };\r\n      port._close = function() { impl._close(this); };\r\n      if (!impl.open) {\r\n        port._pause();\r\n        if (impl.plugin.ready) impl._start();\r\n      }\r\n    };\r\n    _engine._openIn = function(port, name) {\r\n      var impl = _engine._inMap[name];\r\n      if (!impl) {\r\n        if (_engine._pool.length <= _engine._inArr.length) _engine._newPlugin();\r\n        var plugin = _engine._pool[_engine._inArr.length];\r\n        impl = {\r\n          name: name,\r\n          clients: [],\r\n          info: {\r\n            name: name,\r\n            manufacturer: _engine._allIns[name].manufacturer,\r\n            version: _engine._allIns[name].version,\r\n            type: 'MIDI-in',\r\n            sysex: _engine._sysex,\r\n            engine: _engine._type\r\n          },\r\n          _start: function() { document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['openin', plugin.id, name] })); },\r\n          _close: function(port) { _engine._closeIn(port); },\r\n          _closeAll: _closeAll\r\n        };\r\n        impl.plugin = plugin;\r\n        plugin.input = impl;\r\n        _engine._inArr.push(impl);\r\n        _engine._inMap[name] = impl;\r\n      }\r\n      port._orig._impl = impl;\r\n      _push(impl.clients, port._orig);\r\n      port._info = impl.info;\r\n      port._close = function() { impl._close(this); };\r\n      if (!impl.open) {\r\n        port._pause();\r\n        if (impl.plugin.ready) impl._start();\r\n      }\r\n    };\r\n    _engine._closeOut = function(port) {\r\n      var impl = port._impl;\r\n      _pop(impl.clients, port._orig);\r\n      if (!impl.clients.length && impl.open) {\r\n        impl.open = false;\r\n        document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['closeout', impl.plugin.id] }));\r\n      }\r\n    };\r\n    _engine._closeIn = function(port) {\r\n      var impl = port._impl;\r\n      _pop(impl.clients, port._orig);\r\n      if (!impl.clients.length && impl.open) {\r\n        impl.open = false;\r\n        document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['closein', impl.plugin.id] }));\r\n      }\r\n    };\r\n    _engine._close = function() {\r\n      _engine._unwatch();\r\n    };\r\n    var watcher;\r\n    _engine._watch = function() {\r\n      _engine._insW = _engine._ins;\r\n      _engine._outsW = _engine._outs;\r\n      watcher = setInterval(function() {\r\n        document.dispatchEvent(new CustomEvent('jazz-midi', {detail:['refresh']}));\r\n      }, 250);\r\n    };\r\n    _engine._unwatch = function() {\r\n      clearInterval(watcher);\r\n      watcher = undefined;\r\n    };\r\n    document.addEventListener('jazz-midi-msg', function() {\r\n      var v = _engine._msg.innerText.split('\\n');\r\n      var impl, i, j;\r\n      _engine._msg.innerText = '';\r\n      for (i = 0; i < v.length; i++) {\r\n        var a = [];\r\n        try { a = JSON.parse(v[i]); } catch (err) {}\r\n        if (!a.length) continue;\r\n        if (a[0] === 'refresh') {\r\n          if (a[1].ins) {\r\n            for (j = 0; j < a[1].ins.length; j++) a[1].ins[j].type = _engine._type;\r\n            _engine._ins = a[1].ins;\r\n          }\r\n          if (a[1].outs) {\r\n            for (j = 0; j < a[1].outs.length; j++) a[1].outs[j].type = _engine._type;\r\n            _engine._outs = a[1].outs;\r\n          }\r\n          _postRefresh();\r\n          for (j = 0; j < _engine.refreshClients.length; j++) _engine.refreshClients[j]._resume();\r\n          _engine.refreshClients = [];\r\n        }\r\n        else if (a[0] === 'version') {\r\n          var plugin = _engine._pool[a[1]];\r\n          if (plugin) {\r\n            plugin.ready = true;\r\n            if (plugin.input) plugin.input._start();\r\n            if (plugin.output) plugin.output._start();\r\n          }\r\n        }\r\n        else if (a[0] === 'openout') {\r\n          impl = _engine._pool[a[1]].output;\r\n          if (impl) {\r\n            if (a[2] == impl.name) {\r\n              impl.open = true;\r\n              if (impl.clients) for (j = 0; j < impl.clients.length; j++) impl.clients[j]._resume();\r\n            }\r\n            else if (impl.clients) for (j = 0; j < impl.clients.length; j++) impl.clients[j]._crash();\r\n          }\r\n        }\r\n        else if (a[0] === 'openin') {\r\n          impl = _engine._pool[a[1]].input;\r\n          if (impl) {\r\n            if (a[2] == impl.name) {\r\n              impl.open = true;\r\n              if (impl.clients) for (j = 0; j < impl.clients.length; j++) impl.clients[j]._resume();\r\n            }\r\n            else if (impl.clients) for (j = 0; j < impl.clients.length; j++) impl.clients[j]._crash();\r\n          }\r\n        }\r\n        else if (a[0] === 'midi') {\r\n          impl = _engine._pool[a[1]].input;\r\n          if (impl && impl.clients) {\r\n            for (j = 0; j < impl.clients.length; j++) {\r\n              var msg = MIDI(a.slice(3));\r\n              impl.clients[j]._emit(msg);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  var JZZ = function(opt) {\r\n    if (!_jzz) _initJZZ(opt);\r\n    return _jzz._thenable();\r\n  };\r\n  JZZ.JZZ = JZZ;\r\n  JZZ.info = function() { return _J.prototype.info(); };\r\n  JZZ.Widget = function(arg) {\r\n    var obj = new _M();\r\n    if (arg instanceof Object) for (var k in arg) if (arg.hasOwnProperty(k)) obj[k] = arg[k];\r\n    obj._resume();\r\n    return obj;\r\n  };\r\n  _J.prototype.Widget = JZZ.Widget;\r\n\r\n  // JZZ.SMPTE\r\n\r\n  function SMPTE() {\r\n    var self = this instanceof SMPTE ? this : self = new SMPTE();\r\n    SMPTE.prototype.reset.apply(self, arguments);\r\n    return self;\r\n  }\r\n  SMPTE.prototype.reset = function(arg) {\r\n    if (arg instanceof SMPTE) {\r\n      this.setType(arg.getType());\r\n      this.setHour(arg.getHour());\r\n      this.setMinute(arg.getMinute());\r\n      this.setSecond(arg.getSecond());\r\n      this.setFrame(arg.getFrame());\r\n      this.setQuarter(arg.getQuarter());\r\n      return this;\r\n    }\r\n    var arr = arg instanceof Array ? arg : arguments;\r\n    this.setType(arr[0]);\r\n    this.setHour(arr[1]);\r\n    this.setMinute(arr[2]);\r\n    this.setSecond(arr[3]);\r\n    this.setFrame(arr[4]);\r\n    this.setQuarter(arr[5]);\r\n    return this;\r\n  };\r\n  function _fixDropFrame() { if (this.type == 29.97 && !this.second && this.frame < 2 && this.minute % 10) this.frame = 2; }\r\n  SMPTE.prototype.isFullFrame = function() { return this.quarter == 0 || this.quarter == 4; };\r\n  SMPTE.prototype.getType = function() { return this.type; };\r\n  SMPTE.prototype.getHour = function() { return this.hour; };\r\n  SMPTE.prototype.getMinute = function() { return this.minute; };\r\n  SMPTE.prototype.getSecond = function() { return this.second; };\r\n  SMPTE.prototype.getFrame = function() { return this.frame; };\r\n  SMPTE.prototype.getQuarter = function() { return this.quarter; };\r\n  SMPTE.prototype.setType = function(x) {\r\n    if (typeof x == 'undefined' || x == 24) this.type = 24;\r\n    else if (x == 25) this.type = 25;\r\n    else if (x == 29.97) { this.type = 29.97; _fixDropFrame.apply(this); }\r\n    else if (x == 30) this.type = 30;\r\n    else throw RangeError('Bad SMPTE frame rate: ' + x);\r\n    if (this.frame >= this.type) this.frame = this.type - 1; // could not be more than 29\r\n    return this;\r\n  };\r\n  SMPTE.prototype.setHour = function(x) {\r\n    if (typeof x == 'undefined') x = 0;\r\n    if (x != parseInt(x) || x < 0 || x >= 24) throw RangeError('Bad SMPTE hours value: ' + x);\r\n    this.hour = x;\r\n    return this;\r\n  };\r\n  SMPTE.prototype.setMinute = function(x) {\r\n    if (typeof x == 'undefined') x = 0;\r\n    if (x != parseInt(x) || x < 0 || x >= 60) throw RangeError('Bad SMPTE minutes value: ' + x);\r\n    this.minute = x;\r\n    _fixDropFrame.apply(this);\r\n    return this;\r\n  };\r\n  SMPTE.prototype.setSecond = function(x) {\r\n    if (typeof x == 'undefined') x = 0;\r\n    if (x != parseInt(x) || x < 0 || x >= 60) throw RangeError('Bad SMPTE seconds value: ' + x);\r\n    this.second = x;\r\n    _fixDropFrame.apply(this);\r\n    return this;\r\n  };\r\n  SMPTE.prototype.setFrame = function(x) {\r\n    if (typeof x == 'undefined') x = 0;\r\n    if (x != parseInt(x) || x < 0 || x >= this.type) throw RangeError('Bad SMPTE frame number: ' + x);\r\n    this.frame = x;\r\n    _fixDropFrame.apply(this);\r\n    return this;\r\n  };\r\n  SMPTE.prototype.setQuarter = function(x) {\r\n    if (typeof x == 'undefined') x = 0;\r\n    if (x != parseInt(x) || x < 0 || x >= 8) throw RangeError('Bad SMPTE quarter frame: ' + x);\r\n    this.quarter = x;\r\n    return this;\r\n  };\r\n  SMPTE.prototype.incrFrame = function() {\r\n    this.frame++;\r\n    if (this.frame >= this.type) {\r\n      this.frame = 0;\r\n      this.second++;\r\n      if (this.second >= 60) {\r\n        this.second = 0;\r\n        this.minute++;\r\n        if (this.minute >= 60) {\r\n          this.minute = 0;\r\n          this.hour = this.hour >= 23 ? 0 : this.hour + 1;\r\n        }\r\n      }\r\n    }\r\n    _fixDropFrame.apply(this);\r\n    return this;\r\n  };\r\n  SMPTE.prototype.decrFrame = function() {\r\n    if (!this.second && this.frame == 2 && this.type == 29.97 && this.minute % 10) this.frame = 0; // drop-frame\r\n    this.frame--;\r\n    if (this.frame < 0) {\r\n      this.frame = this.type == 29.97 ? 29 : this.type - 1;\r\n      this.second--;\r\n      if (this.second < 0) {\r\n        this.second = 59;\r\n        this.minute--;\r\n        if (this.minute < 0) {\r\n          this.minute = 59;\r\n          this.hour = this.hour ? this.hour - 1 : 23;\r\n        }\r\n      }\r\n    }\r\n    return this;\r\n  };\r\n  SMPTE.prototype.incrQF = function() {\r\n    this.backwards = false;\r\n    this.quarter = (this.quarter + 1) & 7;\r\n    if (this.quarter == 0 || this.quarter == 4) this.incrFrame();\r\n    return this;\r\n  };\r\n  SMPTE.prototype.decrQF = function() {\r\n    this.backwards = true;\r\n    this.quarter = (this.quarter + 7) & 7;\r\n    if (this.quarter == 3 || this.quarter == 7) this.decrFrame();\r\n    return this;\r\n  };\r\n  function _825(a) { return [[24, 25, 29.97, 30][(a[7] >> 1) & 3], ((a[7] & 1) << 4) | a[6], (a[5] << 4) | a[4], (a[3] << 4) | a[2], (a[1] << 4) | a[0]]; }\r\n  SMPTE.prototype.read = function(m) {\r\n    if (!(m instanceof MIDI)) m = MIDI.apply(null, arguments);\r\n    if (m[0] == 0xf0 && m[1] == 0x7f && m[3] == 1 && m[4] == 1 && m[9] == 0xf7) {\r\n      this.type = [24, 25, 29.97, 30][(m[5] >> 5) & 3];\r\n      this.hour = m[5] & 31;\r\n      this.minute = m[6];\r\n      this.second = m[7];\r\n      this.frame = m[8];\r\n      this.quarter = 0;\r\n      this._ = undefined;\r\n      this._b = undefined;\r\n      this._f = undefined;\r\n      return true;\r\n    }\r\n    if (m[0] == 0xf1 && typeof m[1] != 'undefined') {\r\n      var q = m[1] >> 4;\r\n      var n = m[1] & 15;\r\n      if (q == 0) {\r\n        if (this._ == 7) {\r\n          if (this._f == 7) {\r\n            this.reset(_825(this._a));\r\n            this.incrFrame();\r\n          }\r\n          this.incrFrame();\r\n        }\r\n      }\r\n      else if (q == 3) {\r\n        if (this._ == 4) {\r\n          this.decrFrame();\r\n        }\r\n      }\r\n      else if (q == 4) {\r\n        if (this._ == 3) {\r\n          this.incrFrame();\r\n        }\r\n      }\r\n      else if (q == 7) {\r\n        if (this._ === 0) {\r\n          if (this._b === 0) {\r\n            this.reset(_825(this._a));\r\n            this.decrFrame();\r\n          }\r\n          this.decrFrame();\r\n        }\r\n      }\r\n      if (!this._a) this._a = [];\r\n      this._a[q] = n;\r\n      this._f = this._f === q - 1 || q == 0 ? q : undefined;\r\n      this._b = this._b === q + 1 || q == 7 ? q : undefined;\r\n      this._ = q;\r\n      this.quarter = q;\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n  function _mtc(t) {\r\n    if (!t.backwards && t.quarter >= 4) t.decrFrame(); // continue encoding previous frame\r\n    else if (t.backwards && t.quarter < 4) t.incrFrame();\r\n    var ret;\r\n    switch (t.quarter >> 1) {\r\n      case 0: ret = t.frame; break;\r\n      case 1: ret = t.second; break;\r\n      case 2: ret = t.minute; break;\r\n      default: ret = t.hour;\r\n    }\r\n    if (t.quarter & 1) ret >>= 4;\r\n    else ret &= 15;\r\n    if (t.quarter == 7) {\r\n      if (t.type == 25) ret |= 2;\r\n      else if (t.type == 29.97) ret |= 4;\r\n      else if (t.type == 30) ret |= 6;\r\n    }\r\n    // restore original t\r\n    if (!t.backwards && t.quarter >= 4) t.incrFrame();\r\n    else if (t.backwards && t.quarter < 4) t.decrFrame();\r\n    return ret | (t.quarter << 4);\r\n  }\r\n  function _hrtype(t) {\r\n    if (t.type == 25) return t.hour | 0x20;\r\n    if (t.type == 29.97) return t.hour | 0x40;\r\n    if (t.type == 30) return t.hour | 0x60;\r\n    return t.hour;\r\n  }\r\n  function _dec(x) { return x < 10 ? '0' + x : x; }\r\n  function _smptetxt(x) {\r\n    var arr = [];\r\n    for (var i = 0; i < x.length; i++) arr[i] = _dec(x[i]);\r\n    return arr.join(':');\r\n  }\r\n  SMPTE.prototype.toString = function() { return _smptetxt([this.hour, this.minute, this.second, this.frame]); };\r\n  JZZ.SMPTE = SMPTE;\r\n\r\n  // JZZ.MIDI\r\n\r\n  function MIDI(arg) {\r\n    var self = this instanceof MIDI ? this : self = new MIDI();\r\n    var i;\r\n    if (arg instanceof MIDI) {\r\n      self._from = arg._from.slice();\r\n      for (i in arg) if (arg.hasOwnProperty(i) && i != '_from') self[i] = arg[i];\r\n      return self;\r\n    }\r\n    else self._from = [];\r\n    if (typeof arg == 'undefined') return self;\r\n    var arr = arg instanceof Array ? arg : arguments;\r\n    for (i = 0; i < arr.length; i++) {\r\n      n = arr[i];\r\n      if (i == 1) {\r\n        if (self[0] >= 0x80 && self[0] <= 0xAF) n = MIDI.noteValue(n);\r\n        if (self[0] >= 0xC0 && self[0] <= 0xCF) n = MIDI.programValue(n);\r\n      }\r\n      if (n != parseInt(n) || n < 0 || n > 255) _throw(arr[i]);\r\n      self.push(n);\r\n    }\r\n    return self;\r\n  }\r\n  MIDI.prototype = [];\r\n  MIDI.prototype.constructor = MIDI;\r\n  var _noteNum = {};\r\n  MIDI.noteValue = function(x) { return typeof x == 'undefined' ? undefined : _noteNum[x.toString().toLowerCase()]; };\r\n  MIDI.programValue = function(x) { return x; };\r\n  MIDI.freq = function(n, a) {\r\n    if (typeof a == 'undefined') a = 440.0;\r\n    return (a * Math.pow(2, (_7b(MIDI.noteValue(n), n) - 69.0) / 12.0));\r\n  };\r\n\r\n  var _noteMap = { c:0, d:2, e:4, f:5, g:7, a:9, b:11, h:11 };\r\n  for (k in _noteMap) {\r\n    if (!_noteMap.hasOwnProperty(k)) continue;\r\n    for (n = 0; n < 12; n++) {\r\n      m = _noteMap[k] + n * 12;\r\n      if (m > 127) break;\r\n      _noteNum[k+n] = m;\r\n      if (m > 0) { _noteNum[k + 'b' + n] = m - 1; _noteNum[k + 'bb' + n] = m - 2; }\r\n      if (m < 127) { _noteNum[k + '#' + n] = m + 1; _noteNum[k + '##' + n] = m + 2; }\r\n    }\r\n  }\r\n  for (n = 0; n < 128; n++) _noteNum[n] = n;\r\n  function _throw(x) { throw RangeError('Bad MIDI value: ' + x); }\r\n  function _ch(c) { _validateChannel(c); return parseInt(c); }\r\n  function _7b(n, m) { if (n != parseInt(n) || n < 0 || n > 0x7f) _throw(typeof m == 'undefined' ? n : m); return parseInt(n); }\r\n  function _8b(n, m) { if (n != parseInt(n) || n < 0 || n > 0xff) _throw(typeof m == 'undefined' ? n : m); return parseInt(n); }\r\n  function _lsb(n) { if (n != parseInt(n) || n < 0 || n > 0x3fff) _throw(n); return parseInt(n) & 0x7f; }\r\n  function _msb(n) { if (n != parseInt(n) || n < 0 || n > 0x3fff) _throw(n); return parseInt(n) >> 7; }\r\n  function _8bs(s) { s = '' + s; for (var i = 0; i < s.length; i++) if (s.charCodeAt(i) > 255) _throw(s[i]); return s; }\r\n  var _helperCH = {\r\n    noteOff: function(c, n, v) { if (typeof v == 'undefined') v = 64; return [0x80 + _ch(c), _7b(MIDI.noteValue(n), n), _7b(v)]; },\r\n    noteOn: function(c, n, v) { if (typeof v == 'undefined') v = 127; return [0x90 + _ch(c), _7b(MIDI.noteValue(n), n), _7b(v)]; },\r\n    aftertouch: function(c, n, v) { return [0xA0 + _ch(c), _7b(MIDI.noteValue(n), n), _7b(v)]; },\r\n    control: function(c, n, v) { return [0xB0 + _ch(c), _7b(n), _7b(v)]; },\r\n    program: function(c, n) { return [0xC0 + _ch(c), _7b(MIDI.programValue(n), n)]; },\r\n    pressure: function(c, n) { return [0xD0 + _ch(c), _7b(n)]; },\r\n    pitchBend: function(c, n) { return [0xE0 + _ch(c), _lsb(n), _msb(n)]; },\r\n    bankMSB: function(c, n) { return [0xB0 + _ch(c), 0x00, _7b(n)]; },\r\n    bankLSB: function(c, n) { return [0xB0 + _ch(c), 0x20, _7b(n)]; },\r\n    modMSB: function(c, n) { return [0xB0 + _ch(c), 0x01, _7b(n)]; },\r\n    modLSB: function(c, n) { return [0xB0 + _ch(c), 0x21, _7b(n)]; },\r\n    breathMSB: function(c, n) { return [0xB0 + _ch(c), 0x02, _7b(n)]; },\r\n    breathLSB: function(c, n) { return [0xB0 + _ch(c), 0x22, _7b(n)]; },\r\n    footMSB: function(c, n) { return [0xB0 + _ch(c), 0x04, _7b(n)]; },\r\n    footLSB: function(c, n) { return [0xB0 + _ch(c), 0x24, _7b(n)]; },\r\n    portamentoMSB: function(c, n) { return [0xB0 + _ch(c), 0x05, _7b(n)]; },\r\n    portamentoLSB: function(c, n) { return [0xB0 + _ch(c), 0x25, _7b(n)]; },\r\n    volumeMSB: function(c, n) { return [0xB0 + _ch(c), 0x07, _7b(n)]; },\r\n    volumeLSB: function(c, n) { return [0xB0 + _ch(c), 0x27, _7b(n)]; },\r\n    balanceMSB: function(c, n) { return [0xB0 + _ch(c), 0x08, _7b(n)]; },\r\n    balanceLSB: function(c, n) { return [0xB0 + _ch(c), 0x28, _7b(n)]; },\r\n    panMSB: function(c, n) { return [0xB0 + _ch(c), 0x0A, _7b(n)]; },\r\n    panLSB: function(c, n) { return [0xB0 + _ch(c), 0x2A, _7b(n)]; },\r\n    expressionMSB: function(c, n) { return [0xB0 + _ch(c), 0x0B, _7b(n)]; },\r\n    expressionLSB: function(c, n) { return [0xB0 + _ch(c), 0x2B, _7b(n)]; },\r\n    damper: function(c, b) { return [0xB0 + _ch(c), 0x40, b ? 127 : 0]; },\r\n    portamento: function(c, b) { return [0xB0 + _ch(c), 0x41, b ? 127 : 0]; },\r\n    sostenuto: function(c, b) { return [0xB0 + _ch(c), 0x42, b ? 127 : 0]; },\r\n    soft: function(c, b) { return [0xB0 + _ch(c), 0x43, b ? 127 : 0]; },\r\n    allSoundOff: function(c) { return [0xB0 + _ch(c), 0x78, 0]; },\r\n    allNotesOff: function(c) { return [0xB0 + _ch(c), 0x7b, 0]; },\r\n  };\r\n  var _helperNC = { // no channel\r\n    mtc: function(t) { return [0xF1, _mtc(t)]; },\r\n    songPosition: function(n) { return [0xF2, _lsb(n), _msb(n)]; },\r\n    songSelect: function(n) { return [0xF3, _7b(n)]; },\r\n    tune: function() { return [0xF6]; },\r\n    clock: function() { return [0xF8]; },\r\n    start: function() { return [0xFA]; },\r\n    continue: function() { return [0xFB]; },\r\n    stop: function() { return [0xFC]; },\r\n    active: function() { return [0xFE]; },\r\n    sxIdRequest: function() { return [0xF0, 0x7E, 0x7F, 0x06, 0x01, 0xF7]; },\r\n    sxFullFrame: function(t) { return [0xF0, 0x7F, 0x7F, 0x01, 0x01, _hrtype(t), t.getMinute(), t.getSecond(), t.getFrame(), 0xF7]; },\r\n    reset: function() { return [0xFF]; },\r\n  };\r\n  function _smf(ff, dd) {\r\n    var midi = new MIDI();\r\n    midi.ff = _8b(ff);\r\n    midi.dd = typeof dd == 'undefined' ? '' : _8bs(dd);\r\n    return midi;\r\n  }\r\n  var _helperSMF = { // Standard MIDI File events\r\n    smf: function(arg) {\r\n      if (arg instanceof MIDI) return new MIDI(arg);\r\n      var arr = arg instanceof Array ? arg : arguments;\r\n      var ff = _8b(arr[0]);\r\n      var dd = '';\r\n      if (arr.length == 2) dd = _2s(arr[1]);\r\n      else if (arr.length > 2) dd = _2s(Array.prototype.slice.call(arr, 1));\r\n      return _smf(ff, dd);\r\n    },\r\n    smfSeqNumber: function(dd) {\r\n      if (dd == parseInt(dd)) {\r\n        if (dd < 0 || dd > 0xffff) throw RangeError('Sequence number out of range: ' + dd);\r\n        dd = String.fromCharCode(dd >> 8) + String.fromCharCode(dd & 0xff);\r\n      }\r\n      else {\r\n        dd = '' + dd;\r\n        if (dd.length == 0) dd = '\\x00\\x00';\r\n        else if (dd.length == 1) dd = '\\x00' + dd;\r\n        else if (dd.length > 2) throw RangeError('Sequence number out of range: ' + _smftxt(dd));\r\n      }\r\n      return _smf(0, dd);\r\n    },\r\n    smfText: function(dd) { return _smf(1, JZZ.lib.toUTF8(dd)); },\r\n    smfCopyright: function(dd) { return _smf(2, JZZ.lib.toUTF8(dd)); },\r\n    smfSeqName: function(dd) { return _smf(3, JZZ.lib.toUTF8(dd)); },\r\n    smfInstrName: function(dd) { return _smf(4, JZZ.lib.toUTF8(dd)); },\r\n    smfLyric: function(dd) { return _smf(5, JZZ.lib.toUTF8(dd)); },\r\n    smfMarker: function(dd) { return _smf(6, JZZ.lib.toUTF8(dd)); },\r\n    smfCuePoint: function(dd) { return _smf(7, JZZ.lib.toUTF8(dd)); },\r\n    smfProgName: function(dd) { return _smf(8, JZZ.lib.toUTF8(dd)); },\r\n    smfDevName: function(dd) { return _smf(9, JZZ.lib.toUTF8(dd)); },\r\n    smfChannelPrefix: function(dd) {\r\n      if (dd == parseInt(dd)) {\r\n        _validateChannel(dd);\r\n        dd = String.fromCharCode(dd);\r\n      }\r\n      else {\r\n        dd = '' + dd;\r\n        if (dd.length == 0) dd = '\\x00';\r\n        else if (dd.length > 1 || dd.charCodeAt(0) > 15) throw RangeError('Channel number out of range: ' + _smftxt(dd));\r\n      }\r\n      return _smf(32, dd);\r\n    },\r\n    smfMidiPort: function(dd) {\r\n      if (dd == parseInt(dd)) {\r\n        if (dd < 0 || dd > 127) throw RangeError('Port number out of range: ' + dd);\r\n        dd = String.fromCharCode(dd);\r\n      }\r\n      else {\r\n        dd = '' + dd;\r\n        if (dd.length == 0) dd = '\\x00';\r\n        else if (dd.length > 1 || dd.charCodeAt(0) > 127) throw RangeError('Port number out of range: ' + _smftxt(dd));\r\n      }\r\n      return _smf(33, dd);\r\n    },\r\n    smfEndOfTrack: function(dd) {\r\n      if (_2s(dd) != '') throw RangeError('Unexpected data: ' + _smftxt(_2s(dd)));\r\n      return _smf(47);\r\n    },\r\n    smfTempo: function(dd) { // microseconds per quarter note\r\n      if (('' + dd).length == 3) return _smf(81, dd);\r\n      if (dd == parseInt(dd) && dd > 0 && dd <= 0xffffff) {\r\n        return _smf(81, String.fromCharCode(dd >> 16) + String.fromCharCode((dd >> 8) & 0xff) + String.fromCharCode(dd & 0xff));\r\n      }\r\n      throw RangeError('Out of range: ' + _smftxt(_2s(dd)));\r\n    },\r\n    smfBPM: function(bpm) { return _helperSMF.smfTempo(Math.round(60000000.0 / bpm)); },\r\n    smfSMPTE: function(dd) {\r\n      if (dd instanceof SMPTE) return _smf(84, String.fromCharCode(dd.hour) + String.fromCharCode(dd.minute) + String.fromCharCode(dd.second) + String.fromCharCode(dd.frame) + String.fromCharCode((dd.quarter % 4) * 25));\r\n      var s = '' + dd;\r\n      if (s.length == 5) {\r\n        return _smf(84, dd);\r\n      }\r\n      var arr = dd instanceof Array ? dd : Array.prototype.slice.call(arguments);\r\n      arr.splice(0, 0, 30);\r\n      return _helperSMF.smfSMPTE(new SMPTE(arr));\r\n    },\r\n    smfTimeSignature: function(a, b, c, d) {\r\n      var nn, dd, cc, bb;\r\n      var m = ('' + a ).match(/^\\s*(\\d+)\\s*\\/\\s*(\\d+)\\s*$/);\r\n      if (m) {\r\n        nn = parseInt(m[1]);\r\n        dd = parseInt(m[2]);\r\n        if (nn > 0 && nn <= 0xff && dd && !(dd & (dd - 1))) {\r\n          cc = dd; dd = 0;\r\n          for (cc >>= 1; cc; cc >>= 1) dd++;\r\n          cc = b == parseInt(b) ? b : 24;\r\n          bb = c == parseInt(c) ? c : 8;\r\n          return _smf(88, String.fromCharCode(nn) + String.fromCharCode(dd) + String.fromCharCode(cc) + String.fromCharCode(bb));\r\n        }\r\n        else if (('' + a ).length == 4) return _smf(88, a);\r\n      }\r\n      else if (a == parseInt(a) && b == parseInt(b) && b && !(b & (b - 1))) {\r\n        nn = a;\r\n        dd = 0;\r\n        cc = b;\r\n        for (cc >>= 1; cc; cc >>= 1) dd++;\r\n        cc = c == parseInt(c) ? c : 24;\r\n        bb = d == parseInt(d) ? d : 8;\r\n        return _smf(88, String.fromCharCode(nn) + String.fromCharCode(dd) + String.fromCharCode(cc) + String.fromCharCode(bb));\r\n      }\r\n      else if (('' + a ).length == 4) return _smf(88, a);\r\n      throw RangeError('Wrong time signature: ' + _smftxt(_2s(a)));\r\n    },\r\n    smfKeySignature: function(dd) {\r\n      dd = '' + dd;\r\n      var m = dd.match(/^\\s*([A-H][b#]?)\\s*(|maj|major|dur|m|min|minor|moll)\\s*$/i);\r\n      if (m) {\r\n        var sf = {\r\n          CB: 0, GB: 1, DB: 2, AB: 3, EB: 4, BB: 5, F: 6, C: 7, G: 8, D: 9, A: 10,\r\n          E:11, B: 12, H: 12, 'F#': 13, 'C#': 14, 'G#': 15, 'D#': 16, 'A#': 17\r\n        }[m[1].toUpperCase()];\r\n        var mi = { '': 0, MAJ: 0, MAJOR: 0, DUR: 0, M: 1, MIN: 1, MINOR: 1, MOLL: 1}[m[2].toUpperCase()];\r\n        if (typeof sf != 'undefined' && typeof mi != 'undefined') {\r\n          if (mi) sf -= 3;\r\n          sf -= 7;\r\n          if (sf >= -7 && sf < 0) dd = String.fromCharCode(256 + sf) + String.fromCharCode(mi);\r\n          else if (sf >= 0 && sf <= 7) dd = String.fromCharCode(sf) + String.fromCharCode(mi);\r\n        }\r\n      }\r\n      if (dd.length == 2 && dd.charCodeAt(1) <= 1 && (dd.charCodeAt(0) <= 7 || dd.charCodeAt(0) <= 255 && dd.charCodeAt(0) >= 249)) return _smf(89, dd);\r\n      throw RangeError('Incorrect key signature: ' + _smftxt(dd));\r\n    },\r\n    smfSequencer: function(dd) { return _smf(127, _2s(dd)); }\r\n  };\r\n\r\n  function _copyPortHelper(M, name, func) {\r\n    M.prototype[name] = function() { this.send(func.apply(0, arguments)); return this; };\r\n  }\r\n  function _copyChannelHelper(C, name, func) {\r\n    C.prototype[name] = function() {\r\n      this.send(func.apply(0, [this._chan].concat(Array.prototype.slice.call(arguments)))); return this;\r\n    };\r\n  }\r\n  function _copyHelperNC(name, func) {\r\n    MIDI[name] = function() { return new MIDI(func.apply(0, arguments)); };\r\n  }\r\n  function _copyHelperSMF(name, func) {\r\n    MIDI[name] = function() { return func.apply(0, arguments); };\r\n  }\r\n  function _copyHelperCH(name, func) {\r\n    _copyHelperNC(name, func);\r\n    _E.prototype[name] = function() {\r\n      var chan;\r\n      var args = Array.prototype.slice.call(arguments);\r\n      if (args.length < func.length) args = [this._master].concat(args);\r\n      else {\r\n        chan = _7b(MIDI.noteValue(args[0], args[0]));\r\n        args[0] = this._master;\r\n      }\r\n      var msg = func.apply(0, args);\r\n      msg.mpe = chan;\r\n      this.send(msg);\r\n      return this;\r\n    };\r\n  }\r\n  for (k in _helperNC) if (_helperNC.hasOwnProperty(k)) _copyHelperNC(k, _helperNC[k]);\r\n  for (k in _helperSMF) if (_helperSMF.hasOwnProperty(k)) _copyHelperSMF(k, _helperSMF[k]);\r\n  for (k in _helperCH) if (_helperCH.hasOwnProperty(k)) _copyHelperCH(k, _helperCH[k]);\r\n  function _copyMidiHelpers(M, C) {\r\n    for (k in _helperNC) if (_helperNC.hasOwnProperty(k)) _copyPortHelper(M, k, _helperNC[k]);\r\n    for (k in _helperSMF) if (_helperSMF.hasOwnProperty(k)) _copyPortHelper(M, k, _helperSMF[k]);\r\n    for (k in _helperCH) if (_helperCH.hasOwnProperty(k)) _copyPortHelper(M, k, _helperCH[k]);\r\n    if (C) for (k in _helperCH) if (_helperCH.hasOwnProperty(k)) _copyChannelHelper(C, k, _helperCH[k]);\r\n  }\r\n  _copyMidiHelpers(_M, _C);\r\n\r\n  _E.prototype.noteOn = function(n, v) {\r\n    var msg = MIDI.noteOn(this._master, n, v);\r\n    msg._mpe = msg[1];\r\n    this.send(msg);\r\n    return this;\r\n  };\r\n  _E.prototype.noteOff = function(n, v) {\r\n    var msg = MIDI.noteOff(this._master, n, v);\r\n    msg._mpe = msg[1];\r\n    this.send(msg);\r\n    return this;\r\n  };\r\n  _E.prototype.aftertouch = function(n, v) {\r\n    var msg = MIDI.aftertouch(this._master, n, v);\r\n    msg._mpe = msg[1];\r\n    this.send(msg);\r\n    return this;\r\n  };\r\n\r\n  var _channelMap = { a:10, b:11, c:12, d:13, e:14, f:15, A:10, B:11, C:12, D:13, E:14, F:15 };\r\n  for (k = 0; k < 16; k++) _channelMap[k] = k;\r\n  MIDI.prototype.getChannel = function() {\r\n    if (this.ff == 0x20 && this.dd.length == 1 && this.dd.charCodeAt(0) < 16) return this.dd.charCodeAt(0);\r\n    var c = this[0];\r\n    if (typeof c == 'undefined' || c < 0x80 || c > 0xef) return;\r\n    return c & 15;\r\n  };\r\n  MIDI.prototype.setChannel = function(x) {\r\n    x = _channelMap[x];\r\n    if (typeof x == 'undefined') return this;\r\n    if (this.ff == 0x20) this.dd = String.fromCharCode(x);\r\n    else {\r\n      var c = this[0];\r\n      if (typeof c != 'undefined' && c >= 0x80 && c <= 0xef) this[0] = (c & 0xf0) | x;\r\n    }\r\n    return this;\r\n  };\r\n  MIDI.prototype.getNote = function() {\r\n    var c = this[0];\r\n    if (typeof c == 'undefined' || c < 0x80 || c > 0xaf) return;\r\n    return this[1];\r\n  };\r\n  MIDI.prototype.setNote = function(x) {\r\n    var c = this[0];\r\n    if (typeof c == 'undefined' || c < 0x80 || c > 0xaf) return this;\r\n    x = MIDI.noteValue(x);\r\n    if (typeof x != 'undefined') this[1] = x;\r\n    return this;\r\n  };\r\n  MIDI.prototype.getVelocity = function() {\r\n    var c = this[0];\r\n    if (typeof c == 'undefined' || c < 0x80 || c > 0x9f) return;\r\n    return this[2];\r\n  };\r\n  MIDI.prototype.setVelocity = function(x) {\r\n    var c = this[0];\r\n    if (typeof c == 'undefined' || c < 0x80 || c > 0x9f) return this;\r\n    x = parseInt(x);\r\n    if (x >= 0 && x < 128) this[2] = x;\r\n    return this;\r\n  };\r\n  MIDI.prototype.getSysExChannel = function() {\r\n    if (this[0] == 0xf0) return this[2];\r\n  };\r\n  MIDI.prototype.setSysExChannel = function(x) {\r\n    if (this[0] == 0xf0 && this.length > 2) {\r\n      x = parseInt(x);\r\n      if (x >= 0 && x < 128) this[2] = x;\r\n    }\r\n    return this;\r\n  };\r\n  MIDI.prototype.getData = function() {\r\n    if (typeof this.dd != 'undefined') return this.dd.toString();\r\n  };\r\n  MIDI.prototype.setData = function(dd) {\r\n    this.dd = _2s(dd);\r\n    return this;\r\n  };\r\n  MIDI.prototype.getText = function() {\r\n    if (typeof this.dd != 'undefined') return JZZ.lib.fromUTF8(this.dd);\r\n  };\r\n  MIDI.prototype.setText = function(dd) {\r\n    this.dd = JZZ.lib.toUTF8(dd);\r\n    return this;\r\n  };\r\n  MIDI.prototype.getTempo = function() {\r\n    if (this.ff == 0x51 && typeof this.dd != 'undefined') {\r\n      return this.dd.charCodeAt(0) * 65536 + this.dd.charCodeAt(1) * 256 + this.dd.charCodeAt(2);\r\n    }\r\n  };\r\n  MIDI.prototype.getBPM = function() {\r\n    var ms = this.getTempo();\r\n    if (ms) return 60000000 / ms;\r\n  };\r\n  MIDI.prototype.getTimeSignature = function() {\r\n    if (this.ff == 0x58 && typeof this.dd != 'undefined') {\r\n       return [this.dd.charCodeAt(0), 1 << this.dd.charCodeAt(1)];\r\n    }\r\n  };\r\n  MIDI.prototype.getKeySignature = function() {\r\n    if (this.ff == 0x59 && typeof this.dd != 'undefined') {\r\n      var sf = this.dd.charCodeAt(0);\r\n      var mi = this.dd.charCodeAt(1);\r\n      if (sf & 0x80) sf = sf - 0x100;\r\n      if (sf >= -7 && sf <= 7 && mi >= 0 && mi <= 1) {\r\n        return [sf,\r\n          ['Cb', 'Gb', 'Db', 'Ab', 'Eb', 'Bb', 'F', 'C', 'G', 'D', 'A', 'E', 'B', 'F#', 'C#', 'G#', 'D#', 'A#'][mi ? sf + 10 : sf + 7],\r\n          !!mi\r\n        ];\r\n      }\r\n    }\r\n  };\r\n\r\n  MIDI.prototype.isNoteOn = function() {\r\n    var c = this[0];\r\n    if (typeof c == 'undefined' || c < 0x90 || c > 0x9f) return false;\r\n    return this[2] > 0 ? true : false;\r\n  };\r\n  MIDI.prototype.isNoteOff = function() {\r\n    var c = this[0];\r\n    if (typeof c == 'undefined' || c < 0x80 || c > 0x9f) return false;\r\n    if (c < 0x90) return true;\r\n    return this[2] == 0 ? true : false;\r\n  };\r\n  MIDI.prototype.isSysEx = function() {\r\n    return this[0] == 0xf0;\r\n  };\r\n  MIDI.prototype.isFullSysEx = function() {\r\n    return this[0] == 0xf0 && this[this.length - 1] == 0xf7;\r\n  };\r\n  MIDI.prototype.isSMF = function() {\r\n    return this.ff >= 0 && this.ff <= 0x7f;\r\n  };\r\n  MIDI.prototype.isEOT = function() {\r\n    return this.ff == 0x2f;\r\n  };\r\n  MIDI.prototype.isTempo = function() {\r\n    return this.ff == 0x51;\r\n  };\r\n  MIDI.prototype.isTimeSignature = function() {\r\n    return this.ff == 0x58;\r\n  };\r\n  MIDI.prototype.isKeySignature = function() {\r\n    return this.ff == 0x59;\r\n  };\r\n\r\n  function _s2a(x) {\r\n    var a = [];\r\n    for (var i = 0; i < x.length; i++) {\r\n      a[i] = x.charCodeAt(i);\r\n    }\r\n    return a;\r\n  }\r\n  function _a2s(x) {\r\n    var a = '';\r\n    for (var i = 0; i < x.length; i++) {\r\n      a += String.fromCharCode(x[i]);\r\n    }\r\n    return a;\r\n  }\r\n  function _2s(x) {\r\n    return x instanceof Array ? _a2s(x) : typeof x == 'undefined' ? '' : '' + x;\r\n  }\r\n  function _s2n(x) {\r\n    var n = 0;\r\n    for (var i = 0; i < x.length; i++) n = (n << 8) + x.charCodeAt(i);\r\n    return n;\r\n  }\r\n\r\n  function __hex(x) { return (x < 16 ? '0' : '') + x.toString(16); }\r\n  function _hex(x) {\r\n    var a = [];\r\n    for (var i = 0; i < x.length; i++) {\r\n      a[i] = __hex(x[i]);\r\n    }\r\n    return a.join(' ');\r\n  }\r\n  function _toLine(s) {\r\n    var out = '';\r\n    for (var i = 0; i < s.length; i++) {\r\n      if (s[i] == '\\n') out += '\\\\n';\r\n      else if (s[i] == '\\r') out += '\\\\r';\r\n      else if (s[i] == '\\t') out += '\\\\t';\r\n      else if (s.charCodeAt(i) < 32) out += '\\\\x' + __hex(s.charCodeAt(i));\r\n      else out += s[i];\r\n    }\r\n    return out;\r\n  }\r\n  function _smfhex(dd) {\r\n    return dd.length ? ': ' + _hex(_s2a(dd)) : '';\r\n  }\r\n  function _smftxt(dd) {\r\n    return dd.length ? ': ' + _toLine(JZZ.lib.fromUTF8(dd)) : '';\r\n  }\r\n  MIDI.prototype.toString = function() {\r\n    var s;\r\n    var ss;\r\n    if (!this.length) {\r\n      if (typeof this.ff != 'undefined') {\r\n        s = 'ff' + __hex(this.ff) + ' -- ';\r\n        if (this.ff == 0) s += 'Sequence Number: ' + _s2n(this.dd);\r\n        else if (this.ff > 0 && this.ff < 10) s += ['', 'Text', 'Copyright', 'Sequence Name', 'Instrument Name', 'Lyric', 'Marker', 'Cue Point', 'Program Name', 'Device Name'][this.ff] + _smftxt(this.dd);\r\n        else if (this.ff == 32) s += 'Channel Prefix' + _smfhex(this.dd);\r\n        else if (this.ff == 33) s += 'MIDI Port' + _smfhex(this.dd);\r\n        else if (this.ff == 47) s += 'End of Track' + _smfhex(this.dd);\r\n        else if (this.ff == 81) {\r\n          var bpm = Math.round(this.getBPM() * 100) / 100;\r\n          s += 'Tempo: ' + bpm + ' bpm';\r\n        }\r\n        else if (this.ff == 84) s += 'SMPTE Offset: ' + _smptetxt(_s2a(this.dd));\r\n        else if (this.ff == 88) {\r\n          var d = 1 << this.dd.charCodeAt(1);\r\n          s += 'Time Signature: ' + this.dd.charCodeAt(0) + '/' + d;\r\n          s += ' ' + this.dd.charCodeAt(2) + ' ' + this.dd.charCodeAt(3);\r\n        }\r\n        else if (this.ff == 89) {\r\n          s += 'Key Signature: ';\r\n          var ks = this.getKeySignature();\r\n          if (ks) {\r\n            s += ks[1];\r\n            if (ks[2]) s += ' min';\r\n          }\r\n          else s+= 'invalid';\r\n        }\r\n        else if (this.ff == 127) s += 'Sequencer Specific' + _smfhex(this.dd);\r\n        else s += 'SMF' + _smfhex(this.dd);\r\n        return s;\r\n      }\r\n      return 'empty';\r\n    }\r\n    s = _hex(this);\r\n    if (this[0] < 0x80) return s;\r\n    ss = {\r\n      241: 'MIDI Time Code',\r\n      242: 'Song Position',\r\n      243: 'Song Select',\r\n      244: 'Undefined',\r\n      245: 'Undefined',\r\n      246: 'Tune request',\r\n      248: 'Timing clock',\r\n      249: 'Undefined',\r\n      250: 'Start',\r\n      251: 'Continue',\r\n      252: 'Stop',\r\n      253: 'Undefined',\r\n      254: 'Active Sensing',\r\n      255: 'Reset'\r\n    }[this[0]];\r\n    if (ss) return s + ' -- ' + ss;\r\n    var c = this[0] >> 4;\r\n    ss = {8: 'Note Off', 10: 'Aftertouch', 12: 'Program Change', 13: 'Channel Aftertouch', 14: 'Pitch Wheel'}[c];\r\n    if (ss) return s + ' -- ' + ss;\r\n    if (c == 9) return s + ' -- ' + (this[2] ? 'Note On' : 'Note Off');\r\n    if (c != 11) return s;\r\n    ss = {\r\n      0: 'Bank Select MSB',\r\n      1: 'Modulation Wheel MSB',\r\n      2: 'Breath Controller MSB',\r\n      4: 'Foot Controller MSB',\r\n      5: 'Portamento Time MSB',\r\n      6: 'Data Entry MSB',\r\n      7: 'Channel Volume MSB',\r\n      8: 'Balance MSB',\r\n      10: 'Pan MSB',\r\n      11: 'Expression Controller MSB',\r\n      12: 'Effect Control 1 MSB',\r\n      13: 'Effect Control 2 MSB',\r\n      16: 'General Purpose Controller 1 MSB',\r\n      17: 'General Purpose Controller 2 MSB',\r\n      18: 'General Purpose Controller 3 MSB',\r\n      19: 'General Purpose Controller 4 MSB',\r\n      32: 'Bank Select LSB',\r\n      33: 'Modulation Wheel LSB',\r\n      34: 'Breath Controller LSB',\r\n      36: 'Foot Controller LSB',\r\n      37: 'Portamento Time LSB',\r\n      38: 'Data Entry LSB',\r\n      39: 'Channel Volume LSB',\r\n      40: 'Balance LSB',\r\n      42: 'Pan LSB',\r\n      43: 'Expression Controller LSB',\r\n      44: 'Effect control 1 LSB',\r\n      45: 'Effect control 2 LSB',\r\n      48: 'General Purpose Controller 1 LSB',\r\n      49: 'General Purpose Controller 2 LSB',\r\n      50: 'General Purpose Controller 3 LSB',\r\n      51: 'General Purpose Controller 4 LSB',\r\n      64: 'Damper Pedal On/Off',\r\n      65: 'Portamento On/Off',\r\n      66: 'Sostenuto On/Off',\r\n      67: 'Soft Pedal On/Off',\r\n      68: 'Legato Footswitch',\r\n      69: 'Hold 2',\r\n      70: 'Sound Controller 1',\r\n      71: 'Sound Controller 2',\r\n      72: 'Sound Controller 3',\r\n      73: 'Sound Controller 4',\r\n      74: 'Sound Controller 5',\r\n      75: 'Sound Controller 6',\r\n      76: 'Sound Controller 7',\r\n      77: 'Sound Controller 8',\r\n      78: 'Sound Controller 9',\r\n      79: 'Sound Controller 10',\r\n      80: 'General Purpose Controller 5',\r\n      81: 'General Purpose Controller 6',\r\n      82: 'General Purpose Controller 7',\r\n      83: 'General Purpose Controller 8',\r\n      84: 'Portamento Control',\r\n      88: 'High Resolution Velocity Prefix',\r\n      91: 'Effects 1 Depth',\r\n      92: 'Effects 2 Depth',\r\n      93: 'Effects 3 Depth',\r\n      94: 'Effects 4 Depth',\r\n      95: 'Effects 5 Depth',\r\n      96: 'Data Increment',\r\n      97: 'Data Decrement',\r\n      98: 'Non-Registered Parameter Number LSB',\r\n      99: 'Non-Registered Parameter Number MSB',\r\n      100: 'Registered Parameter Number LSB',\r\n      101: 'Registered Parameter Number MSB',\r\n      120: 'All Sound Off',\r\n      121: 'Reset All Controllers',\r\n      122: 'Local Control On/Off',\r\n      123: 'All Notes Off',\r\n      124: 'Omni Mode Off',\r\n      125: 'Omni Mode On',\r\n      126: 'Mono Mode On',\r\n      127: 'Poly Mode On'\r\n    }[this[1]];\r\n    if (!ss) ss = 'Undefined';\r\n    return s + ' -- ' + ss;\r\n  };\r\n  MIDI.prototype._stamp = function(obj) { this._from.push(obj._orig ? obj._orig : obj); return this; };\r\n  MIDI.prototype._unstamp = function(obj) {\r\n    if (typeof obj == 'undefined') this._from = [];\r\n    else {\r\n      if (obj._orig) obj = obj._orig;\r\n      var i = this._from.indexOf(obj);\r\n      if (i > -1) this._from.splice(i, 1);\r\n    }\r\n    return this;\r\n  };\r\n  MIDI.prototype._stamped = function(obj) {\r\n    if (obj._orig) obj = obj._orig;\r\n    for (var i = 0; i < this._from.length; i++) if (this._from[i] == obj) return true;\r\n    return false;\r\n  };\r\n\r\n  JZZ.MIDI = MIDI;\r\n\r\n  function MPE() {\r\n    var self = this instanceof MPE ? this : self = new MPE();\r\n    self.reset();\r\n    if (arguments.length) MPE.prototype.setup.apply(self, arguments);\r\n    return self;\r\n  }\r\n  MPE.validate = function(arg) {\r\n    var a = arg instanceof Array ? arg : arguments;\r\n    if (a[0] != parseInt(a[0]) || a[0] < 0 || a[0] > 14) throw RangeError('Bad master channel value: ' + a[0]);\r\n    if (a[1] != parseInt(a[1]) || a[1] < 0 || a[0] + a[1] > 15) throw RangeError('Bad zone size value: ' + a[1]);\r\n  };\r\n  MPE.prototype.reset = function() { for (var n = 0; n < 16; n++) this[n] = { band: 0, master: n }; };\r\n  MPE.prototype.setup = function(m, n) {\r\n    MPE.validate(m, n);\r\n    var k;\r\n    var last = m + n;\r\n    if (this[m].master == m && this[m].band == n) return;\r\n    if (!n && !this[m].band) return;\r\n    if (this[m].band) {\r\n      k = m + this[m].band;\r\n      if (last < k) last = k;\r\n    }\r\n    else if (this[m].master == m - 1) {\r\n      k = m - 1;\r\n      k = k + this[k].band;\r\n      if (last < k) last = k;\r\n      this[m - 1] = { band: 0, master: m - 1 };\r\n    }\r\n    else if (this[m].master != m) {\r\n      k = this[m].master;\r\n      k = k + this[k].band;\r\n      if (last < k) last = k;\r\n      this[this[m].master].band = m - this[m].master - 1;\r\n    }\r\n    this[m].master = m;\r\n    this[m].band = n;\r\n    for (k = m + 1; k <= m + n; k++) {\r\n      if (this[k].band && last < k + this[k].band) last = k + this[k].band;\r\n      this[k] = { band: 0, master: m };\r\n    }\r\n    for (; k <= last; k++) this[k] = { band: 0, master: k };\r\n  };\r\n  MPE.prototype.filter = function(msg) {\r\n    var c = msg.getChannel();\r\n    if (!this[c] || !this[this[c].master].band) return msg;\r\n    var m = this[c].master;\r\n    var n = this[m].band;\r\n    var i, j, k;\r\n    if (typeof msg._mpe != 'undefined') {\r\n      k = 256;\r\n      for (i = m + 1; i <= m + n; i++) {\r\n        if (!this[i].notes) {\r\n          if (k > 0) { c = i; k = 0; }\r\n        }\r\n        else {\r\n          if (k > this[i].notes.length) { c = i; k = this[i].notes.length; }\r\n          for (j = 0; j < this[i].notes.length; j++) {\r\n            if (this[i].notes[j] == msg._mpe) { c = i; k = -1; break; }\r\n          }\r\n        }\r\n      }\r\n      msg.setChannel(c);\r\n      msg._mpe = undefined;\r\n    }\r\n    if (c == m) return msg; // bad mpe\r\n    if (msg.isNoteOn()) {\r\n      if (!this[c].notes) this[c].notes = [];\r\n      _push(this[c].notes, msg.getNote());\r\n    }\r\n    else if (msg.isNoteOff()) {\r\n      if (this[c].notes) _pop(this[c].notes, msg.getNote());\r\n    }\r\n    return msg;\r\n  };\r\n  JZZ.MPE = MPE;\r\n\r\n  JZZ.lib = {};\r\n  JZZ.lib.now = _now;\r\n  JZZ.lib.schedule = _schedule;\r\n  JZZ.lib.openMidiOut = function(name, engine) {\r\n    var port = new _M();\r\n    engine._openOut(port);\r\n    port._info = engine._info(name);\r\n    return port;\r\n  };\r\n  JZZ.lib.openMidiIn = function(name, engine) {\r\n    var port = new _M();\r\n    engine._openIn(port);\r\n    port._info = engine._info(name);\r\n    return port;\r\n  };\r\n  JZZ.lib.registerMidiOut = function(name, engine) {\r\n    var x = engine._info(name);\r\n    for (var i = 0; i < _virtual._outs.length; i++) if (_virtual._outs[i].name == x.name) return false;\r\n    x.engine = engine;\r\n    _virtual._outs.push(x);\r\n    if (_jzz) {\r\n      _postRefresh();\r\n      if (_jzz._bad) { _jzz._repair(); _jzz._resume(); }\r\n    }\r\n    return true;\r\n  };\r\n  JZZ.lib.registerMidiIn = function(name, engine) {\r\n    var x = engine._info(name);\r\n    for (var i = 0; i < _virtual._ins.length; i++) if (_virtual._ins[i].name == x.name) return false;\r\n    x.engine = engine;\r\n    _virtual._ins.push(x);\r\n    if (_jzz) {\r\n      _postRefresh();\r\n      if (_jzz._bad) { _jzz._repair(); _jzz._resume(); }\r\n    }\r\n    return true;\r\n  };\r\n  var _ac;\r\n  function _initAudioContext() {\r\n    if (!_ac && typeof window !== 'undefined') {\r\n      var AudioContext = window.AudioContext || window.webkitAudioContext;\r\n      if (AudioContext) {\r\n        _ac = new AudioContext();\r\n        if (_ac && !_ac.createGain) _ac.createGain = _ac.createGainNode;\r\n        var _activateAudioContext = function() {\r\n          if (_ac.state != 'running') {\r\n            _ac.resume();\r\n            var osc = _ac.createOscillator();\r\n            var gain = _ac.createGain();\r\n            try { gain.gain.value = 0; } catch (err) {}\r\n            gain.gain.setTargetAtTime(0, _ac.currentTime, 0.01);\r\n            osc.connect(gain);\r\n            gain.connect(_ac.destination);\r\n            if (!osc.start) osc.start = osc.noteOn;\r\n            if (!osc.stop) osc.stop = osc.noteOff;\r\n            osc.start(0.1); osc.stop(0.11);\r\n          }\r\n          else {\r\n            document.removeEventListener('touchstart', _activateAudioContext);\r\n            document.removeEventListener('touchend', _activateAudioContext);\r\n            document.removeEventListener('mousedown', _activateAudioContext);\r\n            document.removeEventListener('keydown', _activateAudioContext);\r\n          }\r\n        };\r\n        document.addEventListener('touchstart', _activateAudioContext);\r\n        document.addEventListener('touchend', _activateAudioContext);\r\n        document.addEventListener('mousedown', _activateAudioContext);\r\n        document.addEventListener('keydown', _activateAudioContext);\r\n        _activateAudioContext();\r\n      }\r\n    }\r\n  }\r\n  JZZ.lib.copyMidiHelpers = _copyMidiHelpers;\r\n  JZZ.lib.getAudioContext = function() { _initAudioContext(); return _ac; };\r\n  var _b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\r\n  JZZ.lib.fromBase64 = function(input) {\r\n    var output = '';\r\n    var chr1, chr2, chr3;\r\n    var enc1, enc2, enc3, enc4;\r\n    var i = 0;\r\n    input = input.replace(/[^A-Za-z0-9+/=]/g, '');\r\n    while (i < input.length) {\r\n      enc1 = _b64.indexOf(input.charAt(i++));\r\n      enc2 = _b64.indexOf(input.charAt(i++));\r\n      enc3 = _b64.indexOf(input.charAt(i++));\r\n      enc4 = _b64.indexOf(input.charAt(i++));\r\n      chr1 = (enc1 << 2) | (enc2 >> 4);\r\n      chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\r\n      chr3 = ((enc3 & 3) << 6) | enc4;\r\n      output = output + String.fromCharCode(chr1);\r\n      if (enc3 != 64) {\r\n        output = output + String.fromCharCode(chr2);\r\n      }\r\n      if (enc4 != 64) {\r\n        output = output + String.fromCharCode(chr3);\r\n      }\r\n    }\r\n    return output;\r\n  };\r\n  JZZ.lib.toBase64 = function(data) {\r\n    var o1, o2, o3, h1, h2, h3, h4, bits, i = 0, ac = 0, enc = '', arr = [];\r\n    if (!data) return data;\r\n    do {\r\n      o1 = data.charCodeAt(i++);\r\n      o2 = data.charCodeAt(i++);\r\n      o3 = data.charCodeAt(i++);\r\n      bits = o1 << 16 | o2 << 8 | o3;\r\n      h1 = bits >> 18 & 0x3f;\r\n      h2 = bits >> 12 & 0x3f;\r\n      h3 = bits >> 6 & 0x3f;\r\n      h4 = bits & 0x3f;\r\n      arr[ac++] = _b64.charAt(h1) + _b64.charAt(h2) + _b64.charAt(h3) + _b64.charAt(h4);\r\n    } while(i < data.length);\r\n    enc = arr.join('');\r\n    var r = data.length % 3;\r\n    return (r ? enc.slice(0, r - 3) + '==='.slice(r) : enc);\r\n  };\r\n  JZZ.lib.fromUTF8 = function(data) {\r\n    data = typeof data == 'undefined' ? '' : '' + data;\r\n    var out = '';\r\n    var i, n, m;\r\n    for (i = 0; i < data.length; i++) {\r\n      n = data.charCodeAt(i);\r\n      if (n > 0xff) return data;\r\n      if (n < 0x80) out += data[i];\r\n      else if ((n & 0xe0) == 0xc0) {\r\n        n = (n & 0x1f) << 6;\r\n        i++; if (i >= data.length) return data;\r\n        m = data.charCodeAt(i);\r\n        if ((m & 0xc0) != 0x80) return data;\r\n        n += (m & 0x3f);\r\n        out += String.fromCharCode(n);\r\n      }\r\n      else if ((n & 0xf0) == 0xe0) {\r\n        n = (n & 0x0f) << 12;\r\n        i++; if (i >= data.length) return data;\r\n        m = data.charCodeAt(i);\r\n        if ((m & 0xc0) != 0x80) return data;\r\n        n += (m & 0x3f) << 6;\r\n        i++; if (i >= data.length) return data;\r\n        m = data.charCodeAt(i);\r\n        if ((m & 0xc0) != 0x80) return data;\r\n        n += (m & 0x3f);\r\n        out += String.fromCharCode(n);\r\n      }\r\n      else if ((n & 0xf8) == 0xf0) {\r\n        n = (n & 0x07) << 18;\r\n        i++; if (i >= data.length) return data;\r\n        m = data.charCodeAt(i);\r\n        if ((m & 0xc0) != 0x80) return data;\r\n        n += (m & 0x3f) << 12;\r\n        i++; if (i >= data.length) return data;\r\n        m = data.charCodeAt(i);\r\n        if ((m & 0xc0) != 0x80) return data;\r\n        n += (m & 0x3f) << 6;\r\n        i++; if (i >= data.length) return data;\r\n        m = data.charCodeAt(i);\r\n        if ((m & 0xc0) != 0x80) return data;\r\n        n += (m & 0x3f);\r\n        if (n > 0x10ffff) return data;\r\n        n -= 0x10000;\r\n        out += String.fromCharCode(0xd800 + (n >> 10));\r\n        out += String.fromCharCode(0xdc00 + (n & 0x3ff));\r\n      }\r\n    }\r\n    return out;\r\n  };\r\n  JZZ.lib.toUTF8 = function(data) {\r\n    data = typeof data == 'undefined' ? '' : '' + data;\r\n    var out = '';\r\n    var i, n;\r\n    for (i = 0; i < data.length; i++) {\r\n      n = data.charCodeAt(i);\r\n      if (n < 0x80) out += data[i];\r\n      else if (n < 0x800) {\r\n        out += String.fromCharCode(0xc0 + (n >> 6));\r\n        out += String.fromCharCode(0x80 + (n & 0x3f));\r\n      }\r\n      else if (n < 0x10000) {\r\n        out += String.fromCharCode(0xe0 + (n >> 12));\r\n        out += String.fromCharCode(0x80 + ((n >> 6) & 0x3f));\r\n        out += String.fromCharCode(0x80 + (n & 0x3f));\r\n      }\r\n      else {\r\n        out += String.fromCharCode(0xf0 + (n >> 18));\r\n        out += String.fromCharCode(0x80 + ((n >> 12) & 0x3f));\r\n        out += String.fromCharCode(0x80 + ((n >> 6) & 0x3f));\r\n        out += String.fromCharCode(0x80 + (n & 0x3f));\r\n      }\r\n    }\r\n    return out;\r\n  };\r\n\r\n  // Web MIDI API\r\n  var _wma = [];\r\n  var _outputMap = {};\r\n  var _inputMap = {};\r\n\r\n  var Promise = _scope.Promise;\r\n  if (typeof Promise !== 'function') {\r\n    Promise = function(executor) {\r\n      this.executor = executor;\r\n    };\r\n    Promise.prototype.then = function(resolve, reject) {\r\n      if (typeof resolve !== 'function') {\r\n        resolve = function() {};\r\n      }\r\n      if (typeof reject !== 'function') {\r\n        reject = function() {};\r\n      }\r\n      this.executor(resolve, reject);\r\n    };\r\n  }\r\n  function DOMException(name, message, code) {\r\n    this.name = name;\r\n    this.message = message;\r\n    this.code = code;\r\n  }\r\n\r\n  function MIDIConnectionEvent(port, target) {\r\n    this.bubbles = false;\r\n    this.cancelBubble = false;\r\n    this.cancelable = false;\r\n    this.currentTarget = target;\r\n    this.defaultPrevented = false;\r\n    this.eventPhase = 0;\r\n    this.path = [];\r\n    this.port = port;\r\n    this.returnValue = true;\r\n    this.srcElement = target;\r\n    this.target = target;\r\n    this.timeStamp = _now();\r\n    this.type = 'statechange';\r\n  }\r\n\r\n  function MIDIMessageEvent(port, data) {\r\n    this.bubbles = false;\r\n    this.cancelBubble = false;\r\n    this.cancelable = false;\r\n    this.currentTarget = port;\r\n    this.data = data;\r\n    this.defaultPrevented = false;\r\n    this.eventPhase = 0;\r\n    this.path = [];\r\n    this.receivedTime = _now();\r\n    this.returnValue = true;\r\n    this.srcElement = port;\r\n    this.target = port;\r\n    this.timeStamp = this.receivedTime;\r\n    this.type = 'midimessage';\r\n  }\r\n\r\n  function _statechange(p, a) {\r\n    if (p.onstatechange) p.onstatechange(new MIDIConnectionEvent(p, p));\r\n    if (a.onstatechange) a.onstatechange(new MIDIConnectionEvent(p, a));\r\n  }\r\n\r\n  function MIDIInput(a, p) {\r\n    var self = this;\r\n    var _open = false;\r\n    var _ochng = null;\r\n    var _onmsg = null;\r\n    this.type = 'input';\r\n    this.id = p.id;\r\n    this.name = p.name;\r\n    this.manufacturer = p.man;\r\n    this.version = p.ver;\r\n    Object.defineProperty(this, 'state', { get: function() { return p.connected ? 'connected' : 'disconnected'; }, enumerable: true });\r\n    Object.defineProperty(this, 'connection', { get: function() {\r\n      return _open ? p.proxy ? 'open' : 'pending' : 'closed';\r\n    }, enumerable: true });\r\n    Object.defineProperty(this, 'onmidimessage', {\r\n      get: function() { return _onmsg; },\r\n      set: function(value) {\r\n        if (value instanceof Function) {\r\n          _onmsg = value;\r\n          if (!_open) self.open();\r\n        }\r\n        else _onmsg = null;\r\n      },\r\n      enumerable: true\r\n    });\r\n    Object.defineProperty(this, 'onstatechange', {\r\n      get: function() { return _ochng; },\r\n      set: function(value) {\r\n        if (value instanceof Function) _ochng = value;\r\n        else _ochng = null;\r\n      },\r\n      enumerable: true\r\n    });\r\n    this.open = function() {\r\n      return new Promise(function(resolve, reject) {\r\n        if (_open) resolve(self);\r\n        else {\r\n          p.open().then(function() {\r\n            if (!_open) {\r\n              _open = true;\r\n              _statechange(self, a);\r\n            }\r\n            resolve(self);\r\n          }, function() {\r\n            reject(new DOMException('InvalidAccessError', 'Port is not available', 15));\r\n          });\r\n        }\r\n      });\r\n    };\r\n    this.close = function() {\r\n      return new Promise(function(resolve/*, reject*/) {\r\n        if (_open) {\r\n          _open = false;\r\n          p.close();\r\n          _statechange(self, a);\r\n        }\r\n        resolve(self);\r\n      });\r\n    };\r\n    Object.freeze(this);\r\n  }\r\n\r\n  function _split(q) {\r\n    var i, k;\r\n    while (q.length) {\r\n      for (i = 0; i < q.length; i++) if (q[i] == parseInt(q[i]) && q[i] >= 0x80 && q[i] <= 0xff && q[i] != 0xf7) break;\r\n      q.splice(0, i);\r\n      if (!q.length) return;\r\n      if (q[0] == 0xf0) {\r\n        for (i = 1; i < q.length; i++) if (q[i] == 0xf7) break;\r\n        if (i == q.length) return;\r\n        return q.splice(0, i + 1);\r\n      }\r\n      else {\r\n        k = _datalen(q[0]) + 1;\r\n        if (k > q.length) return;\r\n        for (i = 1; i < k; i++) if (q[i] != parseInt(q[i]) || q[i] < 0 || q[i] >= 0x80) break;\r\n        if (i == k) return q.splice(0, i);\r\n        else q.splice(0, i);\r\n      }\r\n    }\r\n  }\r\n\r\n  function _InputProxy(id, name, man, ver) {\r\n    var self = this;\r\n    this.id = id;\r\n    this.name = name;\r\n    this.man = man;\r\n    this.ver = ver;\r\n    this.connected = true;\r\n    this.ports = [];\r\n    this.pending = [];\r\n    this.proxy = undefined;\r\n    this.queue = [];\r\n    this.onmidi = function(msg) {\r\n      var m;\r\n      self.queue = self.queue.concat(msg.slice());\r\n      for (m = _split(self.queue); m; m = _split(self.queue)) {\r\n        for (i = 0; i < self.ports.length; i++) {\r\n          if (self.ports[i][0].onmidimessage && (m[0] != 0xf0 || self.ports[i][1])) {\r\n            self.ports[i][0].onmidimessage(new MIDIMessageEvent(self, new Uint8Array(m)));\r\n          }\r\n        }\r\n      }\r\n    };\r\n  }\r\n  _InputProxy.prototype.open = function() {\r\n    var self = this;\r\n    return new Promise(function(resolve, reject) {\r\n      var i;\r\n      if (self.proxy || !self.connected) resolve();\r\n      else {\r\n        self.pending.push([resolve, reject]);\r\n        if (self.pending.length == 1) {\r\n          JZZ().openMidiIn(self.name).or(function() {\r\n            for (i = 0; i < self.pending.length; i++) self.pending[i][1]();\r\n            self.pending = [];\r\n          }).and(function() {\r\n            self.proxy = this;\r\n            self.proxy.connect(self.onmidi);\r\n            for (i = 0; i < self.pending.length; i++) self.pending[i][0]();\r\n            self.pending = [];\r\n          });\r\n        }\r\n      }\r\n    });\r\n  };\r\n  _InputProxy.prototype.close = function() {\r\n    var i;\r\n    if (this.proxy) {\r\n      for (i = 0; i < this.ports.length; i++) if (this.ports[i].connection == 'open') return;\r\n      this.proxy.close();\r\n      this.proxy = undefined;\r\n    }\r\n  };\r\n  _InputProxy.prototype.disconnect = function() {\r\n    this.connected = false;\r\n    if (this.proxy) {\r\n      this.proxy.close();\r\n      this.proxy = undefined;\r\n    }\r\n  };\r\n  _InputProxy.prototype.reconnect = function() {\r\n    var self = this;\r\n    var i, p;\r\n    var a = [];\r\n    this.connected = true;\r\n    for (i = 0; i < _wma.length; i++) {\r\n      p = _wma[i].inputs.get(this.id);\r\n      if (p.connection == 'closed') _statechange(p, _wma[i]);\r\n      else a.push([p, _wma[i]]);\r\n    }\r\n    if (a.length) {\r\n      JZZ()._openMidiInNR(self.name).or(function() {\r\n        for (i = 0; i < a.length; i++) a[i][0].close();\r\n      }).and(function() {\r\n        self.proxy = this;\r\n        self.proxy.connect(self.onmidi);\r\n        for (i = 0; i < a.length; i++) _statechange(a[i][0], a[i][1]);\r\n      });\r\n    }\r\n  };\r\n\r\n  function _datalen(x) {\r\n    if (x >= 0x80 && x <= 0xbf || x >= 0xe0 && x <= 0xef || x == 0xf2) return 2;\r\n    if (x >= 0xc0 && x <= 0xdf || x == 0xf1 || x == 0xf3) return 1;\r\n    return 0;\r\n  }\r\n\r\n  var _epr = \"Failed to execute 'send' on 'MIDIOutput': \";\r\n\r\n  function _validate(arr, sysex) {\r\n    var i, k;\r\n    var msg;\r\n    var data = [];\r\n    for (i = 0; i < arr.length; i++) {\r\n      if (arr[i] != parseInt(arr[i]) || arr[i] < 0 || arr[i] > 255) throw TypeError(_epr + arr[i] + ' is not a UInt8 value.');\r\n    }\r\n    k = 0;\r\n    for (i = 0; i < arr.length; i++) {\r\n      if (!k) {\r\n        if (arr[i] < 0x80) throw TypeError(_epr + 'Running status is not allowed at index ' + i + ' (' + arr[i] + ').');\r\n        if (arr[i] == 0xf7) throw TypeError(_epr + 'Unexpected end of system exclusive message at index ' + i + ' (' + arr[i] + ').');\r\n        msg = [arr[i]];\r\n        data.push(msg);\r\n        if (arr[i] == 0xf0) {\r\n          if (!sysex) throw new DOMException('InvalidAccessError', _epr + 'System exclusive messag is not allowed at index ' + i + ' (' + arr[i] + ').', 15);\r\n          k = -1;\r\n          for (; i < arr.length; i++) {\r\n            msg.push(arr[i]);\r\n            if (arr[i] == 0xf7) {\r\n              k = 0;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        else {\r\n          k = _datalen(arr[i]);\r\n        }\r\n      }\r\n      else {\r\n        if (arr[i] > 0x7f) throw TypeError(_epr + 'Unexpected status byte at index ' + i + ' (' + arr[i] + ').');\r\n        msg.push(arr[i]);\r\n        k--;\r\n      }\r\n    }\r\n    if (k) throw TypeError(_epr + 'Message is incomplete');\r\n    return [data];\r\n  }\r\n\r\n  function MIDIOutput(a, p) {\r\n    var self = this;\r\n    var _open = false;\r\n    var _ochng = null;\r\n    this.type = 'output';\r\n    this.id = p.id;\r\n    this.name = p.name;\r\n    this.manufacturer = p.man;\r\n    this.version = p.ver;\r\n    Object.defineProperty(this, 'state', { get: function() { return p.connected ? 'connected' : 'disconnected'; }, enumerable: true });\r\n    Object.defineProperty(this, 'connection', { get: function() {\r\n      return _open ? p.proxy ? 'open' : 'pending' : 'closed';\r\n    }, enumerable: true });\r\n    Object.defineProperty(this, 'onstatechange', {\r\n      get: function() { return _ochng; },\r\n      set: function(value) {\r\n        if (value instanceof Function) _ochng = value;\r\n        else _ochng = null;\r\n      },\r\n      enumerable: true\r\n    });\r\n    this.open = function() {\r\n      return new Promise(function(resolve, reject) {\r\n        if (_open) resolve(self);\r\n        else {\r\n          p.open().then(function() {\r\n            if (!_open) {\r\n              _open = true;\r\n              _statechange(self, a);\r\n            }\r\n            resolve(self);\r\n          }, function() {\r\n            reject(new DOMException('InvalidAccessError', 'Port is not available', 15));\r\n          });\r\n        }\r\n      });\r\n    };\r\n    this.close = function() {\r\n      return new Promise(function(resolve/*, reject*/) {\r\n        if (_open) {\r\n          _open = false;\r\n          self.clear();\r\n          p.close();\r\n          _statechange(self, a);\r\n        }\r\n        resolve(self);\r\n      });\r\n    };\r\n    this.clear = function() {\r\n    };\r\n    this.send = function(data, timestamp) {\r\n      _validate(data, a.sysexEnabled);\r\n      if (!p.connected) throw new DOMException('InvalidStateError', 'Port is not connected', 11);\r\n      if (_open) {\r\n        var now = _now();\r\n        if (timestamp > now) setTimeout(function() { p.proxy.send(data); }, timestamp - now);\r\n        else p.proxy.send(data);\r\n      }\r\n      else this.open().then(function() { self.send(data, timestamp); });\r\n\r\n    };\r\n    Object.freeze(this);\r\n  }\r\n\r\n  function _OutputProxy(id, name, man, ver) {\r\n    this.id = id;\r\n    this.name = name;\r\n    this.man = man;\r\n    this.ver = ver;\r\n    this.connected = true;\r\n    this.ports = [];\r\n    this.pending = [];\r\n    this.proxy = undefined;\r\n  }\r\n  _OutputProxy.prototype.open = function() {\r\n    var self = this;\r\n    return new Promise(function(resolve, reject) {\r\n      var i;\r\n      if (self.proxy || !self.connected) resolve();\r\n      else {\r\n        self.pending.push([resolve, reject]);\r\n        if (self.pending.length == 1) {\r\n          JZZ().openMidiOut(self.name).or(function() {\r\n            for (i = 0; i < self.pending.length; i++) self.pending[i][1]();\r\n            self.pending = [];\r\n          }).and(function() {\r\n            self.proxy = this;\r\n            for (i = 0; i < self.pending.length; i++) self.pending[i][0]();\r\n            self.pending = [];\r\n          });\r\n        }\r\n      }\r\n    });\r\n  };\r\n  _OutputProxy.prototype.close = function() {\r\n    var i;\r\n    if (this.proxy) {\r\n      for (i = 0; i < this.ports.length; i++) if (this.ports[i].connection == 'open') return;\r\n      this.proxy.close();\r\n      this.proxy = undefined;\r\n    }\r\n  };\r\n  _OutputProxy.prototype.disconnect = function() {\r\n    this.connected = false;\r\n    if (this.proxy) {\r\n      this.proxy.close();\r\n      this.proxy = undefined;\r\n    }\r\n  };\r\n  _OutputProxy.prototype.reconnect = function() {\r\n    var self = this;\r\n    var i, p;\r\n    var a = [];\r\n    this.connected = true;\r\n    for (i = 0; i < _wma.length; i++) {\r\n      p = _wma[i].outputs.get(this.id);\r\n      if (p.connection == 'closed') _statechange(p, _wma[i]);\r\n      else a.push([p, _wma[i]]);\r\n    }\r\n    if (a.length) {\r\n      JZZ()._openMidiOutNR(self.name).or(function() {\r\n        for (i = 0; i < a.length; i++) a[i][0].close();\r\n      }).and(function() {\r\n        self.proxy = this;\r\n        for (i = 0; i < a.length; i++) _statechange(a[i][0], a[i][1]);\r\n      });\r\n    }\r\n  };\r\n\r\n  function _Maplike(data) {\r\n    this.has = function(id) {\r\n      return data.hasOwnProperty(id) && data[id].connected;\r\n    };\r\n    this.keys = function() {\r\n      try { // some old browsers may have no Map object\r\n        var m = new Map();\r\n        for (var id in data) if (this.has(id)) m.set(id, this.get(id));\r\n        return m.keys();\r\n      } catch (e) {}\r\n    };\r\n    this.values = function() {\r\n      try {\r\n        var m = new Map();\r\n        for (var id in data) if (this.has(id)) m.set(id, this.get(id));\r\n        return m.values();\r\n      } catch (e) {}\r\n    };\r\n    this.entries = function() {\r\n      try {\r\n        var m = new Map();\r\n        for (var id in data) if (this.has(id)) m.set(id, this.get(id));\r\n        return m.entries();\r\n      } catch (e) {}\r\n    };\r\n    this.forEach = function(fun, self) {\r\n      if (typeof self == 'undefined') self = this;\r\n      for (var id in data) if (this.has(id)) fun.call(self, this.get(id), id, this);\r\n    };\r\n    Object.defineProperty(this, 'size', {\r\n      get: function() {\r\n        var len = 0;\r\n        for (var id in data) if (this.has(id)) len++;\r\n        return len;\r\n      },\r\n      enumerable: true\r\n    });\r\n  }\r\n\r\n  function MIDIInputMap(_access, _inputs) {\r\n    this.get = function(id) {\r\n      if (_inputMap.hasOwnProperty(id) && _inputMap[id].connected) {\r\n        if (!_inputs[id]) {\r\n          _inputs[id] = new MIDIInput(_access, _inputMap[id]);\r\n          _inputMap[id].ports.push([_inputs[id], _access.sysexEnabled]);\r\n        }\r\n        return _inputs[id];\r\n      }\r\n    };\r\n    Object.freeze(this);\r\n  }\r\n  MIDIInputMap.prototype = new _Maplike(_inputMap);\r\n  MIDIInputMap.prototype.constructor = MIDIInputMap;\r\n\r\n  function MIDIOutputMap(_access, _outputs) {\r\n    this.get = function(id) {\r\n      if (_outputMap.hasOwnProperty(id) && _outputMap[id].connected) {\r\n        if (!_outputs[id]) {\r\n          _outputs[id] = new MIDIOutput(_access, _outputMap[id]);\r\n          _outputMap[id].ports.push([_outputs[id], _access.sysexEnabled]);\r\n        }\r\n        return _outputs[id];\r\n      }\r\n    };\r\n    Object.freeze(this);\r\n  }\r\n  MIDIOutputMap.prototype = new _Maplike(_outputMap);\r\n  MIDIOutputMap.prototype.constructor = MIDIOutputMap;\r\n\r\n  function _wm_watch(x) {\r\n    var i, k, p, a;\r\n    for (i = 0; i < x.inputs.added.length; i++) {\r\n      p = x.inputs.added[i];\r\n      if (!_inputMap.hasOwnProperty(p.id)) _inputMap[p.id] = new _InputProxy(p.id, p.name, p.manufacturer, p.version);\r\n      _inputMap[p.id].reconnect();\r\n    }\r\n    for (i = 0; i < x.outputs.added.length; i++) {\r\n      p = x.outputs.added[i];\r\n      if (!_outputMap.hasOwnProperty(p.id)) _outputMap[p.id] = new _OutputProxy(p.id, p.name, p.manufacturer, p.version);\r\n      _outputMap[p.id].reconnect();\r\n    }\r\n    for (i = 0; i < x.inputs.removed.length; i++) {\r\n      p = x.inputs.removed[i];\r\n      if (_inputMap.hasOwnProperty(p.id)) {\r\n        a = [];\r\n        for (k = 0; k < _wma.length; k++) a.push([_wma[k].inputs.get(p.id), _wma[k]]);\r\n        _inputMap[p.id].disconnect();\r\n        for (k = 0; k < a.length; k++) _statechange(a[k][0], a[k][1]);\r\n      }\r\n    }\r\n    for (i = 0; i < x.outputs.removed.length; i++) {\r\n      p = x.outputs.removed[i];\r\n      if (_outputMap.hasOwnProperty(p.id)) {\r\n        a = [];\r\n        for (k = 0; k < _wma.length; k++) a.push([_wma[k].outputs.get(p.id), _wma[k]]);\r\n        _outputMap[p.id].disconnect();\r\n        for (k = 0; k < a.length; k++) _statechange(a[k][0], a[k][1]);\r\n      }\r\n    }\r\n  }\r\n\r\n  function MIDIAccess(sysex) {\r\n    var _inputs = {};\r\n    var _outputs = {};\r\n    var _onstatechange = null;\r\n    var self = this;\r\n    this.sysexEnabled = sysex;\r\n    this.inputs = new MIDIInputMap(self, _inputs);\r\n    this.outputs = new MIDIOutputMap(self, _outputs);\r\n    Object.defineProperty(this, 'onstatechange', {\r\n      get: function() { return _onstatechange; },\r\n      set: function(f) { _onstatechange = f instanceof Function ? f : null; },\r\n      enumerable: true\r\n    });\r\n    Object.freeze(this);\r\n    var i;\r\n    var p;\r\n    var info = _jzz._info;\r\n    for (i = 0; i < info.inputs.length; i++) {\r\n      p = info.inputs[i];\r\n      if (!_inputMap.hasOwnProperty(p.id)) _inputMap[p.id] = new _InputProxy(p.id, p.name, p.manufacturer, p.version);\r\n    }\r\n    for (i = 0; i < info.outputs.length; i++) {\r\n      p = info.outputs[i];\r\n      if (!_outputMap.hasOwnProperty(p.id)) _outputMap[p.id] = new _OutputProxy(p.id, p.name, p.manufacturer, p.version);\r\n    }\r\n    if (!_wma.length) JZZ().onChange(_wm_watch);\r\n    _wma.push(this);\r\n  }\r\n\r\n  JZZ.requestMIDIAccess = function(opt) {\r\n    return new Promise(function(resolve, reject) {\r\n      JZZ.JZZ(opt).or(function() {\r\n      }).and(function() {\r\n        var sysex = !!(opt && opt.sysex);\r\n        if (sysex && !this.info().sysex) reject(new DOMException('SecurityError', 'Sysex is not allowed', 18));\r\n        else {\r\n          var wma = new MIDIAccess(sysex);\r\n          resolve(wma);\r\n        }\r\n      });\r\n    });\r\n  };\r\n  if (typeof navigator !== 'undefined' && !navigator.requestMIDIAccess) navigator.requestMIDIAccess = JZZ.requestMIDIAccess;\r\n  JZZ.close = function() { if (_engine._close) _engine._close(); };\r\n\r\n  return JZZ;\r\n});\r\n","!function(e,n){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=n():\"function\"==typeof define&&define.amd?define([],n):\"object\"==typeof exports?exports.MT=n():e.MT=n()}(window,(function(){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var i in e)t.d(r,i,function(n){return e[n]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p=\"/\",t(t.s=0)}([function(e,n,t){\"use strict\";t.r(n);var r=function(e,n,t){return Math.max(Math.min(e,Math.max(n,t)),Math.min(n,t))},i=function(e,n,t){var r,i=e;return i-=t*(r=Math.trunc(i/(t+1))),{value:i+=n-1,wraps:r}};function o(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}function a(e,n){if(!(e instanceof n))throw new TypeError(\"Cannot call a class as a function\")}function u(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var v=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;a(this,e),l(this,\"mTone\",0),l(this,\"mOctave\",0);var r=n,i=t;if(\"string\"==typeof n){var o=e.mParseName(n),u=o.tone,v=o.octave;r=u,i=v}this.tone(r),this.octave(i)}var n,t,v;return n=e,v=[{key:\"A4Tuning\",value:function(n){return n?(e.A4Tuning=n,e.A4Tuning):e.mA4Tuning}},{key:\"mParseName\",value:function(){var n,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",r=5,i=/(?:[A-G])|(?:(#|b)+)|([0-9]|10)/g,a=/(#|b)/g,u=/([0-9]|10)/g,l=o(t.matchAll(i));if(!l.length)throw new Error(\"Invalid Note Name Given\");var v=l.filter((function(e){return null!=e})),s=l[0].filter((function(e){return null!=e}));switch(s[0]){case\"A\":n=e.tones.A;break;case\"B\":n=e.tones.B;break;case\"C\":n=e.tones.C;break;case\"D\":n=e.tones.D;break;case\"E\":n=e.tones.E;break;case\"F\":n=e.tones.F;break;case\"G\":n=e.tones.G}for(var c=v.length,h=1;h<c;h++){var f=v[h],m=f.filter((function(e){return null!=e}));if(a.test(m[0])){var d=Array.from(m[0]);d.forEach((function(e){\"#\"===e?n++:\"b\"===e&&n--}))}else u.test(m[0])&&(r=Number(m[0]))}return{tone:n,octave:r}}},{key:\"A\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return new e(2,n)}},{key:\"B\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return new e(4,n)}},{key:\"C\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return new e(5,n)}},{key:\"D\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return new e(7,n)}},{key:\"E\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return new e(9,n)}},{key:\"F\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return new e(10,n)}},{key:\"G\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return new e(12,n)}}],(t=[{key:\"tone\",value:function(e){if(!e)return this.mTone;var n=i(e,1,12),t=n.value,o=n.wraps;return this.mTone=t,this.mOctave=r(this.mOctave+o,0,10),this}},{key:\"octave\",value:function(e){return e?(this.mOctave=r(e,0,10),this):this.mOctave}},{key:\"sharp\",value:function(){var e=i(this.mTone+1,1,12),n=e.value,t=e.wraps;return this.mTone=n,this.mOctave+=t,this}},{key:\"isSharp\",value:function(){return 1===this.mTone||3===this.mTone||6===this.mTone||8===this.mTone||11===this.mTone}},{key:\"flat\",value:function(){var e=i(this.mTone-1,1,12),n=e.value,t=e.wraps;return this.mTone=n,this.mOctave+=t,this}},{key:\"isFlat\",value:function(){return this.isSharp()}},{key:\"equals\",value:function(e){return e.tone()===this.mTone&&e.octave()===this.mOctave}},{key:\"copy\",value:function(){return new e(this.mTone,this.mOctave)}},{key:\"midiKey\",get:function(){var e=21+12*this.mOctave+(this.mTone-2);return e=r(e,0,127)}},{key:\"freq\",get:function(){return Math.pow(2,(this.midiKey-69)/12)*this.A4Tuning}},{key:\"asString\",get:function(){var n=\"\";switch(this.mTone){case e.tones.A:n=\"A\";break;case e.tones.A_SHARP:n=\"A#/Bb\";break;case e.tones.B:n=\"B\";break;case e.tones.C:n=\"C\";break;case e.tones.C_SHARP:n=\"C#/Db\";break;case e.tones.D:n=\"D\";break;case e.tones.D_SHARP:n=\"D#/Eb\";break;case e.tones.E:n=\"E\";break;case e.tones.F:n=\"F\";break;case e.tones.F_SHARP:n=\"F#/Gb\";break;case e.tones.G:n=\"G\";break;case e.tones.G_SHARP:n=\"G#/Ab\";break;default:n=\"A\"}return n}}])&&u(n.prototype,t),v&&u(n,v),e}();l(v,\"tones\",{G_SHARP:1,A_FLAT:v.G_SHARP,A:2,A_SHARP:3,B_FLAT:v.A_SHARP,B:4,C_FLAT:v.B,C:5,B_SHARP:v.C,C_SHARP:6,D_FLAT:v.C_SHARP,D:7,D_SHARP:8,E_FLAT:v.D_SHARP,E:9,F_FLAT:v.E,F:10,E_SHARP:v.F,F_SHARP:11,G_FLAT:v.F_SHARP,G:12,TOTAL_HALF_TONES:12}),l(v,\"modifier\",{NATURAL:0,SHARP:1,SHARP_SHARP:2,FLAT:-1,FLAT_FLAT:-2,TOTAL_MODIFIERS:5}),l(v,\"mA4Tuning\",440);var s=v;function c(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}function h(e,n){if(!(e instanceof n))throw new TypeError(\"Cannot call a class as a function\")}function f(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var d=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[2,2,1,2,2,2];h(this,e),m(this,\"mTemplate\",[]),m(this,\"mRootNote\",null),m(this,\"mNotes\",[]),this.root(n),this.template(t)}var n,t,r;return n=e,r=[{key:\"WholeTone\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,2,2,2,2])}},{key:\"Major\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,1,2,2,2])}},{key:\"Major7s4s5\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,2,2,1,2])}},{key:\"Minor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,2,2,1,2])}},{key:\"Minor7b9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,2,2,2,1])}},{key:\"Minor7b5\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,2,1,2,2])}},{key:\"HarmonicMajor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,1,2,1,3])}},{key:\"HarmonicMinor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,2,2,1,3])}},{key:\"MelodicMinorAscend\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,2,2,2,2])}},{key:\"MelodicMinorDescend\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,1,2,2,1])}},{key:\"EnigmaticMajor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,3,2,2,2,1])}},{key:\"EnigmaticMinor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,3,1,3,1])}},{key:\"PentatonicMajor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,3,2,3])}},{key:\"PentatonicMajorBlues\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,1,3,2])}},{key:\"PentatonicMinor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[3,2,2,3,2])}},{key:\"PentatonicMinorBlues\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[3,2,1,1,3])}},{key:\"b5Pentatonic\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[3,2,1,4,2])}},{key:\"Minor6Pentatonic\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[3,2,2,2,3])}},{key:\"Dim8Tone\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,2,1,2,1,2])}},{key:\"Dom8Tone\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,1,2,1,2,1])}},{key:\"NeopolitanMajor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,2,2,2,2])}},{key:\"NeopolitanMinor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,2,2,1,3])}},{key:\"HungarianMajor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[3,1,2,1,2,1])}},{key:\"HungarianMinor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,3,1,1,3])}},{key:\"HungarianGypsy\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,3,1,2,1,3])}},{key:\"Spanish\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,1,2,2,2])}},{key:\"SpanishGypsy\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,3,1,2,1,2])}},{key:\"Spanish8Tone\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,1,1,1,2,2])}},{key:\"Augmented\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[3,1,3,1,3,1])}},{key:\"DominantSuspended\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,3,2,2,1,2])}},{key:\"BebopMajor\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,1,2,1,1,2])}},{key:\"BebopDominant\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,1,2,2,1,1])}},{key:\"Mystic\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,2,3,2])}},{key:\"Overtone\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,2,1,1,2])}},{key:\"LeadingTone\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,2,2,2,1])}},{key:\"DoubleHarmonic\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,3,1,2,1,3])}},{key:\"Hirojoshi\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,4,1])}},{key:\"JapaneseA\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,4,1,3])}},{key:\"JapaneseB\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,3,1,3])}},{key:\"Oriental\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,3,1,1,3,1])}},{key:\"Persian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,4,1,2,3])}},{key:\"Arabian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,1,1,2,2])}},{key:\"Balinese\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,4,1])}},{key:\"Kumoi\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,4,2,2])}},{key:\"Pelog\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,3,1,1])}},{key:\"Algerian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,2,1,1,1,3])}},{key:\"Chinese\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[4,2,1,4])}},{key:\"Egyptian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,3,2,3])}},{key:\"Romanian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,3,1,2,1])}},{key:\"Hindu\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,1,2,1,2])}},{key:\"Insen\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,4,2,3])}},{key:\"Iwato\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,4,1,4])}},{key:\"Scottish\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,3,2,2])}},{key:\"Yo\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[3,2,2,3])}},{key:\"Mongolian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,3,2])}},{key:\"Istrian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,2,2,1,2])}},{key:\"UkranianDorian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,3,1,2,1])}},{key:\"Petrushka\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,3,2,1,3])}},{key:\"Dorian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,1,2,2,2,1])}},{key:\"Phrygian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,2,2,1,2])}},{key:\"Lydian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,2,1,2,2])}},{key:\"LydianDominate\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,2,1,2,1])}},{key:\"Mixolydian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,1,2,2,1])}},{key:\"MixolydianFlat6\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[2,2,1,2,1,2])}},{key:\"Locrian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,2,1,2,2])}},{key:\"SuperLocrian\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,2,1,2,2,2])}},{key:\"AhavaRaba\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[1,3,1,2,1,2])}}],(t=[{key:\"root\",value:function(e){return e?(this.mRootNote=e,this.mComputeNotes(),this):this.mRootNote}},{key:\"template\",value:function(e){return e?(this.mTemplate=e,this.mComputeNotes(),this):this.mTemplate}},{key:\"degree\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0===e)return this.mRootNote;var n=i(e,1,this.mNotes.length),t=n.value,r=n.wraps,o=this.mNotes[t-1];return new s(o.tone(),o.octave()+r)}},{key:\"relativeMajor\",value:function(){return new e(this.degree(3),[2,2,1,2,2,2])}},{key:\"relativeMinor\",value:function(){return new e(this.degree(6),[2,1,2,2,1,2])}},{key:\"ionianMode\",value:function(){return e.Major(this.mRootNote)}},{key:\"dorianMode\",value:function(){return e.Dorian(this.degree(2))}},{key:\"phrygianMode\",value:function(){return e.Phrygian(this.degree(3))}},{key:\"lydianMode\",value:function(){return e.Lydian(this.degree(4))}},{key:\"mixolydianMode\",value:function(){return e.Mixolydian(this.degree(5))}},{key:\"aeolianMode\",value:function(){return e.Aeolian(this.degree(6))}},{key:\"locrianMode\",value:function(){return e.Locrian(this.degree(7))}},{key:\"parallelMode\",value:function(n){if(!(n>=e.modes.IONIAN&&n<=e.modes.LOCRIAN))throw new Error(\"Invalid scale mode given\");switch(n){case e.modes.IONIAN:this.template([2,2,1,2,2,2]);break;case e.modes.LYDIAN:this.template([2,2,2,1,2,2]);break;case e.modes.MIXOLYDIAN:this.template([2,2,1,2,2,1]);break;case e.modes.DORIAN:this.template([2,1,2,2,2,1]);break;case e.modes.AEOLIAN:this.template([2,1,2,2,1,2]);break;case e.modes.PHRYGIAN:this.template([1,2,2,2,1,2]);break;case e.modes.LOCRIAN:this.template([1,2,2,1,2,2])}return this}},{key:\"mTemplateDegreeIndex\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=i(e-1,1,this.mNotes.length),t=n.value;return t-1}},{key:\"mComputeNotes\",value:function(){this.mNotes=[],this.mNotes.push(this.mRootNote);var e,n=this.mRootNote.tone(),t=this.mRootNote.octave();for(e=0;e<this.mTemplate.length;e++)n+=this.mTemplate[e],this.mNotes.push(new s(n,t))}},{key:\"equals\",value:function(e){return e.root()===this.root()&&e.template()===this.template()}},{key:\"copy\",value:function(){return new e(this.mRootNote,c(this.mTemplate))}},{key:\"length\",get:function(){return this.mNotes.length}},{key:\"notes\",get:function(){return this.mNotes}},{key:\"key\",get:function(){return this.mRootNote}},{key:\"asString\",get:function(){var e=\"Scale: \";return this.mNotes.forEach((function(n){e+=\"\".concat(n.asString,\" \")})),e}}])&&f(n.prototype,t),r&&f(n,r),e}();m(d,\"modes\",{IONIAN:1,LYDIAN:2,MIXOLYDIAN:3,DORIAN:4,AEOLIAN:5,PHRYGIAN:6,LOCRIAN:7,TOTAL_MODES:7}),m(d,\"HalfDim\",d.Minor7b5),m(d,\"Jewish\",d.Spanish8Tone),m(d,\"Byzantine\",d.DoubleHarmonic),m(d,\"Acoustic\",d.LydianDominate),m(d,\"Aeolian\",d.Minor);var w=d;function y(e,n){if(!(e instanceof n))throw new TypeError(\"Cannot call a class as a function\")}function g(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;y(this,e),this.interval=n,this.modifier=r(t,-2,2)}var n,t,i;return n=e,i=[{key:\"create\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new e(n,t)}}],(t=null)&&g(n.prototype,t),i&&g(n,i),e}();function A(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}function p(e,n){if(!(e instanceof n))throw new TypeError(\"Cannot call a class as a function\")}function T(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var L=k.create,F=s.modifier,S=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[L(1),L(3),L(5)],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new w;p(this,e),b(this,\"mRootnote\",null),b(this,\"mTemplate\",[]),b(this,\"mScale\",null),b(this,\"mNotes\",[]);var i=n,o=t;if(\"string\"==typeof n){var a=e.mParseName(n),u=a.root,l=a.template;i=new s(u),o=l}this.mScale=r,this.mTemplate=o,this.root(i)}var n,t,r;return n=e,r=[{key:\"mParseName\",value:function(e){if(!e)throw new Error(\"Chord.byName(String) requires a chord name be given\");for(var n,t=[L(1)],r=/[A-G]/g,i=/(#|b)*/g,o=A(e.matchAll(/(?:(?:([A-G])([#b]*))|([mM])|(dim|aug|sus4|sus2)|(?:([b#]*)([4-9]|1[01])))/g)),a=o.length,u=0;u<a;u++){var l=o[u].filter((function(e){return null!=e})),v=String(l[1].charAt(0));if(r.test(v)){switch(v){case\"A\":n=s.tones.A;break;case\"B\":n=s.tones.B;break;case\"C\":n=s.tones.C;break;case\"D\":n=s.tones.D;break;case\"E\":n=s.tones.E;break;case\"F\":n=s.tones.F;break;case\"G\":n=s.tones.G}l.length>2&&Array.from(l[2]).forEach((function(e){\"#\"===e?n+=1:\"b\"===e&&(n-=1)}))}else if(\"m\"===v){var c=t.findIndex((function(e){return 3===e.interval})),h=t.findIndex((function(e){return 5===e.interval}));c>-1?t[c].modifier=F.FLAT:t.push(L(3,F.FLAT)),-1===h&&t.push(L(5))}else if(\"M\"===v){var f=t.findIndex((function(e){return 3===e.interval})),m=t.findIndex((function(e){return 5===e.interval}));f>-1?t[f].modifier=F.NATURAL:t.push(L(3)),-1===m&&t.push(L(5))}else if(i.test(v))!function(){var e=0;Array.from(l[1]).forEach((function(n){\"#\"===n?e++:e--}));var n=Math.round(l[2]),r=t.findIndex((function(e){return e.interval===n}));r>-1?t[r].modifier=e:t.push(L(n,e))}();else if(\"dim\"===l[0]){var d=t.findIndex((function(e){return 5===e.interval}));d>-1?t[d].modifier=F.FLAT:t.push(L(5,F.FLAT))}else if(\"aug\"===l[0]){var w=t.findIndex((function(e){return 5===e.interval}));w>-1?t[w].modifier=F.SHARP:t.push(L(5,F.SHARP))}else if(\"sus2\"===l[0]){var y=t.findIndex((function(e){return 3===e.interval}));y>-1?t[y].interval=2:t.push(L(2))}else if(\"sus4\"===v){var g=t.findIndex((function(e){return 3===e.interval}));g>-1?(t[g].interval=4,t[g].modifier=F.FLAT):t.push(L(4,F.FLAT))}}if(!n||t.length<2)throw new Error(\"Invalid chord name given\");return t.sort((function(e,n){return e.interval-n.interval})),{root:n,template:t}}},{key:\"M\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5)])}},{key:\"Madd4\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(4),L(5)])}},{key:\"M6\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(6)])}},{key:\"M69\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(6),L(9)])}},{key:\"M7\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7)])}},{key:\"M9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7),L(9)])}},{key:\"M11\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7),L(9),L(11)])}},{key:\"M13\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7),L(9),L(11),L(13)])}},{key:\"M7s11\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7),L(11,F.SHARP)])}},{key:\"Mb5\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5,F.FLAT)])}},{key:\"m\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5)])}},{key:\"madd4\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(4),L(5)])}},{key:\"m6\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5),L(6)])}},{key:\"m7\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5),L(7,F.FLAT)])}},{key:\"madd9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5),L(9)])}},{key:\"m6add9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5),L(6),L(9)])}},{key:\"m9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5),L(7,F.FLAT),L(9)])}},{key:\"m11\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5),L(7,F.FLAT),L(9),L(11)])}},{key:\"m13\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5),L(7,F.FLAT),L(9),L(11),L(13)])}},{key:\"m7b5\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5,F.FLAT),L(7,F.FLAT)])}},{key:\"dom7\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7,F.FLAT)])}},{key:\"dom9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7,F.FLAT),L(9)])}},{key:\"dom11\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7,F.FLAT),L(9),L(11)])}},{key:\"dom13\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7,F.FLAT),L(9),L(11),L(13)])}},{key:\"dom7s5\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5,F.SHARP),L(7,F.FLAT)])}},{key:\"dom7b5\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5,F.FLAT),L(7,F.FLAT)])}},{key:\"dom7b9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7,F.FLAT),L(9,F.FLAT)])}},{key:\"dom7s9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7,F.FLAT),L(9,F.SHARP)])}},{key:\"dom9s5\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5,F.SHARP),L(7,F.FLAT),L(9)])}},{key:\"dom9b5\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5,F.FLAT),L(7,F.FLAT),L(9)])}},{key:\"dom7s5s9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5,F.SHARP),L(7,F.FLAT),L(9,F.SHARP)])}},{key:\"dom7s5b9\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5,F.SHARP),L(7,F.FLAT),L(9,F.FLAT)])}},{key:\"dom7s11\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5),L(7,F.FLAT),L(11,F.SHARP)])}},{key:\"dim\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5,F.FLAT)])}},{key:\"dim7\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3,F.FLAT),L(5,F.FLAT),L(7,F.FLAT_FLAT)])}},{key:\"aug\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(3),L(5,F.SHARP)])}},{key:\"fifth\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(5)])}},{key:\"b5\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(5,F.FLAT)])}},{key:\"sus4\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(4,F.FLAT),L(5)])}},{key:\"sus2\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(2),L(5)])}},{key:\"s11\",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;return new e(n,[L(1),L(5),L(11,F.SHARP)])}}],(t=[{key:\"root\",value:function(e){return e?(this.mRootnote=e,this.scale(this.mScale),this):this.mRootnote}},{key:\"template\",value:function(e){return e?(this.mTemplate=e,this.mComputeNotes(),this):this.pTemplate}},{key:\"scale\",value:function(e){return e?(this.mScale=new w(this.mRootnote,e.template()),this.mComputeNotes(),this):this.mScale}},{key:\"octave\",value:function(e){return e?(this.root(new s(this.mRootnote.tone(),e)),this):this.mRootnote.octave()}},{key:\"invert\",value:function(){var e=this.mTemplate.length;if(e<2)throw new Error(\"Chord doesn't have enough notes to invert\");var n,t=[];for(n=1;n<e;n++)t.push(this.mTemplate[n]);var r=this.mScale.length,i=this.mTemplate[0];return i.interval+=r,t.push(i),this.template(t),this}},{key:\"major\",value:function(){var e=this.mTemplate.findIndex((function(e){return 3===e.interval}));return e>-1?this.mTemplate[e].modifier=F.NATURAL:this.mTemplate.push(L(3,F.NATURAL)),this.mTemplate.sort((function(e,n){return e.interval-n.interval})),this.mComputeNotes(),this}},{key:\"minor\",value:function(){var e=this.mTemplate.findIndex((function(e){return 3===e.interval}));return e>-1?this.mTemplate[e].modifier=F.FLAT:this.mTemplate.push(L(3,F.FLAT)),this.mTemplate.sort((function(e,n){return e.interval-n.interval})),this.mComputeNotes(),this}},{key:\"diminish\",value:function(){var e=this.mTemplate.findIndex((function(e){return 5===e.interval}));return e>-1?this.mTemplate[e].modifier=F.FLAT:this.mTemplate.push(L(5,F.FLAT)),this.mTemplate.sort((function(e,n){return e.interval-n.interval})),this.mComputeNotes(),this}},{key:\"halfDiminish\",value:function(){var e=this.mTemplate.findIndex((function(e){return 7===e.interval}));return e>-1?this.mTemplate[e].modifier=F.FLAT:this.mTemplate.push(L(7,F.FLAT)),this.mTemplate.sort((function(e,n){return e.interval-n.interval})),this.mComputeNotes(),this}},{key:\"augment\",value:function(){var e=this.mTemplate.findIndex((function(e){return 5===e.interval}));return e>-1?this.mTemplate[e].modifier=F.SHARP:this.mTemplate.push(L(5,F.SHARP)),this.mTemplate.sort((function(e,n){return e.interval-n.interval})),this.mComputeNotes(),this}},{key:\"equals\",value:function(e){return e.mRootnote.equals(this.mRootnote)&&e.mScale.equals(this.mScale)&&e.mTemplate===this.mTemplate}},{key:\"copy\",value:function(){return new e(this.mRootnote,this.mTemplate,this.mScale)}},{key:\"mComputeNotes\",value:function(){var e;for(this.mNotes=[],e=0;e<this.mTemplate.length;e++){var n=this.mScale.degree(this.mTemplate[e].interval);switch(this.mTemplate[e].modifier){case F.NATURAL:break;case F.SHARP:n.sharp();break;case F.SHARP_SHARP:n.sharp().sharp();break;case F.FLAT:n.flat();break;case F.FLAT_FLAT:n.flat().flat()}this.mNotes.push(n)}}},{key:\"notes\",get:function(){return this.mNotes}},{key:\"asString\",get:function(){var e=\"Chord: \";return this.mNotes.forEach((function(n){e+=\"\".concat(n.asString,\" \")})),e}}])&&T(n.prototype,t),r&&T(n,r),e}();t.d(n,\"Note\",(function(){return s})),t.d(n,\"Scale\",(function(){return w})),t.d(n,\"Chord\",(function(){return S})),t.d(n,\"ChordInterval\",(function(){return k}))}])}));","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import * as MT from 'musictheoryjs';\r\nimport * as JZZ from 'jzz';\r\nrequire('jzz-synth-tiny')(JZZ);\r\n\r\nclass Sequencer{\r\n    mSeq;\r\n    mKey;\r\n    mScale;\r\n    mChords;\r\n    mMelody = [];\r\n    mMelodyScale;\r\n    mDegrees = [];\r\n    constructor(pKey = MT.Note.C(), pScale = MT.Scale.Major(), pMelodyScale = MT.Scale.HarmonicMajor()){\r\n        this.mKey = pKey;\r\n        this.mScale = pScale;\r\n        this.mMelodyScale = pMelodyScale;\r\n    }\r\n\r\n    get sequencer(){\r\n        return this.mSeq;\r\n    }\r\n\r\n    get key() {\r\n        return this.mKey;\r\n    }\r\n\r\n    get chords(){\r\n        return this.mChords;\r\n    }\r\n\r\n    get scale() {\r\n        return this.mScale;\r\n    }\r\n\r\n    get I() {return this.mScale.degree(1)}\r\n    get II() {return this.mScale.degree(2)}\r\n    get III() {return this.mScale.degree(3)}\r\n    get IV() {return this.mScale.degree(4)}\r\n    get V() {return this.mScale.degree(5)}\r\n    get VI() {return this.mScale.degree(6)}\r\n    get VII() {return this.mScale.degree(7)}\r\n\r\n    setRythm(pChords, pDegrees){\r\n        this.mChords = pChords;\r\n        this.mDegrees = pDegrees;\r\n    }\r\n\r\n    setMelody(pNotes){\r\n        this.mMelody = pNotes;\r\n    }\r\n\r\n    setScale(pScale){\r\n        this.mScale = pScale;\r\n    }\r\n\r\n    // because MT.Note.asString will somestimes return something like 'F#/Gb' \r\n    // which is invalid for a chord name\r\n    fixChordName(str) {\r\n        let s = str.split('/')[1];\r\n        return s || str;\r\n    }\r\n\r\n    prepare(pForm){\r\n        this.mKey = new MT.Note(pForm.key, 2);\r\n\r\n        switch(pForm.scale){\r\n            case 'Major':\r\n                this.mScale = MT.Scale.Major(this.mKey);\r\n                break;\r\n            case 'Minor':\r\n                this.mScale = MT.Scale.Minor(this.mKey);\r\n                break;\r\n            case 'Pentatonic':\r\n                this.mScale = MT.Scale.PentatonicMajor(this.mKey);\r\n                break;\r\n            case 'Enigmatic':\r\n                this.mScale = MT.Scale.EnigmaticMajor(this.mKey);\r\n                break;\r\n            case 'Spanish':\r\n                this.mScale = MT.Scale.Spanish(this.mKey);\r\n                break;\r\n            case 'HarmonicMajor':\r\n                this.mScale = MT.Scale.HarmonicMajor(this.mKey);\r\n                break;\r\n            case 'MelodicMinor':\r\n                this.mScale = MT.Scale.MelodicMinorAscend(this.mKey);\r\n                break;\r\n            case 'None':\r\n            default: break;\r\n        }\r\n\r\n        switch(pForm.mode){\r\n            case 'Ionian':\r\n                this.mScale = this.mScale.ionianMode();\r\n                break;\r\n            case 'Dorian':\r\n                this.mScale = this.mScale.dorianMode();\r\n                break;\r\n            case 'Phrygian':\r\n                this.mScale = this.mScale.phrygianMode();\r\n                break;\r\n            case 'Lydian':\r\n                this.mScale = this.mScale.lydianMode();\r\n                break;\r\n            case 'Mixolydian':\r\n                this.mScale = this.mScale.mixolydianMode();\r\n                break;\r\n            // case 'Aeolian':\r\n            //     this.mScale = this.mScale.Minor(this.mKey);\r\n            //     break;\r\n            case 'Locrian':\r\n                this.mScale = this.mScale.locrianMode();\r\n                break;\r\n            default: break;\r\n        }\r\n        \r\n        this.setRythm([\r\n            new MT.Chord(this.fixChordName(this.mScale.degree(pForm.progression[0]).asString+pForm.chords[0])).octave(2),\r\n            new MT.Chord(this.fixChordName(this.mScale.degree(pForm.progression[1]).asString+pForm.chords[1])).octave(2),\r\n            new MT.Chord(this.fixChordName(this.mScale.degree(pForm.progression[2]).asString+pForm.chords[2])).octave(2),\r\n            new MT.Chord(this.fixChordName(this.mScale.degree(pForm.progression[3]).asString+pForm.chords[3])).octave(2)\r\n        ], pForm.progression);\r\n\r\n    }\r\n\r\n    playChord(pChord, pPort, pTime){\r\n        let port = pPort;\r\n        let time = pTime;\r\n        if(pChord){\r\n            pChord.notes.forEach((item)=>{\r\n                port.wait(time).noteOn(0, item.midiKey, 80).wait(2000).noteOff(0, item.midiKey);\r\n            });\r\n        }\r\n        return port\r\n    }\r\n\r\n    play(pTime = 0){\r\n        if(!this.mSeq){\r\n            this.mSeq = JZZ.synth.Tiny();\r\n        }\r\n\r\n        let port = this.mSeq;\r\n        let time = pTime;\r\n\r\n        if(this.mChords){\r\n            this.mChords.forEach((item)=>{\r\n                port = this.playChord(item, port, time);\r\n                time += 2000;\r\n            });\r\n            \r\n        }\r\n\r\n        return time;\r\n    }\r\n}\r\n\r\nexport default Sequencer;","export {default as Sequencer} from './Sequencer';\r\nimport * as MT from 'musictheoryjs';\r\nexport {MT};\r\n"],"sourceRoot":""}